'use strict';var _Mathfloor=Math.floor;define(function(){'use strict';function a(){if(!(0<c.length))for(var g=Math.sqrt(0.6931471805599453*2/Math.log(Math.E)),h=0;h<=e*d;h++)c[h]=Math.exp(-1/2*Math.pow(2*(h-d*e/2)/e*g,2))}var c=[],d=5,e=1e3,f=function(h){return 1+3*h/1e3};return function(g){a(),g=g||{},this.maxTime=g.maxTime||3600,this.nbPointsPerSecond=g.nbPointsPerSecond||5,this.getWidth=g.getWidth||f,this.annotations=[],this.spectrum=[];for(var h=2*(this.maxTime*this.nbPointsPerSecond);0<=h;h-=2)this.spectrum[h]=h/this.nbPointsPerSecond/2,this.spectrum[h+1]=0;this.appendPeaks=function(k,l,m){for(var n=0;n<k.length;n++)this.appendPeak(k[n],l,m)},this.appendAnnotation=function(k,l,m,n,o){o=o||{};var p={};p.type='rect',p._highlight=[m.valueOf()],p.pos={x:k,y:(o.y||30)+'px'},p.pos2={x:l,y:(o.y||30)+(o.height||30)+'px'},p.fillColor='#EEEEEE',p.strokeColor='#CC0000',p.strokeWidth='0px',p.info=n,this.annotations.push(p)},this.random=function(k,l){for(var n,l=l||1,m=0;m<k;m++){n=Math.random()*l+1;for(var o=0;o<n;o++){var p=_Mathfloor(Math.random()*this.maxTime),q=Math.random();this.appendPeak([p,q],m)}}},this.appendPeak=function(k,l,m){for(var y,n=k[0],o=k[1],p=this.getWidth(n),s=n-p,t=n+p,u=Math.max(Math.ceil((n-p/2*d)*this.nbPointsPerSecond),0),v=Math.min(_Mathfloor((n+p/2*d)*this.nbPointsPerSecond),this.spectrum.length/2-1),x=u;x<=v;x++)y=_Mathfloor(e/p*(x-(u+v)/2)/this.nbPointsPerSecond+d*e/2),0<=y&&y<c.length&&(this.spectrum[2*x+1]+=c[y]*o);l&&this.appendAnnotation(s,t,l,{peak:k},m)},this.getSpectrum=function(){return this.spectrum},this.getAnnotations=function(k){k=k||{};var l=this.annotations;return k.minIntensity&&(l=l.filter(function(m){return m.info&&m.info.peak[1]>k.minIntensity})),l}}});
