"use strict";function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),j=h.value}catch(k){return void d(k)}return h.done?void c(j):Promise.resolve(j).then(function(k){e("next",k)},function(k){e("throw",k)})}return e("next")})}}define(["jquery","react-dom","react","modules/default/defaultview","./app_1d","jcampconverter","src/util/api"],function(a,b,c,d,e,f,g){"use strict";class h{}Object.assign(h.prototype,d);return class extends h{constructor(){super(),this.series=[],this.changed=this.changed.bind(this)}init(){this.dom=document.createElement("div"),this.module.getDomContent().html(this.dom)}changed(k){var l;k.map((m)=>{"master"==m.name&&(l=m.integrals,this.module.model.dataTriggerChange(l))})}inDom(){this.resolveReady()}onResize(){this.render()}render(){var k=e.default;if(this.dom){this.series.map((m)=>{m.integrals="master"==m.name?this.integrals:[]}),b.render(c.createElement("div",{className:"jsNMR"},c.createElement(k,{width:this.width,height:this.height,options:{minThresholdPeakToPeak:0.01,toolbar:!0,legend:!0},molecule:this.moleculeSVG,series:this.series,onChanged:this.changed})),this.dom)}}setSerie(k,l){for(var m=[],n=0;n<this.series.length;n++)this.series[n].name!==k&&m.push(this.series[n]);for(var o=[],p=[],n=0;n<l.data[0].length;n+=2)o.push(l.data[0][n]),p.push(l.data[0][n+1]);m.push({name:k,shift:0,data:[o,p],color:"green",integrals:[]}),this.series=m}removeSerie(k){for(var l=0;l<this.series.length;l++)if(this.series[l].name==k)return void this.series.splice(l,1)}_update_integrals(k){this.integrals=k,this.render()}_update_jcampMaster(k){this._update_jcamp(k,"master")}_update_jcamp(k,l){f.convert(k+"",{},!0).then((m)=>{this.setSerie(l,m.spectra[0]),this.render()})}_update_molecule(k){var l=this;return _asyncToGenerator(regeneratorRuntime.mark(function m(){var n,o,p,q;return regeneratorRuntime.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,g.require("https://www.lactame.com/lib/openchemlib-extended/2.5.0/openchemlib-extended.js");case 2:n=s.sent,o=n.Molecule.fromMolfile(k),p=o.toDiastereotopicSVG({width:400,height:300}),o.addImplicitHydrogens(),q=o.toDiastereotopicSVG({width:400,height:300}),l.moleculeSVG=p,l.moleculeSVGH=q;case 9:case"end":return s.stop();}},m,l)}))()}_blank_molecule(){this.moleculeSVG=null,this.moleculeSVGH=null}_blank_jcampMaster(){this._blank_jcamp("master")}_blank_jcamp(k){this&&this.removeSerie&&this.removeSerie(k)}_blank_integrals(){this.integrals=[]}}});
