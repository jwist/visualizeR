'use strict';var _StringfromCharCode=String.fromCharCode,_MathLN=Math.LN10,_Mathsin=Math.sin,_Mathcos=Math.cos,_Mathround=Math.round,_Mathceil=Math.ceil,_Mathabs=Math.abs,_Mathpow=Math.pow,_Mathfloor=Math.floor,_Mathlog=Math.log,_Mathmin=Math.min,_MathPI=Math.PI;define(['modules/default/defaultview','src/main/datas','src/util/datatraversing','src/util/api','src/util/util','src/util/color','src/util/colorbar','lodash','threejs','src/util/debug','chroma','components/ml/dist/ml.min','lib/threejs/TrackballControls'],function(e,t,o,d,l,h,p,u,f,P,C,w){'use strict';function D(ia){switch(ia.preventDefault(),ia.keyCode){case 38:G+=R;break;case 40:G-=R;break;case 39:R*=1.1;break;case 37:R*=0.9;}}function V(ia){var ra=ia.toString(16);return 1==ra.length?'0'+ra:ra}function B(ia,ra,oa){return'#'+V(ia)+V(ra)+V(oa)}function S(ia,ra){ia=''+ia;var oa=ia.indexOf('.');return-1===oa?+ia:ia.slice(0,oa+ra+1)}function O(){this._firstLoad=!0}function F(){var ia=this;this.scene&&this.scene.children&&(u.keys(this.scene.children).forEach(function(ra){ia.scene.remove(ia.scene.children[ra])}),this._render())}var G=0.55,R=1e-3,I=w.Stat;(function(){document.addEventListener('keyup',D,!1)})();var E=1e3,H=100,Y='#eeeeee',N='lightblue',Z=0.03,W='sphere',q=E/1e3,K=2,aa=1e4,ea=require.toUrl('modules/types/chart/basic/scatter3D')+'/',ta={sphere:ea+'img/ball.png',spheret:ea+'img/ballt.png',tetrahedron:ea+'img/tetrahedron2.png',tetrahedront:ea+'img/tetrahedron2t.png',cone:ea+'img/cone.png',conet:ea+'img/conet.png',cube:ea+'img/cube.png',cubet:ea+'img/cubet.png',pyramid:ea+'img/pyramid.png',pyramidt:ea+'img/pyramidt.png',cylinder:ea+'img/cylinder.png',cylindert:ea+'img/cylindert.png',cuboid:ea+'img/cuboid.png',cuboidt:ea+'img/cuboidt.png'};return function(ia){for(var ra in ia)f.ImageUtils.loadTexture(ia[ra])}(ta),$.fn.listHandlers=function(ia,ra){return this.each(function(){var na=this,da=$(this).data('events');da&&$.each(da,function(la,sa){new RegExp('^('+('*'===ia?'.+':ia.replace(',','|').replace(/^on/i,''))+')$','i').test(la)&&$.each(sa,function(ca,_a){ra(na,'\n'+ca+': ['+la+'] : '+_a)})})})},$.extend(!0,O.prototype,e,{_initThreejs:function(){function ra(wa){var Ma,Da;Ma='sideBySide'===pa._3d?pa.width/2:pa.width;var Da=pa.height,Ta=new f.Vector3(2*(wa.offsetX/Ma)-1,2*-(wa.offsetY/Da)+1,0.5);Ta.unproject(pa.camera);for(var La=new f.Ray(pa.camera.position,Ta.sub(pa.camera.position).normalize()),ja=0,Va=[],Ba=0;Ba<pa.mathPoints.length;Ba++)La.isIntersectionSphere(pa.mathPoints[Ba])&&(ja++,Va.push({index:pa.mathPoints[Ba].index,distance:pa.camera.position.distanceTo(pa.mathPoints[Ba].center)}));return Va.sort(ka),Va=u.filter(Va,function(Sa){return Sa.distance>K}),Va=u.map(Va,function(Sa){return Sa.index}),Va}function oa(wa){if(pa._configCheckBox('displayPointCoordinates','onhover')){var Ma=['X: '+parseFloat(pa._data.x[wa].toPrecision(3)).toExponential(),'Y: '+parseFloat(pa._data.y[wa].toPrecision(3)).toExponential(),'Z: '+parseFloat(pa._data.z[wa].toPrecision(3)).toExponential()],Da=$('#legend_point_coordinates');Da.html(Ma.join('<br/>')),Da.show()}}function na(){pa._configCheckBox('displayPointCoordinates','onhover')&&$('#legend_point_coordinates').hide()}function da(wa){var Ma;if(Ma=ra(wa),ya=Ma,fa=wa,0<Ma.length){var Da=Ma[0],Ta=Da,La=Ta!==za;za&&La?(d.highlightId(pa._data._highlight[za],0),d.highlightId(pa._data._highlight[Ta],1),oa(Da)):La&&(d.highlightId(pa._data._highlight[Ta],1),oa(Da)),za=Ta}else null!=za&&(d.highlightId(pa._data._highlight[za],0),na()),za=null}function la(){if(0!==ya.length){var wa=pa.module.getConfiguration('tooltipJpath');if(wa){var Ma=pa._data;if(Ma.info){var Da=Ma.info[ya[0]],Ta=Da.getChildSync(wa),La=pa.$tooltip;La.css('left',fa.offsetX-H),La.css('top',fa.offsetY),La.css('width',H),La.html(Ta.value),La.show()}}}}function sa(){pa.$tooltip.hide()}function ca(){if(0!==ya.length){var wa=ya[0];0<Ca.length&&_a();var Ma={color:8947848},Da=new f.Vector3(pa._data.normalizedData.x[wa],pa._data.normalizedData.y[wa],pa._data.normalizedData.z[wa]),Ta=new f.Vector3(pa._data.normalizedData.x[wa],pa._data.normalizedData.y[wa],0);Ca.push(pa._drawLine(Da,Ta,Ma)),Ca.push(pa._drawCircle({color:'#000000',radius:pa._data.size[wa],x:pa._data.normalizedData.x[wa],y:pa._data.normalizedData.y[wa],z:q+pa.gorigin.z})),Ta=new f.Vector3(pa._data.normalizedData.x[wa],0,pa._data.normalizedData.z[wa]),Ca.push(pa._drawLine(Da,Ta,Ma)),Ca.push(pa._drawCircle({rotationAngle:_MathPI/2,rotationAxis:{x:1},color:'#000000',radius:pa._data.size[wa],x:pa._data.normalizedData.x[wa],y:q+pa.gorigin.y,z:pa._data.normalizedData.z[wa]})),Ta=new f.Vector3(0,pa._data.normalizedData.y[wa],pa._data.normalizedData.z[wa]),Ca.push(pa._drawLine(Da,Ta,Ma)),Ca.push(pa._drawCircle({rotationAngle:_MathPI/2,rotationAxis:{y:1},color:'#000000',radius:pa._data.size[wa],x:q+pa.gorigin.x,y:pa._data.normalizedData.y[wa],z:pa._data.normalizedData.z[wa]})),xa()}}function _a(){for(var wa=0;wa<Ca.length;wa++)pa.scene.remove(Ca[wa]);Ca=[],xa()}function ha(){pa.camera.aspect=pa.width/pa.height,pa.camera.updateProjectionMatrix(),pa.renderer.setSize(pa.width,pa.height),pa.controls.handleResize(),xa()}function ma(){if(requestAnimationFrame(ma),pa.controls.update(),pa._3d){pa.camera.updateMatrix();var wa=new f.Vector3(-G,0,0),Ma=new f.Vector3(G,0,0);pa.camera.localToWorld(wa),pa.camera.localToWorld(Ma),pa.cameraLeft.position.x=wa.x,pa.cameraLeft.position.y=wa.y,pa.cameraLeft.position.z=wa.z,pa.cameraLeft.rotation.x=pa.camera.rotation.x,pa.cameraLeft.rotation.y=pa.camera.rotation.y,pa.cameraLeft.rotation.z=pa.camera.rotation.z,pa.cameraLeft.updateMatrix(),pa.cameraRight.position.x=Ma.x,pa.cameraRight.position.y=Ma.y,pa.cameraRight.position.z=Ma.z,pa.cameraRight.rotation.x=pa.camera.rotation.x,pa.cameraRight.rotation.y=pa.camera.rotation.y,pa.cameraRight.rotation.z=pa.camera.rotation.z,pa.cameraRight.updateMatrix()}}function xa(){pa._render(),pa.headlight&&(pa.headlight.position.x=pa.camera.position.x+200,pa.headlight.position.y=pa.camera.position.y+200,pa.headlight.position.z=pa.camera.position.z+200),pa.tickLabels&&(va(),ba(),Pa())}var ua,pa=this,ya=[],fa=null,za=null,va=u.throttle(this._drawTickLabels.bind(this),500),ba=u.throttle(this._drawAxisLabels.bind(this),500),Pa=u.throttle(this._drawGraphTitle.bind(this),500),Ca=[];(function(){pa.camera=pa.camera||new f.PerspectiveCamera(60,pa.width/pa.height,K,aa),pa.cameraLeft=pa.cameraLeft||new f.PerspectiveCamera(60,pa.width/pa.height,K,aa),pa.cameraRight=pa.cameraRight||new f.PerspectiveCamera(60,pa.width/pa.height,K,aa),pa.controls||(pa.controls=new f.TrackballControls(pa.camera,pa.dom.get(0)),pa.controls.rotateSpeed=1,pa.controls.zoomSpeed=1.2,pa.controls.panSpeed=0.8,pa.controls.noZoom=!1,pa.controls.noPan=!1,pa.controls.staticMoving=!0,pa.controls.dynamicDampingFactor=0.3,pa.controls.keys=[65,83,68],pa.controls.addEventListener('change',xa)),pa.scene=new f.Scene,pa.renderer=new f.WebGLRenderer({antialias:!1}),pa._setBackgroundColor(),pa.renderer.setSize(window.innerWidth,window.innerHeight),ua=document.getElementById(pa.dom.attr('id')),ua.innerHTML='',ua.appendChild(pa.renderer.domElement),pa.$tooltip=$('<div style="z-index: 10000; position:absolute; top: 20px; width:'+(H+100)+'px; height: auto; background-color: #f9edbe;"> </div>'),$(pa.dom).append(pa.$tooltip),pa.$colorbar=$('<div>'),$(pa.dom).append(pa.$colorbar),pa.$tooltip.hide(),$(pa.dom).append('<div id="legend" style="z-index: 10000; right:10px ;position:absolute; top: 25px; height: auto; background-color: #ffffff;"> </div>');var Ma=$('#legend');Ma.append('<div id="legend_titles"></div>'),Ma.append('<div id="legend_point_coordinates"></div>'),Ma.css('background-color',pa.module.getConfiguration('backgroundColor')).css('text-align','right'),$('#legend_titles').hide(),$('#legend_point_coordinates').hide(),ha(),$(pa.renderer.domElement).on('mousemove',u.throttle(da,100)),$(pa.renderer.domElement).on('mousemove',u.throttle(function(){if(0<ya.length){var Da=ya[0];pa.module.controller.onHover(Da)}},300)),pa._configCheckBox('tooltip','show')&&($(pa.renderer.domElement).on('mousemove',u.debounce(la,500)),$(pa.renderer.domElement).on('mousemove',u.throttle(sa,500))),pa._configCheckBox('projection','show')&&($(pa.renderer.domElement).on('mousemove',u.debounce(ca,500)),$(pa.renderer.domElement).on('mousemove',u.throttle(_a,500))),$(pa.renderer.domElement).listHandlers('mousemove',function(){})})(),ma();var ka=(wa,Ma)=>wa.distance-Ma.distance},_drawGraph:function(){var ra=this;u.keys(ra.scene.children).forEach(function(na){ra.scene.remove(ra.scene.children[na])});var oa;oa=new f.AmbientLight(2236962,1),ra.scene.add(oa),ra.headlight=new f.PointLight(11184810,1.5),ra.headlight.position.set(1e3,1e3,1e3),ra.scene.add(ra.headlight),ra._mathPoints(),ra._drawPointsQuick(),ra._drawFaces(),ra._drawGrid(),ra._drawSecondaryGrid(),ra._drawTicks(),ra._drawTickLabels(),ra._drawAxisLabels(),ra._drawGraphTitle(),ra._render()},_drawPointsQuick:function(){var ra=this;if(ra._mainParticleObjects)for(var oa in ra._mainParticleObjects)ra.scene.remove(ra._mainParticleObjects[oa]);ra._mainParticleObjects={};for(var na={},da=0;da<ra._data.shape.length;da++)na[ra._data.shape[da]]=na[ra._data.shape[da]]||[],na[ra._data.shape[da]].push(da);for(var oa in na)ra._mainParticleObjects[oa]=ra._newParticleObject(na[oa],{shape:oa}),ra._updateParticleObject(ra._mainParticleObjects[oa]),ra.scene.add(ra._mainParticleObjects[oa]);ra._doRender()},_configCheckBox:function(ra,oa){return this.module.getConfiguration(ra)&&u.find(this.module.getConfiguration(ra),function(na){return na===oa})},_getDataField:function(ra){return this._data?u.flatten(u.map(this._data.data,ra)):[]},_normalizeData:function(){var ra=this;if(this._data){ra._data.normalizedData={},ra._data.normalizedData.x=u.map(ra._data.x,function(sa){return E*(sa-ra._data.realMin.x)/ra._data.realLen.x}),ra._data.normalizedData.y=u.map(ra._data.y,function(sa){return E*(sa-ra._data.realMin.y)/ra._data.realLen.y}),ra._data.normalizedData.z=u.map(ra._data.z,function(sa){return E*(sa-ra._data.realMin.z)/ra._data.realLen.z});var oa=this.module.getConfiguration('sizeNormalization'),na=I.array.min(ra._data.size),da=I.array.max(ra._data.size),la=da-na;ra._data.size=u.map(ra._data.size,function(sa){return 0==la?oa/2:oa*((sa-na)/la+0.01)})}},_processColors:function(){this.colorDomain=u.filter(this._data.color,function(na){return!isNaN(na)}),this.colorDomain=[_Mathmin.apply(null,this.colorDomain),Math.max.apply(null,this.colorDomain)];var ra=this.module.getConfiguration('gradient');ra=u.filter(ra,function(na){return void 0!==na.stopPosition}),this.stopPositions=u.map(ra,'stopPosition'),this.stopColors=u(ra).map('color').map(h.getColor).map((na)=>h.rgb2hex(na)).value(),this.numberToColor=p.getColorScale({stops:this.stopColors,stopPositions:this.stopPositions,domain:this.colorDomain});for(var oa=0;oa<this._data.color.length;oa++)if(!isNaN(this._data.color[oa])&&(this._data.color[oa]=this.numberToColor(this._data.color[oa]).color,Number.isNaN(this._data.color[oa]))){this._data.color[oa]=N;continue}for(oa=0;oa<this._data.color.length;oa++)this._data.color[oa]=new C(this._data.color[oa]).hex()},_computeMinMax:function(){var ra=this;if(ra._data){ra.minMax={};var oa=ra._data.x,na=ra._data.y,da=ra._data.z;ra._data.min={},ra._data.max={},ra._data.len={};var la=ra._meta.getChildSync(['axis',0,'min']),sa=ra._meta.getChildSync(['axis',0,'max']),ca=ra._meta.getChildSync(['axis',1,'min']),_a=ra._meta.getChildSync(['axis',1,'max']),ga=ra._meta.getChildSync(['axis',2,'min']),ha=ra._meta.getChildSync(['axis',2,'max']);ra._data.min.x=parseFloat(ra.module.getConfiguration('minX'))||la&&la.get()||I.array.min(oa),ra._data.min.y=parseFloat(ra.module.getConfiguration('minY'))||ca&&ca.get()||I.array.min(na),ra._data.min.z=parseFloat(ra.module.getConfiguration('minZ'))||ga&&ga.get()||I.array.min(da),ra._data.max.x=parseFloat(ra.module.getConfiguration('maxX'))||sa&&sa.get()||I.array.max(oa),ra._data.max.y=parseFloat(ra.module.getConfiguration('maxY'))||_a&&_a.get()||I.array.max(na),ra._data.max.z=parseFloat(ra.module.getConfiguration('maxZ'))||ha&&ha.get()||I.array.max(da),ra._data.len.x=ra._data.max.x-ra._data.min.x,ra._data.len.y=ra._data.max.y-ra._data.min.y,ra._data.len.z=ra._data.max.z-ra._data.min.z}},_getUnitPerTick:function(ra,oa,na,da){var la=this,sa=ra/ua;oa=oa?_Mathmin(oa,ra/10):ra/10;for(var ca=na/oa,_a=_Mathfloor(_Mathlog(ca)/2.302585092994046),ga=ca*_Mathpow(10,-_a),ha=[1,2,5,10],ma=!1,xa=ha.length-1;0<=xa;xa--)(!ma||_Mathabs(ha[xa]-ga)<_Mathabs(ma-ga))&&(ma=ha[xa]);var pa=ma*_Mathpow(10,_a),ua=na/pa,sa=ra/oa;la._data.realMin[da]=_Mathfloor(la._data.min[da]/pa)*pa,la._data.realMax[da]=_Mathceil(la._data.max[da]/pa)*pa,la._data.realMin[da]!==la._data.min[da]&&ua++,la._data.realMax[da]!==la._data.max[da]&&ua++,la._data.intervalVal[da]=pa,la._data.realLen[da]=la._data.realMax[da]-la._data.realMin[da],la._data.nbTicks[da]=_Mathround((la._data.realMax[da]-la._data.realMin[da])/la._data.intervalVal[da]+1),la._data.intervalPx[da]=E/(la._data.nbTicks[da]-1),la._data.decimals[da]=_a;var ya=_Mathfloor(_Mathlog(pa)/2.302585092994046);if(la._data.intervalFactor[da]=1>=_Mathabs(ya)?1:_Mathpow(10,ya),!u.isFinite(la._data.intervalPx[da])){la._data.nbTicks[da]=3,la._data.intervalPx[da]=E/2;var fa=la._data[da][0];la._data.decimals[da]=0===la._data[da][0]?0:_Mathfloor(_Mathlog(_Mathabs(fa))/2.302585092994046),la._data.intervalFactor[da]=_Mathpow(10,la._data.decimals[da]);var za=la._data.intervalFactor[da];la._data.realMin[da]=_Mathceil((fa-za)/za)*za,la._data.realMax[da]=_Mathfloor((fa+za)/za)*za,la._data.realLen[da]=la._data.realMax[da]-la._data.realMin[da],la._data.intervalVal[da]=la._data.realLen[da]/2}},_computeTickInfo:function(){var ra=this;ra._data.realMin={},ra._data.realMax={},ra._data.realLen={},ra._data.intervalPx={},ra._data.nbTicks={},ra._data.intervalVal={},ra._data.decimals={},ra._data.intervalFactor={},ra._getUnitPerTick(E,3,ra._data.len.x,'x'),ra._getUnitPerTick(E,3,ra._data.len.y,'y'),ra._getUnitPerTick(E,3,ra._data.len.z,'z')},_drawAxes:function(){var ra=this;if(ra._data){ra._reinitObject3DArray('axes');var oa=new f.Vector3(1,0,0),na=new f.Vector3(0,1,0),da=new f.Vector3(0,0,-1),la=new f.Vector3(0,0,0),sa=0,ca=new f.ArrowHelper(oa,new f.Vector3(0,0,E),E,sa,1,1),_a=new f.ArrowHelper(na,new f.Vector3(0,0,E),E,sa,1,1),ga=new f.ArrowHelper(da,new f.Vector3(E,0,E),E,sa,1,1);ra.axes.push(ca,_a,ga),this.scene.add(ca),this.scene.add(_a),this.scene.add(ga)}},_drawCircle:function(ra){var ra=ra||{},oa=new f.Shape,na=ra.radius||Z;na*=E;for(var da=0;16>da;da++){var la=(da+1)/16,sa=2*(la*_MathPI),ca=na*_Mathcos(sa),_a=na*_Mathsin(sa);0==da?oa.moveTo(ca,_a):oa.lineTo(ca,_a)}var ga=oa.makeGeometry(),ha=new f.MeshBasicMaterial({color:ra.color||'#888888',side:f.DoubleSide}),ma=new f.Mesh(ga,ha),xa=new f.Matrix4,pa=new f.Matrix4;return ra.rotationAxis&&xa.makeRotationAxis(new f.Vector3(ra.rotationAxis.x||0,ra.rotationAxis.y||0,ra.rotationAxis.z||0),ra.rotationAngle||0),pa.makeTranslation(ra.x||0,ra.y||0,ra.z||0),pa.multiplyMatrices(pa,xa),ma.applyMatrix(pa),this.scene.add(ma),ma},_drawColorBar:function(){this.$colorbar.empty(),this.$colorbar.css({position:'absolute',top:0}),!this.module.getConfiguration('gradient')||1>=this.module.getConfiguration('gradient').length||p.renderSvg(this.$colorbar[0],{width:50,height:200,axis:{orientation:'left',ticks:5,order:'asc'},stops:this.stopColors,stopPositions:this.stopPositions,domain:this.colorDomain})},_drawLine:function(ra,oa,na){na=na||{};var da=new f.LineBasicMaterial({color:na.color||0}),la=new f.Geometry;la.vertices.push(ra),la.vertices.push(oa);var sa=new f.Line(la,da);return this.scene.add(sa),sa},_reinitObject3DArray:function(ra){this[ra]=this[ra]||[];for(var oa=0;oa<this[ra].length;oa++)this.scene.remove(this[ra][oa]);this[ra]=[]},_setGridOrigin:function(){this.gorigin={},this.gorigin.x=parseFloat(this.module.getConfiguration('gridOriginX')||this._data.realMin.x),this.gorigin.y=parseFloat(this.module.getConfiguration('gridOriginY')||this._data.realMin.y),this.gorigin.z=parseFloat(this.module.getConfiguration('gridOriginZ')||this._data.realMin.z),this.gorigin.x=E*(this.gorigin.x-this._data.realMin.x)/this._data.realLen.x,this.gorigin.y=E*(this.gorigin.y-this._data.realMin.y)/this._data.realLen.y,this.gorigin.z=E*(this.gorigin.z-this._data.realMin.z)/this._data.realLen.z},_drawSecondaryGrid:function(){var ra=this;ra._reinitObject3DArray('secondaryGrid');for(var oa={color:8947848},na=ra.module.getConfiguration('secondaryGrids')||2,da=0;da<ra._data.nbTicks.x-1;da++)for(var la=1;la<na;la++)this._configCheckBox('grid','xysec')&&ra.secondaryGrid.push(ra._drawLine(new f.Vector3(ra._data.intervalPx.x*da+ra._data.intervalPx.x/na*la,0,q+ra.gorigin.z),new f.Vector3(ra._data.intervalPx.x*da+ra._data.intervalPx.x/na*la,E,q+ra.gorigin.z),oa)),this._configCheckBox('grid','xzsec')&&ra.secondaryGrid.push(ra._drawLine(new f.Vector3(ra._data.intervalPx.x*da+ra._data.intervalPx.x/na*la,q+ra.gorigin.y,0),new f.Vector3(ra._data.intervalPx.x*da+ra._data.intervalPx.x/na*la,q+ra.gorigin.y,E),oa));for(var da=0;da<ra._data.nbTicks.y-1;da++)for(var la=1;la<na;la++)this._configCheckBox('grid','yzsec')&&ra.secondaryGrid.push(ra._drawLine(new f.Vector3(q+ra.gorigin.x,ra._data.intervalPx.y*da+ra._data.intervalPx.y/na*la,0),new f.Vector3(q+ra.gorigin.x,ra._data.intervalPx.y*da+ra._data.intervalPx.y/na*la,E),oa)),this._configCheckBox('grid','xysec')&&ra.secondaryGrid.push(ra._drawLine(new f.Vector3(0,ra._data.intervalPx.y*da+ra._data.intervalPx.y/na*la,q+ra.gorigin.z),new f.Vector3(E,ra._data.intervalPx.y*da+ra._data.intervalPx.y/na*la,q+ra.gorigin.z),oa));for(var da=0;da<ra._data.nbTicks.z-1;da++)for(var la=1;la<na;la++)this._configCheckBox('grid','yzsec')&&ra.secondaryGrid.push(ra._drawLine(new f.Vector3(q+ra.gorigin.x,0,ra._data.intervalPx.z*da+ra._data.intervalPx.z/na*la),new f.Vector3(q+ra.gorigin.x,E,ra._data.intervalPx.z*da+ra._data.intervalPx.z/na*la),oa)),this._configCheckBox('grid','xzsec')&&ra.secondaryGrid.push(ra._drawLine(new f.Vector3(0,q+ra.gorigin.y,ra._data.intervalPx.z*da+ra._data.intervalPx.z/na*la),new f.Vector3(E,q+ra.gorigin.y,ra._data.intervalPx.z*da+ra._data.intervalPx.z/na*la),oa))},_drawGrid:function(){var ra=this;ra._reinitObject3DArray('grid');for(var oa=0;oa<ra._data.nbTicks.x;oa++)this._configCheckBox('grid','xy')&&ra.grid.push(ra._drawLine(new f.Vector3(ra._data.intervalPx.x*oa,0,q+ra.gorigin.z),new f.Vector3(ra._data.intervalPx.x*oa,E,q+ra.gorigin.z))),this._configCheckBox('grid','xz')&&ra.grid.push(ra._drawLine(new f.Vector3(ra._data.intervalPx.x*oa,q+ra.gorigin.y,0),new f.Vector3(ra._data.intervalPx.x*oa,q+ra.gorigin.y,E)));for(var oa=0;oa<ra._data.nbTicks.y;oa++)this._configCheckBox('grid','yz')&&ra.grid.push(ra._drawLine(new f.Vector3(q+ra.gorigin.x,ra._data.intervalPx.y*oa,0),new f.Vector3(q+ra.gorigin.x,ra._data.intervalPx.y*oa,E))),this._configCheckBox('grid','xy')&&ra.grid.push(ra._drawLine(new f.Vector3(0,ra._data.intervalPx.y*oa,q+ra.gorigin.z),new f.Vector3(E,ra._data.intervalPx.y*oa,q+ra.gorigin.z)));for(var oa=0;oa<ra._data.nbTicks.z;oa++)this._configCheckBox('grid','yz')&&ra.grid.push(ra._drawLine(new f.Vector3(q+ra.gorigin.x,0,ra._data.intervalPx.z*oa),new f.Vector3(q+ra.gorigin.x,E,ra._data.intervalPx.z*oa))),this._configCheckBox('grid','xz')&&ra.grid.push(ra._drawLine(new f.Vector3(0,q+ra.gorigin.y,ra._data.intervalPx.z*oa),new f.Vector3(E,q+ra.gorigin.y,ra._data.intervalPx.z*oa)))},_drawTicks:function(){var ra=this;if(ra._reinitObject3DArray('ticks'),ra._configCheckBox('ticks','x'))for(var oa=0;oa<ra._data.nbTicks.x;oa++)ra.ticks.push(ra._drawLine(new f.Vector3(ra._data.intervalPx.x*oa,0,E),new f.Vector3(ra._data.intervalPx.x*oa,0,1.05*E)));if(ra._configCheckBox('ticks','y'))for(var oa=0;oa<ra._data.nbTicks.y;oa++)ra.ticks.push(ra._drawLine(new f.Vector3(0,ra._data.intervalPx.y*oa,E),new f.Vector3(-0.05*E,ra._data.intervalPx.y*oa,E)));if(ra._configCheckBox('ticks','z'))for(var oa=0;oa<ra._data.nbTicks.z;oa++)ra.ticks.push(ra._drawLine(new f.Vector3(E,0,ra._data.intervalPx.z*oa),new f.Vector3(1.05*E,0,ra._data.intervalPx.z*oa)))},_addText:function(ra,oa,na,da,la){var sa=this,la=la||{};la.size=la.size||64,la.fillStyle=la.fillStyle||h.array2rgba(sa.module.getConfiguration('annotationColor'))||'rgba(0,0,0,1)',la.textAlign=la.textAlign||'left',la.font=la.font||'Arial',la.opacity=la.opacity||0.99;var ca=document.createElement('canvas');switch(ca.height=la.size,ca.width=la.size*ra.length/2+la.size/2,la.textAlign){case'left':oa+=ca.width/2;break;case'right':oa-=ca.width/2;}var _a=ca.getContext('2d');_a.font='Bold '+0.9*la.size+'px '+la.font,_a.fillStyle=la.fillStyle,_a.fillText(ra,0,0.9*la.size);var ga=new f.Texture(ca);ga.minFilter=f.NearestFilter,ga.needsUpdate=!0;var ha=new f.MeshBasicMaterial({map:ga,transparent:1!==la.opacity,opacity:la.opacity}),ma=new f.Mesh(new f.PlaneBufferGeometry(ca.width,ca.height),ha),xa=sa.camera.matrix.clone();return xa.setPosition(new f.Vector3(0,0,0)),ma.applyMatrix(xa),ma.position.set(oa,na,da),ma.castShadow=!1,ma.receiveShadow=!1,sa.scene.add(ma),ma},_drawTickLabels:function(){var ra=this;if(ra._reinitObject3DArray('tickLabels'),ra._configCheckBox('ticks','zlab'))for(var na,oa=0;oa<ra._data.nbTicks.z;oa++)na=S((ra._data.realMin.z+oa*ra._data.intervalVal.z)/ra._data.intervalFactor.z,2).toString(),ra.tickLabels.push(ra._addText(na,1.1*E,0,oa*ra._data.intervalPx.z,{textAlign:'left'}));if(ra._configCheckBox('ticks','ylab'))for(var na,oa=0;oa<ra._data.nbTicks.y;oa++)na=S((ra._data.realMin.y+oa*ra._data.intervalVal.y)/ra._data.intervalFactor.y,2).toString(),ra.tickLabels.push(ra._addText(na,-0.05*E,oa*ra._data.intervalPx.y,E,{textAlign:'right'}));if(ra._configCheckBox('ticks','xlab'))for(var na,oa=0;oa<ra._data.nbTicks.x;oa++)na=S((ra._data.realMin.x+oa*ra._data.intervalVal.x)/ra._data.intervalFactor.x,2).toString(),ra.tickLabels.push(ra._addText(na,oa*ra._data.intervalPx.x,0,1.1*E,{textAlign:'right'}))},_drawGraphTitle:function(){var ra=this;ra._reinitObject3DArray('graphTitle');var oa=ra.module.getConfiguration('labels'),na=ra._meta.title||'';if(na&&''!==na)switch(oa){case'none':return;default:ra.graphTitle.push(ra._addText(na,E/10,1.3*E,100,{textAlign:'left'}));}},_drawAxisLabels:function(){function ra(za,va,ba){var Pa=[];Pa.push('X: '+za),Pa.push('Y: '+va),Pa.push('Z: '+ba),$('#legend_titles').html(Pa.join('<br/>'))}function oa(za,va,ba){la.tickLabels.push(la._addText(na(za,'x'),E/2,0,1.4*E,{textAlign:'right'})),la.tickLabels.push(la._addText(na(va,'y'),-0.4*E,E/2,E,{textAlign:'right'})),la.tickLabels.push(la._addText(na(ba,'z'),1.4*E,0,E/2,{textAlign:'left'}))}function na(za,va){return 1===la._data.intervalFactor[va]?za:1<la._data.intervalFactor[va]?za+' (\xD7 10'+da(_Mathround(_Mathlog(la._data.intervalFactor[va])/_MathLN))+')':za+' (\xD7 10'+da('-'+-_Mathround(_Mathlog(la._data.intervalFactor[va])/_MathLN))+')'}function da(za){za=za.toString();for(var va='',ba=0;ba<za.length;ba++)'2'===za[ba]||'3'===za[ba]?va+=_StringfromCharCode(176+parseInt(za[ba])):'0'<=za[ba]&&'9'>za[ba]?va+=_StringfromCharCode(8304+parseInt(za[ba])):'-'===za[ba]&&(va+='\u207B');return va}var la=this;la._reinitObject3DArray('axisLabels');var sa=la.module.getConfiguration('labels'),ca=la._meta.getChildSync(['axis',la._data.xAxis||0,'label']),_a=la._meta.getChildSync(['axis',la._data.yAxis||1,'label']),ga=la._meta.getChildSync(['axis',la._data.zAxis||2,'label']),ha=la._meta.getChildSync(['axis',0,'unit']),ma=la._meta.getChildSync(['axis',1,'unit']),xa=la._meta.getChildSync(['axis',2,'unit']);ca=ca&&ca.get(),_a=_a&&_a.get(),ga=ga&&ga.get(),ca=ha&&ca+' ['+ha.get()+']'||ca,_a=ma&&_a+' ['+ma.get()+']'||_a,ga=xa&&ga+' ['+xa.get()+']'||ga;var pa=this.module.getConfiguration('xLabel')||ca||'X',ua=this.module.getConfiguration('yLabel')||_a||'Y',ya=this.module.getConfiguration('zLabel')||ga||'Z',fa=$('#legend_titles');switch(sa){case'axis':oa(pa,ua,ya),fa.hide();break;case'alegend':oa('X','Y','Z'),ra(pa,ua,ya),fa.show();break;case'both':oa(pa,ua,ya),ra(pa,ua,ya),fa.show();break;default:}},_drawFaces:function(){var ra=this;if(ra._data){ra._reinitObject3DArray('faces');var ya,fa,za,oa=new f.PlaneBufferGeometry(E,E),na=new f.PlaneBufferGeometry(E,E),da=new f.PlaneBufferGeometry(E,E),la=new f.PlaneBufferGeometry(E,E),sa=new f.PlaneBufferGeometry(E,E),ca=new f.PlaneBufferGeometry(E,E),_a=new f.MeshBasicMaterial({color:16777215,side:f.DoubleSide,transparent:!0,opacity:0.6}),ga=new f.Mesh(oa,_a),ha=new f.Mesh(na,_a),ma=new f.Mesh(da,_a),xa=new f.Mesh(la,_a),pa=new f.Mesh(sa,_a),ua=new f.Mesh(ca,_a);ya=new f.Matrix4,fa=new f.Matrix4,ya.makeTranslation(E/2,E/2,ra.gorigin.z),fa.makeTranslation(0,0,E/2),ga.applyMatrix(ya),fa.multiplyMatrices(ya,fa),xa.applyMatrix(fa),ya=new f.Matrix4,fa=new f.Matrix4,za=new f.Matrix4,ya.makeRotationY(_MathPI/2),fa.makeTranslation(-E/2,E/2,ra.gorigin.x),fa.multiplyMatrices(ya,fa),za.makeTranslation(0,0,E),ha.applyMatrix(fa),za.multiplyMatrices(fa,za),pa.applyMatrix(za),ya=new f.Matrix4,fa=new f.Matrix4,za=new f.Matrix4,ya.makeRotationX(_MathPI/2),fa.makeTranslation(E/2,E/2,-ra.gorigin.y),fa.multiplyMatrices(ya,fa),ma.applyMatrix(fa),za.makeTranslation(0,0,-E),za.multiplyMatrices(fa,za),ua.applyMatrix(za),xa.visible=!1,pa.visible=!1,ua.visible=!1,ra.faces.push(ga),ra.faces.push(ha),ra.faces.push(ma);for(var va=0;va<ra.faces.length;va++)ra.scene.add(ra.faces[va])}},_inBoundary:function(ra){var oa=this;return u.isObject(ra)?ra.x<oa._data.realMin.x||ra.x>oa._data.realMax.x?!1:ra.y<oa._data.realMin.y||ra.y>oa._data.realMax.y?!1:ra.z<oa._data.realMin.z||ra.z>oa._data.realMax.z?!1:!0:!!u.isArray(ra)&&oa._inBoundary({x:ra[0],y:ra[1],z:ra[2]})},_computeInBoundaryIndexes:function(){var ra=this;ra._data.inBoundary=[];for(var oa=0;oa<ra._data.x.length;oa++)ra._inBoundary({x:ra._data.x[oa],y:ra._data.y[oa],z:ra._data.z[oa]})?ra._data.inBoundary.push(!0):ra._data.inBoundary.push(!1)},_mathPoints:function(){var ra=this;if(ra._data){ra.mathPoints=[];for(var oa=0;oa<ra._data.x.length;oa++)if(ra._data.inBoundary[oa]){var na=Z;ra._data.size&&ra._data.size[oa]&&(na=ra._data.size[oa]);var da=new f.Sphere(new f.Vector3(ra._data.normalizedData.x[oa],ra._data.normalizedData.y[oa],ra._data.normalizedData.z[oa]),na*E);da.index=oa,ra.mathPoints.push(da)}}},_updateMathPoints:function(ra){var na,oa=this;if(ra.applyFilter){na=oa._data.inBoundary.slice(0);for(var da=0;da<oa._dispFilter.length;da++)na[da]=oa._dispFilter[da]&&na[da]}else na=oa._data.inBoundary;for(var da=0;da<oa._data.x.length;da++)oa.mathPoints[da].radius=na[da]?oa._data.size[da]*E:0},_zoomToFit:function(){var ra=this,la=this._polarToCartesian(_MathPI/3,_MathPI/4,E*3),sa=new f.Vector3(E/2,E/2,E/2);ra.camera.position.set(la[0],la[1],la[2]),ra.camera.lookAt(sa),ra.cameraLeft.position.set(la[0],la[1],la[2]),ra.cameraLeft.lookAt(sa),ra.cameraRight.position.set(la[0],la[1],la[2]),ra.cameraRight.lookAt(sa)},_polarToCartesian:function(ra,oa,na){var da=_Mathsin(oa)*_Mathcos(ra)*na,la=_Mathsin(oa)*_Mathsin(ra)*na,sa=_Mathcos(oa)*na;return[da,la,sa]},init:function(){var ra=this,oa=this.module.getConfiguration('defaultPointColor');N=B(oa[0],oa[1],oa[2]),this.dom||(this._id=l.getNextUniqueId(),this.dom=$(' <div id="'+this._id+'"></div>').css({height:'100%',width:'100%',overflow:'hidden'}),this.dom.on('dblclick',function(){ra.controls.reset(),ra._zoomToFit()}),this.module.getDomContent().html(this.dom)),this.loadedData=$.Deferred(),this.resolveReady()},onResize:function(){var ra=this;this.loadedData.done(function(){ra._firstLoad?(ra._initThreejs(),ra._activateHighlights(),ra._zoomToFit(),ra._firstLoad=!1):(ra.camera.aspect=ra.width/ra.height,ra.camera.updateProjectionMatrix(),ra.renderer.setSize(ra.width,ra.height),ra._setBackgroundColor(),ra.controls.handleResize(),ra._render(),ra.headlight&&(ra.headlight.position.x=ra.camera.position.x+200,ra.headlight.position.y=ra.camera.position.y+200,ra.headlight.position.z=ra.camera.position.z+200),ra.tickLabels&&(ra._drawTickLabels(),ra._drawAxisLabels(),ra._drawGraphTitle())),ra._data&&(ra._drawGraph(),ra._drawColorBar())})},_setBackgroundColor:function(){var ra=this.module.getConfiguration('backgroundColor');Y=B(ra[0],ra[1],ra[2]),this.renderer.setClearColor(Y,1)},_newParticleObject:function(ra,oa){var na=this;oa=oa||{};var da=ta[oa.shape]||ta[W];oa.transparent&&(da=da.replace(/\.(png|svg|jpeg|jpg|gif)$/i,'t.$1'));var sa={amplitude:{type:'f',value:1},color:{type:'c',value:new f.Color('#ffffff')},texture:{type:'t',value:f.ImageUtils.loadTexture(da)}},ca=new f.ShaderMaterial({uniforms:sa,attributes:{size:{type:'f',value:[]},ca:{type:'c',value:[]}},vertexShader:'\t\t\tattribute float size;\t\t\tattribute vec4 ca;\t\t\tvarying vec4 vColor;\t\t\tvoid main() {\t\t\t\tvColor = ca;\t\t\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\t\t\t\tgl_PointSize = size * ( 1.0 / length( mvPosition.xyz ) );\t\t\t\tgl_Position = projectionMatrix * mvPosition;\t\t\t}',fragmentShader:'uniform vec3 color;\t\t\tuniform sampler2D texture;\t\t\tvarying vec4 vColor;\t\t\tvoid main() {\t\t\t\tvec4 outColor = texture2D( texture, gl_PointCoord );\t\t\t\tif ( outColor.a < 0.5 ) discard;\t\t\t\tgl_FragColor = outColor * vec4( color * vColor.xyz, 1.0 );\t\t\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\t\t\t\tconst vec3 fogColor = vec3( 0.0 );\t\t\t\tfloat fogFactor = smoothstep( 0.0, 10000.0, depth );\t\t\t\tgl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\t\t\t}',transparent:!0}),_a=new f.Geometry;if(ra)for(var ha,ga=0;ga<ra.length;ga++)ha=new f.Vector3,ha.x=na._data.normalizedData.x[ra[ga]],ha.y=na._data.normalizedData.y[ra[ga]],ha.z=na._data.normalizedData.z[ra[ga]],_a.vertices.push(ha);else for(var ha,ga=0;ga<na._data.normalizedData.x.length;ga++)ha=new f.Vector3,ha.x=na._data.normalizedData.x[ga],ha.y=na._data.normalizedData.y[ga],ha.z=na._data.normalizedData.z[ga],_a.vertices.push(ha);var ma=new f.PointCloud(_a,ca);return ma.indexes=ra,ma},_updateParticleObject:function(ra,oa){if(ra){var na=this;oa=oa||{};var pa,da=ra.indexes,la=ra.geometry.vertices,sa=ra.material.attributes.size.value,ca=ra.material.attributes.ca.value,_a=na._data.color,ga=na._data.size,ha=2.2388*(oa.sizeFactor||1)*E*na.height,ma=oa.forcedColor?new f.Color(oa.forcedColor):null,xa=oa.updateColor||!0;if(oa.applyFilter){pa=na._data.inBoundary.slice(0);for(var ua=0;ua<na._dispFilter.length;ua++)pa[ua]=na._dispFilter[ua]&&pa[ua]}else pa=na._data.inBoundary;if(da)for(var ya=0;ya<la.length;ya++)sa[ya]=pa[da[ya]]?(ga[da[ya]]||Z)*ha:-1,ma?ca[ya]=ma:xa&&(ca[ya]=new f.Color(_a[da[ya]]||N));else for(var ya=0;ya<la.length;ya++)sa[ya]=pa[ya]?(ga[ya]||Z)*ha:0,ma?ca[ya]=ma:xa&&(ca[ya]=new f.Color(_a[ya]||N));ra.material.attributes.size.needsUpdate=!0,ra.material.attributes.ca.needsUpdate=!0}},_prepareHighlights:function(ra){var oa=this;oa._highlightParticleObjects={};for(var na={},da=0;da<ra.length;da++)na[oa._data.shape[da]]=na[oa._data.shape[da]]||{},na[oa._data.shape[da]][ra[da]]=na[oa._data.shape[da]][ra[da]]||[],na[oa._data.shape[da]][ra[da]].push(da);for(var la in na)for(var sa in na[la])oa._highlightParticleObjects[la]=oa._highlightParticleObjects[la]||{},oa._highlightParticleObjects[la][sa]=oa._newParticleObject(na[la][sa],{shape:la||W,transparent:!0});oa._doRender()},blank:{chart:F,data3D:F},update:{chart:function(ra){return this._3d=this.module.getConfiguration('3d'),this.module.data=ra,ra.get()?void(this._convertChartToData(ra.get()),this._completeChartData(),this._computeMinMax(),this._computeTickInfo(),this._computeInBoundaryIndexes(),this._normalizeData(),this._processColors(),this._setGridOrigin(),!this._firstLoad&&this._activateHighlights(),'pending'===this.loadedData.state()?this.loadedData.resolve():this._drawGraph()):void P.error('Unvalid value',ra)},data3D:function(ra){return this._3d=this.module.getConfiguration('3d'),this.module.data=ra,ra&&ra.get()?void(this._convertData3dToData(ra),this._completeChartData(),this._computeMinMax(),this._computeTickInfo(),this._computeInBoundaryIndexes(),this._normalizeData(),this._processColors(),this._setGridOrigin(),!this._firstLoad&&this._activateHighlights(),'pending'===this.loadedData.state()?this.loadedData.resolve():this._drawGraph()):void P.error('Invalid value'+ra)},boolArray:function(ra){if(this._data&&this._mainParticleObjects){var oa=this;if(!ra||!ra.get())return void P.error('Unvalid value boolArray',ra);for(var na in oa._dispFilter=ra.get(),oa._mainParticleObjects)oa._updateParticleObject(oa._mainParticleObjects[na],{applyFilter:!0,updateColor:!1});for(var na in oa._updateMathPoints({applyFilter:!0}),oa._highlightParticleObjects)for(var da in oa._highlightParticleObjects[na])oa._updateParticleObject(oa._highlightParticleObjects[na][da],{applyFilter:!0,updateColor:!1,sizeFactor:1.35});oa._doRender()}}},_render:function(){var ra=this;setTimeout(function(){ra._doRender()},20)},_doRender:function(){if('sideBySide'===this._3d){var ra=this.width/2,oa=this.height;this.renderer.setViewport(0,0,ra,oa),this.renderer.setScissor(0,0,ra,oa),this.renderer.enableScissorTest(!0),this.cameraLeft.aspect=2*ra/oa,this.cameraLeft.updateProjectionMatrix(),this.renderer.render(this.scene,this.cameraLeft),this.renderer.setViewport(ra,0,ra,oa),this.renderer.setScissor(ra,0,ra,oa),this.renderer.enableScissorTest(!0),this.cameraRight.aspect=2*ra/oa,this.cameraRight.updateProjectionMatrix(),this.renderer.render(this.scene,this.cameraRight),this.renderer.setViewport(2*ra,oa,0,0),this.renderer.setScissor(2*ra,oa,0,0),this.renderer.enableScissorTest(!0)}this.renderer.render(this.scene,this.camera)},_convertData3dToData:function(ra){function oa(ga){return u.isObject(ga)||u.isArray(ga)?null:ga}function na(ga,ha,ma){var xa=ga.getChildSync(ha);return void 0===xa?ma:oa(xa.get())}var da=this;Array.isArray(ra)&&0!==ra.length||P.error('Data 3D not valid'),da._data=new DataObject;var la=da.module.getConfiguration('dataJpaths');da._data.x=[],da._data.y=[],da._data.z=[],da._data.size=[],da._data.color=[],da._data.shape=[],da._data._highlight=[];var sa=u.cloneDeep(t.resurrect(la));u.each(sa,(ga)=>ga.unshift(0));for(var ca=function(ha){u.each(sa,(ma)=>ma[0]=ha),da._data.x.push(na(ra,sa.x,0)),da._data.y.push(na(ra,sa.y,0)),da._data.z.push(na(ra,sa.z,0)),da._data.color.push(na(ra,sa.color,N)),da._data.size.push(na(ra,sa.size,Z)),da._data.shape.push(na(ra,sa.shape,W))},_a=0;_a<ra.length;_a++)ca(_a);da._meta=new DataObject,da._data.x=da._data.x||[],da._data.y=da._data.y||[],da._data.z=da._data.z||[],da._data.info=u.map(ra,'info'),da._data._highlight=u.map(ra,'_highlight'),u.some(da._data._highlight)||(da._data._highlight=[]),da._dispFilter=da._dispFilter||[]},_convertChartToData:function(ra){this._data=new DataObject,this._meta=new DataObject;var oa=this;if(Array.isArray(ra.data)&&ra.data[0]&&Array.isArray(ra.data[0].y)){1<ra.data.length&&P.warn('Scatter 3D module will merge series together');for(var na=function(sa){u.keys(ra.data[sa]).forEach(function(ca){Array.isArray(ra.data[sa][ca])?(oa._data[ca]=oa._data[ca]||[],oa._data[ca].push(ra.data[sa][ca]),oa._data[ca]=u.flatten(oa._data[ca],!0)):oa._data[ca]=ra.data[sa][ca],u.filter(oa._data[ca],function(_a){return void 0!==_a})})},da=0;da<ra.data.length;da++)na(da);this._meta.axis=ra.axis,this._data._highlight=this._data._highlight||[],u.keys(ra).forEach(function(la){'data'!==la&&(oa._meta[la]=ra[la])}),oa._dispFilter=oa._dispFilter||[]}},_completeData:function(ra,oa){var na=this;na._data[ra]=na._data[ra]||[];for(var da=0;da<na._data.x.length;da++)void 0===na._data[ra][da]&&(na._data[ra][da]=oa)},_completeChartData:function(){this._completeData('size',Z),this._completeData('color',N),this._completeData('shape',W)},_activateHighlights:function(){function oa(la){var sa=!1;for(var ca in da._highlightParticleObjects)da._highlightParticleObjects[ca][la]&&da._highlightParticleObjects[ca][la].drawn&&(da.scene.remove(da._highlightParticleObjects[ca][la]),da._highlightParticleObjects[ca][la].drawn=!1,sa=!0);sa&&da._render()}function na(la){for(var sa in da._highlightParticleObjects)if(da._highlightParticleObjects[sa][la]){if(!0===da._highlightParticleObjects[sa][la].drawn)return;da.scene.add(da._highlightParticleObjects[sa][la]),da._highlightParticleObjects[sa][la].drawn=!0,da._updateParticleObject(da._highlightParticleObjects[sa][la],{updateColor:!0,sizeFactor:1.35,transparent:!0}),da._render()}}var da=this;da._data&&(d.killHighlight(da.module.getId()),da._data._highlight&&function(la){da._prepareHighlights(la);var sa=u.uniq(la);u.keys(sa).forEach(function(ca){sa[ca]&&d.listenHighlight({_highlight:sa[ca]},function(_a,ga){_a?na(ga):oa(ga)})})}(da._data._highlight))},updateOptions:function(){this._options={grid:{clickable:!0,hoverable:!0},series:{pie:{show:!0}}}}}),O});
