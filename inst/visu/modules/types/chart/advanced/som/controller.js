'use strict';var _Mathfloor=Math.floor;define(['jquery','modules/default/defaultcontroller','src/util/datatraversing','src/util/util'],function(a,b,c,d){'use strict';function e(){}return a.extend(!0,e.prototype,b),e.prototype.moduleInformation={name:'Self-organizing map',description:'Display the result of a SOM analysis',author:'Micha\xEBl Zasso',date:'01.12.2014',license:'MIT'},e.prototype.references={model:{label:'The SOM model'},dataset:{label:'Projected dataset',type:['chart','object']},element:{label:'Dataset element'},elementList:{label:'Lists of dataset elements'},cellInfo:{label:'Cell information'},coords:{label:'Coordinates'}},e.prototype.events={onCellHover:{label:'Hover a cell',refVariable:['elementList','cellInfo']},onElementHover:{label:'Hover a dataset element',refVariable:['element','coords']}},e.prototype.variablesIn=['model','dataset'],e.prototype.onElementHover=function(f,g,h){this.createDataFromEvent('onElementHover','coords',[f,g]),this.createDataFromEvent('onElementHover','element',h)},e.prototype.onCellHover=function(f){var g=f.position[0].x,h=f.position[0].y,k=this.module.model.getAllDataFromRel('dataset'),l={};for(var m in k){var n=k[m].getChildSync(['data',0]);l[m]=[];for(var o=0,p=n.x.length;o<p;o++)_Mathfloor(n.x[o])===g&&_Mathfloor(n.y[o])===h&&l[m].push(n.info[o])}this.createDataFromEvent('onCellHover','elementList',l),this.createDataFromEvent('onCellHover','cellInfo',{x:g,y:h,info:f.info})},e.prototype.configurationStructure=function(){var f=[],g=this.module.getDataFromRel('model');if(g){var h=g.options.fields;if(0|h)for(var k=0;k<h;k++)f.push({key:k,title:k});else for(var l=0,m=h.length;l<m;l++)f.push({key:h[l].name,title:h[l].name})}var n=[],o=this.module.model.getAllDataFromRel('dataset');if(o)for(var p in o)n.push({key:p,title:p});var q=[],r=this.module.getDataFromRel('dataset');if(r){var s=r.getChildSync(['data','0','info','0']);c.getJPathsFromElement(s,q)}return{sections:{background:{options:{title:'Background (grid)',multiple:!1},groups:{group:{options:{type:'list'},fields:{colorType:{type:'combo',title:'Color type',options:[{key:'fixed',title:'Fixed color'},{key:'range',title:'Color range'},{key:'inter',title:'RGB interpolation'}],default:'fixed',displaySource:{inter:'i0',fixed:'f0',range:'r0'}},colorSpace:{type:'combo',title:'Color space',options:[{key:'rgb',title:'RGB'},{key:'hsl',title:'HSL'},{key:'hsv',title:'HSV'},{key:'lab',title:'CIELab'},{key:'lch',title:'CIELCH'}],default:'rgb',displayTarget:['r0']},color1:{type:'spectrum',title:'Color',default:[255,255,255,1],displayTarget:['i0','r0','f0']},color2:{type:'spectrum',title:'Color 2',default:[0,0,0,1],displayTarget:['i0','r0']},field1:{type:'combo',title:'Field for color 1',options:f,default:f[0]?f[0].key:'',displayTarget:['r0','i0']},field2:{type:'combo',title:'Field for color 2',options:f,default:f[1]?f[1].key:'',displayTarget:['i0']},field3:{type:'combo',title:'Field for color 3',options:f,default:f[2]?f[2].key:'',displayTarget:['i0']}}}}},dataset:{options:{title:'Dataset',multiple:!0},groups:{group:{options:{type:'list'},fields:{dataset:{type:'combo',title:'Variable',options:n},colorType:{type:'combo',title:'Color type',options:[{key:'fixed',title:'Fixed color'},{key:'range',title:'Color range'},{key:'inter',title:'RGB interpolation'},{key:'jpath',title:'Color jpath'}],default:'fixed',displaySource:{inter:'i0',fixed:'f0',range:'r0',jpath:'j0'}},colorSpace:{type:'combo',title:'Color space',options:[{key:'rgb',title:'RGB'},{key:'hsl',title:'HSL'},{key:'hsv',title:'HSV'},{key:'lab',title:'CIELab'},{key:'lch',title:'CIELCH'}],default:'rgb',displayTarget:['r0']},color1:{type:'spectrum',title:'Color',default:[255,0,0,1],displayTarget:['i0','r0','f0']},color2:{type:'spectrum',title:'Color 2',default:[0,0,0,1],displayTarget:['i0','r0']},jpath1:{type:'combo',title:'jpath for color 1',options:q,extractValue:d.jpathToArray,insertValue:d.jpathToString,displayTarget:['r0','i0','j0']},jpath2:{type:'combo',title:'jpath for color 2',options:q,extractValue:d.jpathToArray,insertValue:d.jpathToString,displayTarget:['i0']},jpath3:{type:'combo',title:'jpath for color 3',options:q,extractValue:d.jpathToArray,insertValue:d.jpathToString,displayTarget:['i0']}}}}}}}},e.prototype.configAliases={bgType:['sections','background',0,'groups','group',0,'colorType',0],bgColor1:['sections','background',0,'groups','group',0,'color1',0],bgColor2:['sections','background',0,'groups','group',0,'color2',0],bgSpace:['sections','background',0,'groups','group',0,'colorSpace',0],bgField1:['sections','background',0,'groups','group',0,'field1',0],bgField2:['sections','background',0,'groups','group',0,'field2',0],bgField3:['sections','background',0,'groups','group',0,'field3',0],datasets:['sections','dataset']},e});
