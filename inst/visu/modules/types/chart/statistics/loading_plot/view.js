'use strict';define(['modules/default/defaultview','src/util/util','src/util/api','src/util/ui','lib/loadingplot/loadingplot','components/jquery-mousewheel/jquery.mousewheel.min'],function(a,b,c,d,e){'use strict';function f(){}return b.loadCss('lib/loadingplot/svg.css'),$.extend(!0,f.prototype,a,{init:function(){this.dom=d.getSafeElement('div'),this.module.getDomContent().html(this.dom),this.resolveReady()},onResize:function(m,n){this._w=m,this._h=n,this._w&&this._h&&this._svg&&this._svg.setSize(this._w,this._h),this.refresh()},blank:{loading:function(){this.dom&&this.dom.empty(),c.killHighlight(this.module.getId())}},update:{preferences:function(m){if(this._lastConf=m,!!this._lastValue)for(var n in m)for(var o=0;o<this._lastValue.series.length;o++)if(this._lastValue.series[o].category==n)for(var p=0;p<this._lastValue.series[o].data.length;p++)this._instances[o][p].filter(m[n])},center:function(m){m&&this._svg.setCenter.apply(this._svg,m)},zoom:function(m){m&&this._svg.setZoom(m)},viewport:function(m){m&&this._svg.setViewBox.apply(this._svg,[!1].concat(m))},loading:function(m){var n=this;if(m&&m.value){this._highlights=[];var o=new e.SVG(null,null,null,null,this.module.getConfiguration('navigation')[0][0]||!1);o._svgEl.style.display='block',o.onZoomChange(function(K){n.module.controller.onZoomChange(K),n.module.controller.onChangeViewport(o.getViewBox())}),o.onMove(function(K,L){n.module.controller.onMove(K,L),n.module.controller.onChangeViewport(o.getViewBox())}),this._svg=o,this._w&&this._h&&o.setSize(this._w,this._h);var p=m.value.minX||0,q=m.value.minY||0,r=(m.value.maxX||100)-p,s=(m.value.maxY||100)-q;o.setViewBoxWidth(p,q,r,s,!0),o.create(),o.bindTo(this.dom);var t=new e.SpringLabels(o);if(o.initZoom(),e.SVGElement.prototype.Springs=t,this._lastValue=m.value,this._instances=[],m.value&&m.value.series){for(var u=this.module.getConfiguration('layers'),v=0;v<u.length;v++){var A,x=u[v].groups.group[0],y=x.labels[0],z={};for(A=0;A<y.length;A++)z[y[A]]=!0;var B=x.el[0],C=x.type[0]||'ellipse';for(A=0;A<m.value.series.length;A++)if(m.value.series[A].category===B){for(var E,D=m.value.series[A].data,F=0,G=D.length;F<G;F++){'pie'===C?E=new e.Pie(o,D[F].x,D[F].y,D[F]):'ellipse'===C?E=new e.Ellipse(o,D[F].x,D[F].y,D[F]):'img'===C&&(E=new e.Image(o,D[F].x,D[F].y,D[F])),E.allowLabelDisplay(z.display_labels),x.labelsize[0]&&E.setLabelSize(x.labelsize[0]),E.forceField(z.forcefield),''!==x.labelzoomthreshold[0]&&E.setLabelDisplayThreshold(x.labelzoomthreshold[0]);var H=x.highlightmag[0]?x.highlightmag[0]:1,I=!!x.highlighteffect[0][0];E.setHighlightMag(H),E.setHighlightEffect({mag:H,yStroke:I}),E.setLabelStroke(z.blackstroke),E.setLabelScale(z.scalelabel);var J=E.highlight.bind(E);c.listenHighlight(D[F],J,!1,this.module.getId()),E.hoverCallback=function(){n.module.controller.hover(this._data)},this._instances[A]=this._instances[A]||[],this._instances[A][F]=E,o.add(E)}break}}o.ready(),t.resolve(),this._lastConf&&this.update.preferences.call(this,this._lastConf)}}}}}),f});
