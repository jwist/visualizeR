'use strict';define(['modules/default/defaultview','src/util/color','jquery-ui/ui/widgets/progressbar'],function(a,b){'use strict';function c(){}return $.extend(!0,c.prototype,a,{init:function(){this.total=0,this.curr=0,this.tpl=this.module.getConfiguration('tpl',':current / :total');var e=this.progressBar=$('<div>').css({position:'relative'}),f=this.progressDiv=$('<div>').css({position:'absolute',left:'50%',top:'4px',fontWeight:'bold'});e.append(f),e.progressbar({value:0}),e.find('.ui-progressbar-value').css({background:b.getColor(this.module.getConfiguration('barcolor'))}),this.module.getDomContent().html(e),this.resolveReady()},blank:{total:function(){this.total=0,this.curr=0,this.render()}},update:{total:function(e){this.total=e.get(),this.start=Date.now(),this.render()}},onActionReceive:{inc:function(e){0!==e&&(e=e||1),this.curr+=+e,this.render()},set:function(e){this.onActionReceive.inc.call(this,+e-this.curr)},total:function(e){this.total=+e,this.render()}},render:function(){var e=this.curr/this.total;e=Math.min(Math.max(e,0),1);var f=100*e;0===this.curr&&(this.start=Date.now());var g=Date.now()-this.start,h=100==f?0:g*(this.total/this.curr-1),i=this.tpl.replace(':current',this.curr).replace(':total',this.total).replace(':elapsed',isNaN(g)?'0.0':(g/1e3).toFixed(1)).replace(':eta',isNaN(h)||!isFinite(h)?'0.0':(h/1e3).toFixed(1)).replace(':percent',f.toFixed(1)+'%');this.progressBar.progressbar('value',f),this.progressDiv.text(i)}}),c});
