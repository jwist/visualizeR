'use strict';define(['modules/default/defaultcontroller','src/util/datatraversing','src/util/api','src/util/debug'],function(a,b,c,d){'use strict';function e(){}return $.extend(!0,e.prototype,a),e.prototype.init=function(){this.toggleElements={},this.resolveReady()},e.prototype.moduleInformation={name:'Table',description:'Displays a complex (but slower) grid with editable capability. Works async',author:'Norman Pellet',date:'24.12.2013',license:'MIT',cssClass:'jqgrid'},e.prototype.references={row:{label:'Row'},list:{label:'Table'},selectedrows:{label:'Selected rows'}},e.prototype.events={onSelect:{label:'A line is selected',refVariable:['row'],refAction:['row']},onHover:{label:'Hovers a line',refVariable:['row'],refAction:['row']},onToggleOn:{label:'On Toggle On',refVariable:['selectedrows'],refAction:['row']},onToggleOff:{label:'On Toggle Off',refVariable:['selectedrows'],refAction:['row']}},e.prototype.variablesIn=['list'],e.prototype.actionsIn=$.extend({},e.prototype.actionsIn,{addRow:'Add a new row',addColumn:'Add a new column',removeColumn:'Remove a column',removeRow:'Remove a row'}),e.prototype.configurationStructure=function(){var f=this.module.model.getjPath('row',!1);return{groups:{group:{options:{type:'list',multiple:!1},fields:{nblines:{type:'float',title:'Lines per page',default:20},toggle:{type:'combo',title:'Line toggling',options:[{key:'0',title:'No'},{key:'single',title:'Single row'},{key:'multiple',title:'Multiple rows'}]},colorjpath:{type:'combo',title:'Color jPath',options:f},filterRow:{type:'jscode',title:'Filter'},highlightLine:{type:'checkbox',title:'Highlight on hover',options:{Yes:'Yes'},default:['Yes']}}},cols:{options:{type:'table',multiple:!0,title:'Columns'},fields:{name:{type:'text',title:'Columns title'},jpath:{type:'combo',title:'jPath',options:f},number:{type:'checkbox',title:'Number ?',options:{number:'Yes'}},editable:{type:'combo',title:'Editable',default:'none',options:[{key:'none',title:'No'},{key:'text',title:'Text'},{key:'checkbox',title:'Checkbox'},{key:'select',title:'Combo'}]},options:{type:'text',title:'Options (; separated)'},width:{type:'text',title:'Width'}}}}}},e.prototype.onVarReceiveChange=function(f,g,h){var j=c.getVar(f),k=[];j&&('array'==j.getType()?b.getJPathsFromElement(j.get(0),k):'arrayXY'==j.getType()&&b.getJPathsFromElement(j,k),1<k.length&&h.getGroup('cols').getField('coljpath').implementation.setOptions(k))},e.prototype.configFunctions={colsjPaths:function(g){return g||[]}},e.prototype.configAliases={colsjPaths:['groups','cols',0],nbLines:['groups','group',0,'nblines',0],toggle:['groups','group',0,'toggle',0],colorjPath:['groups','group',0,'colorjpath',0],filterRow:['groups','group',0,'filterRow',0],highlightLine:['groups','group',0,'highlightLine',0]},e.prototype.lineHover=function(f,g){this.setVarFromEvent('onHover','row','list',[g]),this.sendActionFromEvent('onHover','row',f.get(g)),c.highlight(f[g],1)},e.prototype.lineOut=function(f,g){var h=f[g];h&&c.highlight(h,0)},e.prototype.lineClick=function(f,g){this.setVarFromEvent('onSelect','row','list',[g]),this.sendActionFromEvent('onSelect','row',f.get(g))},e.prototype.onToggleOn=function(f,g){this.sendActionFromEvent('onToggleOn','row',f.get(g)),this.setVarFromEvent('onToggleOn','row','list',[g]),this.toggleElements[g]=!0,this.doToggle('on')},e.prototype.onToggleOff=function(f,g){this.sendActionFromEvent('onToggleOff','row',f.get(g)),this.setVarFromEvent('onToggleOff','row','list',[g]),delete this.toggleElements[g],this.doToggle('off')},e.prototype.doToggle=function(f){var g=this,h=this.module.getDataFromRel('list');this.allVariablesFor('on'==f?'onToggleOn':'onToggleOff','selectedrows',function(j){var k=new DataArray;for(var l in g.toggleElements)if(h[l]){h.traceSync([l]),d.warn('Warning. This is only sync');var m=h[l].traceSync(j.jpath.slice(0));k.push(m)}c.createData(j.name,k,j.filter)})},e.prototype.export=function(){return this.module.view.exportToTabDelimited()},e});
