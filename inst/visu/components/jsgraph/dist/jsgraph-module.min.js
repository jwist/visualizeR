function _parsePx(t){return t&&t.indexOf&&-1<t.indexOf('px')&&parseInt(t.replace('px',''))}function isNumeric(t){return!isNaN(parseFloat(t))&&isFinite(t)}class Position{constructor(t,i,r,a){'object'==typeof t?(this.x=t.x,this.y=t.y,this.dx=t.dx,this.dy=t.dy):(this.x=t,this.y=i,this.dx=r,this.dy=a)}duplicate(){return new Position(this.x,this.y,this.dx,this.dy)}compute(t,i,r,a){if(t&&i&&r&&t.hasXAxis&&t.hasYAxis||t.throw(),!t.hasXAxis(i))throw'Graph does not contain the x axis that was used as a parameter';if(!t.hasYAxis(r))throw'Graph does not contain the x axis that was used as a parameter';return this._compute(t,i,r,a)}_compute(t,r,a,s){var n=this._relativeTo;if(n)var o=n._compute(t,r,a,s);var l={x:!1,y:!1},p;for(var d in r||(r=t.getXAxis()),a||(a=t.getYAxis()),l){var i='x'==d?r:a,g=this[d],c=this['d'+d];if(void 0!==g||(void 0===c||void 0!==n)&&void 0!==n)void 0!==g&&(l[d]=this.getPx(g,i));else if('x'==d){if(void 0===c)continue;l[d]=n?n[d]:0}else if(void 0!==this.x&&s)if(!1!==_parsePx(this.x))console.warn('You have defined x in px and not y. Makes no sense. Returning 0 for y'),l[d]=0;else{var u=s.searchClosestValue(this.x);u?l[d]=s.getY(u.yMin):(console.warn('Could not find y position for x = '+this.x+' on serie "'+s.getName()+'". Returning 0 for y.'),l[d]=0)}if(void 0!==c){var h=void 0!==g||void 0==o||void 0==o[d]?l[d]:o[d];if('y'==d&&o&&void 0!==o.x&&void 0==o.y){if(!s){throw'Error. No serie exists. Cannot find y value'}var u=s.searchClosestValue(n.x);u&&(h=s.getY(u.yMin))}h||(h=0),!1===(p=_parsePx(c))?!1===(p=this._parsePercent(c))?i&&(l[d]=h+i.getRelPx(c)):l[d]=h+this._getPositionPx(p,!0,i,t):l[d]=h+p}}return l}_getPositionPx(t,i,r,a){var s;if(!1!==(s=_parsePx(t)))return s;return!1===(s=this._parsePercent(t))?r?r.getPos(t):void 0:s/100*(i?a.getDrawingWidth():a.getDrawingHeight())}_parsePercent(t){return t&&t.indexOf&&-1<t.indexOf('%')&&t}getDeltaPx(t,i){var r;return!1===(r=_parsePx(t))?i.getRelPx(t)+'px':r+'px'}deltaPosition(t,i,r){t='y'==t?'y':'x';var a=this[t],s=this['d'+t],n,o;if(a!==void 0)!1===(n=_parsePx(a))?(a=this.getValPosition(a,r),this[t]=!1===(o=_parsePx(i))?a+i:a+r.getRelVal(o)):!1===(o=_parsePx(i))?this[t]=n+r.getRelPx(i)+'px':this[t]=n+o+'px';else if(s!==void 0){if('y'==t&&a===void 0&&!this._relativeTo)return;!1===(n=_parsePx(s))?(s=this.getValPosition(s,r),this['d'+t]=!1===(o=_parsePx(i))?s+i:s+r.getRelVal(o)):!1===(o=_parsePx(i))?this['d'+t]=n+r.getRelPx(i)+'px':this['d'+t]=n+o+'px'}}getValPosition(t,i){return'max'==t?i.getMaxValue():'min'==t?i.getMinValue():t}getPx(t,i,r){var a;if('function'==typeof t)return t(i,r);if(!1!==(a=_parsePx(t)))return a;if(!1!==(a=this._parsePercent(t)))return a;if(i){if('min'==t)return i.getMinPx();if('max'==t)return i.getMaxPx();if(r)return i.getRelPx(t);if(isNumeric(t))return i.getPos(t)}}getPxRel(t,i){return this.getPx(t,i,!0)}relativeTo(t){return this._relativeTo=Position.check(t),this}static check(t,i){if(t instanceof Position)return t;var r=new Position(t);if(t&&t.relativeTo){const a=i(t.relativeTo);a&&r.relativeTo(a)}return r}}function setAttributeTo(t,r,a){if(a)for(var s in r)t.setAttributeNS(a,s,r[s]);else for(s in r)t.setAttribute(s,r[s])}function mapEventEmission(t,r){r||(r=this);var a;for(var s in t)0==s.indexOf('on')&&'function'==typeof t[s]&&(a=s.substring(2),a=a.substring(0,1).toLowerCase()+a.substring(1),r.on&&function(i){r.on(a,function(){t[i].apply(r,arguments)})}(s))}function guid(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(t){var i=0|16*Math.random(),r='x'==t?i:8|3&i;return r.toString(16)})}function throwError(t){console.error(t)}function warn(t){console.warn(t)}function isNumeric$1(t){return!Array.isArray(t)&&0<=t-parseFloat(t)+1}function hue2rgb(i,r,a){return 0>a&&(a+=1),1<a&&(a-=1),a<1/6?i+6*(r-i)*a:a<1/2?r:a<2/3?i+6*((r-i)*(2/3-a)):i}function hslToRgb(t,i,a){var s=Math.round,n,r,o;if(0==i)n=r=o=a;else{var l=0.5>a?a*(1+i):a+i-a*i,d=2*a-l;n=hue2rgb(d,l,t+1/3),r=hue2rgb(d,l,t),o=hue2rgb(d,l,t-1/3)}return[s(255*n),s(255*r),s(255*o)]}function saveDomAttributes(t,r,a){if(t)for(var s in t._savedAttributesIds=t._savedAttributesIds||[],-1<t._savedAttributesIds.indexOf(a)&&restoreDomAttributes(t,a),t._savedAttributes=t._savedAttributes||{},t._attributes=t._attributes||{},t._attributes[a]=r,t._savedAttributesIds.push(a),r)t._savedAttributes[s]||(t._savedAttributes[s]=t.getAttribute(s)),t.setAttribute(s,r[s])}function hasSavedAttribute(t,i){return t._savedAttributes&&t._savedAttributes[i]!==void 0}function overwriteDomAttribute(t,i,r){hasSavedAttribute(t,i)&&(t._savedAttributes[i]=r)}function restoreDomAttributes(t,r){if(t&&t._savedAttributesIds){t._savedAttributesIds.splice(t._savedAttributesIds.indexOf(r),1),delete t._attributes[r];var a={};for(var s in t._savedAttributes)a[s]=t._savedAttributes[s];for(var s=0,i=t._savedAttributesIds.length;s<i;s++)for(var n in t._attributes[t._savedAttributesIds[s]])a[n]=t._attributes[t._savedAttributesIds[s]][n];for(var n in a)t.setAttribute(n,a[n])}}function debounce(t,i,r){var a;return function(){var s=this,n=arguments,o=r&&!a;clearTimeout(a),a=setTimeout(function(){a=null,r||t.apply(s,n)},i),o&&t.apply(s,n)}}function SVGParser(t){var i=new DOMParser,r=i.parseFromString(t,'image/svg+xml');return r}function getOffset(t){var i=t.getBoundingClientRect();return{top:i.top,left:i.left}}function setCSS(t,r){var a=t.style;for(var s in r)a[s]=r[s]}function ajaxGet(t){return new Promise(function(i,r){var a=new XMLHttpRequest;a.open(t.type||'GET',t.url,!0),t.json&&a.setRequestHeader('Accept','application/json'),a.onload=function(){if(200===a.status){var s=a.responseText;t.json&&(s=JSON.parse(s)),i(s)}else r(new Error('Request error: '+a.status))},a.onerror=function(){r(new Error('Network error: '+a.status))},a.send()})}var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArray=function(t){return'function'==typeof Array.isArray?Array.isArray(t):'[object Array]'===toStr.call(t)},isPlainObject=function(t){if(!t||'[object Object]'!==toStr.call(t))return!1;var i=hasOwn.call(t,'constructor'),r=t.constructor&&t.constructor.prototype&&hasOwn.call(t.constructor.prototype,'isPrototypeOf');if(t.constructor&&!i&&!r)return!1;for(var a in t);return'undefined'==typeof a||hasOwn.call(t,a)};function extend(){var t=arguments[0],r=1,i=arguments.length,a=!1,s,n,o,l,p,d;for('boolean'==typeof t?(a=t,t=arguments[1]||{},r=2):('object'!=typeof t&&'function'!=typeof t||null==t)&&(t={});r<i;++r)if(s=arguments[r],null!=s)for(n in s)o=t[n],l=s[n],t!==l&&(a&&l&&(isPlainObject(l)||(p=isArray(l)))?(p?(p=!1,d=o&&isArray(o)?o:[]):d=o&&isPlainObject(o)?o:{},t[n]=extend(a,d,l)):'undefined'!=typeof l&&(t[n]=l));return t}function mix(t,i){for(let r in i)i.hasOwnProperty(r)&&(t.prototype[r]=i[r])}function emptyDom(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function EventEmitter(){}var proto=EventEmitter.prototype;function indexOfListener(t,r){for(var a=t.length;a--;)if(t[a].listener===r)return a;return-1}function alias(t){return function(){return this[t].apply(this,arguments)}}proto.getListeners=function(t){var i=this._getEvents(),r,a;if(t instanceof RegExp)for(a in r={},i)i.hasOwnProperty(a)&&t.test(a)&&(r[a]=i[a]);else r=i[t]||(i[t]=[]);return r},proto.flattenListeners=function(t){var r=[],a;for(a=0;a<t.length;a+=1)r.push(t[a].listener);return r},proto.getListenersAsObject=function(t){var i=this.getListeners(t),r;return i instanceof Array&&(r={},r[t]=i),r||i},proto.addListener=function(t,i){var r=this.getListenersAsObject(t),a;for(a in r)r.hasOwnProperty(a)&&-1===indexOfListener(r[a],i)&&r[a].push('object'==typeof i?i:{listener:i,once:!1});return this},proto.on=alias('addListener'),proto.addOnceListener=function(t,i){return this.addListener(t,{listener:i,once:!0})},proto.once=alias('addOnceListener'),proto.defineEvent=function(t){return this.getListeners(t),this},proto.defineEvents=function(t){for(var r=0;r<t.length;r+=1)this.defineEvent(t[r]);return this},proto.removeListener=function(t,i){var r=this.getListenersAsObject(t),a,s;for(s in r)r.hasOwnProperty(s)&&(a=indexOfListener(r[s],i),-1!==a&&r[s].splice(a,1));return this},proto.off=alias('removeListener'),proto.addListeners=function(t,i){return this.manipulateListeners(!1,t,i)},proto.removeListeners=function(t,i){return this.manipulateListeners(!0,t,i)},proto.manipulateListeners=function(t,r,a){var s=t?this.removeListener:this.addListener,n=t?this.removeListeners:this.addListeners,o,i;if('object'==typeof r&&!(r instanceof RegExp))for(o in r)r.hasOwnProperty(o)&&(i=r[o])&&('function'==typeof i?s.call(this,o,i):n.call(this,o,i));else for(o=a.length;o--;)s.call(this,r,a[o]);return this},proto.removeEvent=function(t){var i=this._getEvents(),r;if('string'==typeof t)delete i[t];else if(t instanceof RegExp)for(r in i)i.hasOwnProperty(r)&&t.test(r)&&delete i[r];else delete this._events;return this},proto.removeAllListeners=alias('removeEvent'),proto.emitEvent=function(t,r){var a=this.getListenersAsObject(t),s,n,i,o;for(i in a)if(a.hasOwnProperty(i))for(n=a[i].length;n--;)s=a[i][n],!0===s.once&&this.removeListener(t,s.listener),o=s.listener.apply(this,r||[]),o===this._getOnceReturnValue()&&this.removeListener(t,s.listener);return this},proto.trigger=alias('emitEvent'),proto.emit=function(t){var i=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,i)},proto.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},proto._getOnceReturnValue=function(){return!this.hasOwnProperty('_onceReturnValue')||this._onceReturnValue},proto._getEvents=function(){return this._events||(this._events={})};class FitHost{constructor(t){this.DELTAP=1e-6,this.BIGVAL=9e99,this.WEIGHT=1,this.setYData(t.dataY),this.setXData(t.dataX),this.setWeight(t.weight),this.setInitialParams(t.params),t.subsetIndex&&this.setSubset(...t.subsetIndex),this.setFunction(t.function),t.progress&&this.hookIteration(t.progress),this.options=t}setYData(t){this.data=t}setXData(t){this.dataX=t}setWeight(t){this.weight=t}setInitialParams(t){this.parms=t,this.parms=this.parms.map((t)=>'function'==typeof t?t(this.data,this.dataX):t),this.NPARMS=t.length}setSubset(t,i){t!==void 0&&i!==void 0&&(this._from=t,this._to=i)}hookIteration(t){this._hookIteration=(i)=>{let r=this.buildFit(i,200);t(r)}}setFunction(t){this._func=t}init(){if(void 0!==this._from&&void 0!==this._to){if(this._from>=this._to)throw'Impossible to fit negative subranges. The starting index must be lower than the ending index';if(this.NPTS=this._to-this._from+1,this.data&&this.data.getLength()<=this._to)throw'Wave Y has not enough point to be fitted to subrange ['+this._from+', '+this._to+']';if(0>this._from)throw'Impossible to fit a subrange with negative indices'}else this.NPTS=this.data.getLength(),this._from=0,this._to=this.data.getLength()-1;if(this.dataX&&this.dataX.getLength()<=this._to)throw'Wave X has not enough point to be fitted to subrange ['+this._from+', '+this._to+']';this.arrY=this.data.getDataY(),this.arrX=this.dataX?this.dataX.getDataY():this.data.getDataX(),this.resid=Array(this.NPTS).fill(0),this.jac=Array(this.NPTS).fill(0),this.jac=this.jac.map(()=>Array(this.NPARMS))}fit(){return this.log('Starting the fit with initial parameter list {'+this.parms.join()+'};'),new LM(this,this.NPARMS,this.NPTS,this._hookIteration),this.log('Fit successful. Output parameters {'+this.parms.join()+'};'),this._result=this.buildFit(this.parms,200),this.options.done&&this.options.done(this.parms,this._result),this._result}func(t,i){return this._func(t,i)}computeResiduals(){for(var t=0,r=0;r<this.NPTS;r++)this.resid[r]=(this.func(this.arrX[r+this._from],this.parms)-this.arrY[r+this._from])*this.WEIGHT,t+=this.resid[r]*this.resid[r];return t}log(t){this.options.log&&console.log(t)}nudge(t){for(var i=0;i<this.NPARMS;i++)this.parms[i]+=t[i];return this.computeResiduals()}buildJacobian(){for(var t=Array(this.NPARMS),r=0.5/this.DELTAP,a=0,s=0;s<this.NPARMS;s++){for(var n=0;n<this.NPARMS;n++)t[n]=n==s?this.DELTAP:0;if(a=this.nudge(t),a==this.BIGVAL)throw'Bad dBuildJacobian() exit 2';for(var o=0;o<this.NPTS;o++)this.jac[o][s]=this.getResidualElement(o);for(var n=0;n<this.NPARMS;n++)t[n]=n==s?-2*this.DELTAP:0;if(a=this.nudge(t),a==this.BIGVAL)throw'Bad dBuildJacobian(). exit 3';for(var o=0;o<this.NPTS;o++)this.jac[o][s]-=this.getResidualElement(o);for(var o=0;o<this.NPTS;o++)this.jac[o][s]*=r;for(var n=0;n<this.NPARMS;n++)t[n]=n==s?this.DELTAP:0;if(a=this.nudge(t),a==this.BIGVAL)throw'Bad dBuildJacobian(). exit 4'}return!0}getResidualElement(t){return this.resid[t]}getJacobianElement(t,i){return this.jac[t][i]}buildFit(t,r){let a;if(!r)a=this.arrX;else{const t=this.dataX.getMin(this._from,this._to),i=this.dataX.getMax(this._from,this._to);a=Array(r).fill(0).map((a,s)=>s*(i-t)/(r-1)+t)}for(var s=Array(a.length),n=0,i=a.length;n<i;n++)s[n]=this.func(a[n],this.parms);let o=this.options.waveform;return o.setData(s,a),o}}class LM{constructor(t,i,r,a){this.LMITER=100,this.LMBOOST=2,this.LMSHRINK=0.1,this.LAMBDAZERO=1e-3,this.LAMBDAMAX=1E9,this.LMTOL=1e-12,this.BIGVAL=9e99,this.sos,this.sosprev,this.lambda,this.myH=null,this.nadj=0,this.npts=0,this.delta,this.beta,this.alpha,this.amatrix,this.myH=t,this.nadj=i,this.npts=r,this.delta=Array(this.nadj).fill(0),this.beta=Array(this.nadj).fill(0),this.alpha=Array(this.nadj).fill(0),this.amatrix=Array(this.nadj).fill(0),this.alpha=this.alpha.map(()=>Array(this.nadj)),this.amatrix=this.amatrix.map(()=>Array(this.nadj)),this.lambda=this.LAMBDAZERO;var s=0,n=!1;do n=this.bLMiter(),a&&a(this.myH.params),s++;while(!n&&s<this.LMITER)}bLMiter(){for(var t=0;t<this.nadj;t++)this.delta[t]=0;if(this.sos=this.myH.nudge(this.delta),this.sos==this.BIGVAL)return console.error('  bLMiter finds faulty initial nudge()'),!1;if(this.sosprev=this.sos,this.myH.log('  bLMiter..SumOfSquares= '+this.sos),!this.myH.buildJacobian())return console.error('  bLMiter finds buildJacobian()=false'),!1;for(var t=0;t<this.nadj;t++){this.beta[t]=0;for(var r=0;r<this.npts;r++)this.beta[t]-=this.myH.getResidualElement(r)*this.myH.getJacobianElement(r,t)}for(var t=0;t<this.nadj;t++)for(var i=0;i<this.nadj;i++){this.alpha[i][t]=0;for(var r=0;r<this.npts;r++)this.alpha[i][t]+=this.myH.getJacobianElement(r,i)*this.myH.getJacobianElement(r,t)}var a=0;do{for(var t=0;t<this.nadj;t++)for(var i=0;i<this.nadj;i++)this.amatrix[i][t]=this.alpha[i][t]+(i==t?this.lambda:0);this.gaussj(this.amatrix,this.nadj);for(var t=0;t<this.nadj;t++){this.delta[t]=0;for(var i=0;i<this.nadj;i++)this.delta[t]+=this.amatrix[i][t]*this.beta[i]}if(this.sos=this.myH.nudge(this.delta),this.sos==this.BIGVAL)return console.error('  LMinner failed SOS step'),!1;if(a=(this.sos-this.sosprev)/(1+this.sos),0>=a){this.lambda*=this.LMSHRINK;break}for(var s=0;s<this.nadj;s++)this.delta[s]*=-1;if(this.myH.nudge(this.delta),a<this.LMTOL)break;this.lambda*=this.LMBOOST}while(this.lambda<this.LAMBDAMAX);return a>-this.LMTOL||this.lambda>this.LAMBDAMAX}gaussj(t,r){var a=Math.abs,s=1,n=Array(100),o=Array(100),l,p,d,i,g,c;for(g=0;g<r;g++){for(l=0,d=g;d<r;d++)for(i=g;i<r;i++)a(l)<=a(t[d][i])&&(l=t[d][i],n[g]=d,o[g]=i);if(0==l)return 0;if(d=n[g],d>g)for(i=0;i<r;i++)p=t[g][i],t[g][i]=t[d][i],t[d][i]=-p;if(i=o[g],i>g)for(d=0;d<r;d++)p=t[d][g],t[d][g]=t[d][i],t[d][i]=-p;for(d=0;d<r;d++)d!=g&&(t[d][g]=-t[d][g]/l);for(d=0;d<r;d++)for(i=0;i<r;i++)d!=g&&i!=g&&(t[d][i]+=t[d][g]*t[g][i]);for(i=0;i<r;i++)i!=g&&(t[g][i]/=l);t[g][g]=1/l,s*=l}for(c=0;c<r;c++){if(g=r-c-1,i=n[g],i>g)for(d=0;d<r;d++)p=t[d][g],t[d][g]=-t[d][i],t[d][i]=p;if(d=o[g],d>g)for(i=0;i<r;i++)p=t[g][i],t[g][i]=-t[d][i],t[d][i]=p}return s}}var dataAggregator;if('undefined'==typeof URL||'undefined'==typeof URL.createObjectURL||'undefined'==typeof Blob||'undefined'==typeof Worker)dataAggregator=()=>{};else{var queue={},aggregatorWorker;let t=function(){var t=Math.max,r=Math.min,a=Math.floor;onmessage=function(s){const n=s.data.data,o=s.data.maxX,p=s.data.minX,d=s.data.maxY,g=s.data.minY,c=s.data.direction;let u=s.data.numPoints,h=n.length,l=0,i=-4,x=[],m=[],y=[],b=[],A;A=s.data.xdata?function(t){return s.data.xdata[t]}:function(t){return t*s.data.xScale+s.data.xOffset};let f={};if(console.log(c),'x'==c)for(const s=u/(o-p);l<h;l++){if(slotNumber=a((A(l)-p)*s),x[i]!==slotNumber){i+=4,x[i]=slotNumber;let t=(slotNumber+0.5)/s+p;m[i]=t,m[i+1]=t,m[i+2]=t,m[i+3]=t,y[i]=n[l],y[i+1]=n[l],y[i+2]=n[l],y[i+3]=n[l],b[i]=0}y[i+1]=r(n[l],y[i+1]),y[i+2]=t(n[l],y[i+2]),y[i+3]=n[l],b[i]+=n[l]}else for(const s=u/(d-g);l<h;l++){if(slotNumber=a((n[l]-g)*s),x[i]!==slotNumber){i+=4,x[i]=slotNumber;let t=(slotNumber+0.5)/s+g;y[i]=t,y[i+1]=t,y[i+2]=t,y[i+3]=t,m[i]=n[l],m[i+1]=n[l],m[i+2]=n[l],m[i+3]=n[l],b[i]=0}m[i+1]=r(A(l),m[i+1]),m[i+2]=t(A(l),m[i+2]),m[i+3]=A(l),b[i]+=A(l)}for(f[u]={x:m,y:y,sums:b},lastAggregation=y,lastAggregationX=m,lastAggregationSum=b;256<u;){if(u/=2,newAggregation=[],newAggregationX=[],i=0,'x'==c)for(l=0,h=lastAggregation.length-8;l<h;l+=8)newAggregationX[i]=(lastAggregationX[l]+lastAggregationX[l+4])/2,newAggregationX[i+1]=newAggregationX[i],newAggregationX[i+2]=newAggregationX[i],newAggregationX[i+3]=newAggregationX[i],newAggregation[i]=lastAggregation[l],newAggregation[i+1]=r(lastAggregation[l+1],lastAggregation[l+5]),newAggregation[i+2]=t(lastAggregation[l+2],lastAggregation[l+6]),newAggregation[i+3]=lastAggregation[l+7],b[i]=(lastAggregationSum[l]+lastAggregationSum[l+4])/2,i+=4;else for(l=0,h=lastAggregation.length-8;l<h;l+=8)newAggregation[i]=(lastAggregation[l]+lastAggregation[l+4])/2,newAggregation[i+1]=newAggregation[i],newAggregation[i+2]=newAggregation[i],newAggregation[i+3]=newAggregation[i],newAggregationX[i]=lastAggregationX[l],newAggregationX[i+1]=r(lastAggregationX[l+1],lastAggregationX[l+5]),newAggregationX[i+2]=t(lastAggregationX[l+2],lastAggregationX[l+6]),newAggregationX[i+3]=lastAggregationX[l+7],b[i]=(lastAggregationSum[l]+lastAggregationSum[l+4])/2,i+=4;f[u]={x:newAggregationX,y:newAggregation,sums:b},lastAggregation=newAggregation,lastAggregationX=newAggregationX,lastAggregationSum=b,b=[]}postMessage({aggregates:f,_queueId:s.data._queueId})}}.toString();t=t.replace(/^\s*function\s*\(\s*\)\s*\{/,''),t=t.replace(/}\s*$/,'');var workerUrl=URL.createObjectURL(new Blob([t],{type:'application/javascript'}));aggregatorWorker=new Worker(workerUrl),aggregatorWorker.onmessage=function(t){var i=t.data._queueId;delete t.data._queueId,queue[i](t.data),delete queue[i]},dataAggregator=function(t){var i=Date.now();t._queueId=i;var r=new Promise((t)=>{queue[i]=t});return aggregatorWorker.postMessage(t),r}}var aggregator=dataAggregator;class Waveform{constructor(t=[],i=0,r=1){this.xOffset=i,this.xScale=r,this.errors={nb:0,bars:{above:null,below:null},boxes:{above:null,below:null}},this.setData(t),this.BELOW=Waveform.BELOW,this.ABOVE=Waveform.ABOVE,this.BOX=Waveform.BOX,this.BAR=Waveform.BAR}setData(t,i=null){if(Array.isArray(t[0])){let i=[],r=[];t.forEach((t)=>{i.push(t[0]),r.push(t[1])}),this.setXWaveform(i),t=r}let r=this._makeArray(t.length),a=!1;const s=this.isNaNAllowed();return t.map((t,i)=>{s||t[0]===t[0]&&t[1]===t[1]||(a=!0),r[i]=t}),a&&this.warn('Trying to assign NaN values to a typed array that does not support NaNs. 0\'s will be used instead'),this._setData(r),i&&this.setXWaveform(i),this}getY(t,i=!1){return i&&this.dataInUse?this.dataInUse.y[t]*this.getScale()+this.getShift():this.data[t]*this.getScale()+this.getShift()}setXWaveform(t){if(!(t instanceof Waveform))if(Array.isArray(t))t=new Waveform(t);else throw'Cannot set X waveform. Data is not a valid array.';return this.xdata=t,this.computeXMinMax(),this}hasXWaveform(){return!!this.xdata}getXWaveform(){if(this.xdata)return this.xdata;let t=new Waveform,r=[];for(var a=0;a<this.getLength();a+=1)r.push(this.getX(a));return t.setData(r),this.xdata=t,t}rescaleX(t,i){return this.xScale=i,this.xOffset=t,this.computeXMinMax(),this}getTypedArrayClass(){return this._typedArrayClass||!1}setTypedArrayClass(t){this.getTypedArrayClass()&&this.isNaNAllowed()&&!this.isNaNAllowed(t)&&this.warn('NaN values are not allowed by the new constructor ('+t.name+') while it was allowed by the previous one ('+this._typedArrayClass.name+')'),this.getTypedArrayClass()&&this.isUnsigned()&&!this.isUnsigned(t)&&this.warn('You are switching from signed values to unsigned values. You may experience data corruption if there were some negative values.'),this._typedArrayClass=t,this.data&&this._setData(t.from(this.data)),this.hasXWaveform()&&this.getXWaveform().setTypedArrayClass(t)}isNaNAllowed(t=this._typedArrayClass){return t==Array||t==Float32Array||t==Float64Array}isUnsigned(t=this._typedArrayClass){return t==Uint8Array||t==Uint8ClampedArray||t==Uint16Array||t==Uint32Array}recalculateMinMaxNewPoint(t,i){(t<this.minX||this.minX===void 0)&&(this.minX=t),(t>this.maxX||this.maxX===void 0)&&(this.maxX=t),(i<this.minY||this.minY===void 0)&&(this.minY=i),(i>this.maxY||this.maxY===void 0)&&(this.maxY=i)}prepend(t,i){return'function'==typeof t&&(t=t(this)),'function'==typeof i&&(i=i(this)),this.xdata?this.xdata.prepend(null,t):null===t?this.xOffset-=this.xScale:(this.xdata=this.getXWaveform(),this.xdata.prepend(null,t)),this.data.unshift(i),this.recalculateMinMaxNewPoint(t,i),this}append(t,i){return this.data||(this.data=[]),'function'==typeof t&&(t=t(this)),'function'==typeof i&&(i=i(this)),this.xdata?this.xdata.append(null,t):null!==t&&(this.xdata=this.getXWaveform(),this.xdata.append(null,t)),this.monotoneous&&(i>=this.data[this.data.y]&&!1===this.getMonotoneousAscending()?this.monotoneous=!1:i<=this.data[this.data.y]&&!0===this.getMonotoneousAscending()&&(this.monotoneous=!1)),(1==this.data.length||void 0===this._monotoneousAscending)&&(this.monotoneous=!0,this._monotoneousAscending=i==this.data[0]?void 0:i>this.data[0]),this.data.push(i),this.recalculateMinMaxNewPoint(t,i),this}_makeArray(t){const i=this.getTypedArrayClass();return i?new i(t):Array(t)}_setData(t=this.data){var r=Math.max,a=Math.min;const s=t.length;let n=1,i=t[1]>t[0],o=t[0],l=t[0];for(this._monotoneous=!0;n<s;n++)t[n]!==t[n-1]&&i!=t[n]>t[n-1]&&(this._monotoneous=!1),t[n]===t[n]&&(o=a(t[n],o),l=r(t[n],l));if(this._monotoneous&&(this._monotoneousAscending=t[1]>t[0]),this.hasErrorBars()){for(n=0;n<s;n++)t[n]===t[n]&&(o=a(o,t[n]-this.getMaxError(n,'below')),l=r(l,t[n]+this.getMaxError(n,'above')));this.minY=o,this.maxY=l}else this.minY=o,this.maxY=l;this.data=t,this.computeXMinMax()}computeXMinMax(){if(this.data)if(this.xdata)return;else{const t=this.xOffset+this.xScale*this.getLength(),i=this.xOffset;this.minX=Math.min(t,i),this.maxX=Math.max(t,i)}}getDataInUse(){return this.dataInUse||this.data}getIndexFromVal(t,i=!1,r=Math.round){let a=i&&this.dataInUse?this.dataInUse.y:this.data;let s;return s=this.getIndexFromData(t,a,this.data.getMonotoneousAscending(),r),i&&this.dataInUse&&'aggregateY'==this.dataInUseType?s-s%4:s}getIndexFromX(t,i=!1,r=Math.round){let a;i&&this.dataInUse?a=this.dataInUse.x:this.xdata&&(a=this.xdata.data);let s;return s=this.hasXWaveform()?this.xdata.getIndexFromData(t,a,this.xdata.getMonotoneousAscending(),r):Math.max(0,Math.min(this.getLength()-1,r((t-this.xOffset)/this.xScale))),i&&this.dataInUse&&'aggregateX'==this.dataInUseType?s-s%4:s}getIndexFromXY(t,i,r=!1,a=Math.round,s,n){let o,l;r&&this.dataInUse?(o=this.dataInUse.x,l=this.dataInUse.y):this.xdata&&(o=this.xdata.data,l=this.data);let p;if(this.isXMonotoneous())p=this.hasXWaveform()?this.xdata.getIndexFromData(t,o,this.xdata.getMonotoneousAscending(),a):Math.max(0,Math.min(this.getLength()-1,a((t-this.xOffset)/this.xScale)));else if(!isNaN(i))p=this.getIndexFromDataXY(t,o,i,l,s,n);else return;return r&&this.dataInUse&&'aggregateX'==this.dataInUseType?p-p%4:p}getIndexFromData(t,i,r){if(t-=this.getShift(),t/=this.getScale(),!this.isMonotoneous())throw console.trace(),'Impossible to get the index from a non-monotoneous wave !';return binarySearch(t,i,!r)}getIndexFromDataXY(t,i,r,a,s=1,n=1){return t-=this.getXShift(),t/=this.getXScale(),r-=this.getShift(),r/=this.getScale(),euclidianSearch(t,r,i,a,s,n)}getReductionType(){return this.dataInUseType}getXMin(){return this.xdata?this.xdata.getMin():this.minX}getXMax(){return this.xdata?this.xdata.getMax():this.maxX}getYMin(){return this.minY*this.getScale()+this.getShift()}getYMax(){return this.maxY*this.getScale()+this.getShift()}getMin(){return this.minY*this.getScale()+this.getShift()}getMax(){return this.maxY*this.getScale()+this.getShift()}getMinX(){return this.getXMin()}getMaxX(){return this.getXMax()}getMinY(){return this.minY*this.getScale()+this.getShift()}getMaxY(){return this.maxY*this.getScale()+this.getShift()}getDataY(){return this.data}getData(t){return t&&this.dataInUse?this.dataInUse.y:this.data}setShift(t=0){return this.shift=t,this}getShift(){return this.shift||0}getScale(){return this.scale||1}setScale(t=1){this.scale=t}setXShift(t=0){return this.hasXWaveform()?(this.getXWaveform().setShift(t),this):this}getXShift(){return this.hasXWaveform?this.getXWaveform().getShift():0}setXScale(t=1){return this.hasXWaveform?(this.getXWaveform().setScale(t),this):this}getXScale(){return this.hasXWaveform?this.getXWaveform().getScale():1}getLength(){return this.data?this.data.length:0}getDataToUseFlat(){let t=0,r,a;if(this.dataInUse){r=this.dataInUse.x.length,a=Array(2*r).fill(0);for(var s=0;s<r;s+=1)a[t]=this.dataInUse.x[s],a[t+1]=this.dataInUse.y[s],t+=2}else{r=this.getLength(),a=Array(2*r).fill(0);for(var s=0;s<r;s+=1)a[t+1]=this.data[s],a[t]=this.getX(s),t+=2}return a}fit(t){var i=this;return new Promise(function(r){var a=new FitHost(Object.assign({},{dataY:i,dataX:i.getXWaveform(),done:function(t){r(t)},waveform:new Waveform},t));a.init(),a.fit()})}getX(t,i){return i&&this.dataInUse?this.dataInUse.x[t]*this.getXScale()+this.getXShift():this.xdata?this.xdata.data[t]*this.getXScale()+this.getXShift():this.xOffset+t*this.xScale}getXRaw(t,i){return i&&this.dataInUse?this.dataInUse.x[t]:this.xdata?this.xdata.data[t]:t}_integrateP(t=0,i=this.getLength()-1){var r=Math.round;if(t=r(t),i=r(i),t>i){let r=t;t=i,i=r}var a=i-t+1,s=0;let n=0,o;for(var l=this.getData();t<=i;t++)l.length-1>t&&(o=this.getX(t+1)-this.getX(t),n+=o,s+=l[t]*o);return[s,a,n]}integrateP(t,i){var r=this._integrateP(t,i);return r[0]}integrate(t,i){return this.integrateP(this.getIndexFromX(t),this.getIndexFromX(i))}average(t=0,i=this.getLength()-1){return this.getAverageP(t,i)}mean(){return this.average()}getAverageP(t,i){var r=this._integrateP(t,i);return r[0]/r[2]}getAverageX(t,i){var r=this._integrateX(t,i);return r[0]/r[2]}checkMonotonicity(){let t=1,i=this.getData();const r=this.data.length;for(let a=i[1]>i[0];t<r;t++)if(i[t]!==i[t-1]&&a!=i[t]>i[t-1])return this._monotoneous=!1;return this._monotoneousAscending=i[1]>i[0],this._monotoneous=!0}requireXMonotonicity(){this.xdata&&this.xdata.requireMonotonicity()}requireMonotonicity(){if(!this.isMonotoneous())throw'The wave must be monotonic'}isMonotoneous(){return!!this._monotoneous}isXMonotoneous(){return!this.xdata||this.xdata.isMonotoneous()}invert(){let t=dataY||this.data;return t.reverse(),this.isMonotoneous()&&(this._monotoneousAscending=!this._monotoneousAscending),t}resampleForDisplay(t){let r=0;this.requireXMonotonicity();let i=!1,a=this.getDataY(),s={x:[],y:[]},n=[],o=!1,p=0,d,g,c,u,h,x,m,y;const b=this.getLength();if(!t.xPosition)throw'No position calculation method provided';if(!t.resampleToPx)throw'No "resampleToPx" method was provided. Unit: px per point';if(t.minX>t.maxX){let i=t.minX;t.minX=t.maxX,t.maxX=i}for((this.xdata&&!this.xdata.getMonotoneousAscending()||!this.xdata&&-0>this.xScale)&&(i=!0,r=b);i?0<r:r<b;i?r--:r++){if(y=this.getX(r),t.minX>y){p=r;continue}if(m=t.xPosition(y),!o){for(p?(s.x.push(y),s.y.push(a[p])):p=r;isNaN(a[r]);)i?r--:r++;d=g=c=a[p],u=1,x=m,h=y,p=0,o=!0;continue}if(Math.abs(m-x)>t.resampleToPx||r==b||0==r||isNaN(a[r])){let i=(h+y)/2;if(s.x.push(i),s.y.push(d/u),n.push(i,g,c),void 0!==t.maxX&&y>t.maxX)break;o=!1;continue}d+=a[r],u++,g=Math.min(g,a[r]),c=Math.max(c,a[r])}return this.dataInUseType='resampled',this.dataInUse=s,n}interpolate(t){let i=this.getDataY(),r;if(t=(t-this.getXShift())/this.getXScale(),this.xdata){let r=this.xdata.getData(),a=binarySearch(t,r,!this.xdata.getMonotoneousAscending());return r[a]==t?i[a]:(t-r[a])/(r[a+1]-r[a])*(i[a+1]-i[a])+i[a]}else{r=(t-this.xOffset)/this.xScale;let a=Math.floor(r);return(r-a)*(i[a+1]-i[a])+i[a]}}getMonotoneousAscending(){return this.isMonotoneous()?this._monotoneousAscending:'The waveform is not monotoneous'}getXMonotoneousAscending(){return this.xdata?this.xdata.getMonotoneousAscending():0<this.xScale}isXMonotoneousAscending(){return this.getXMonotoneousAscending(...arguments)}divide(t){return this._arithmetic(t,DIVIDE)}divideBy(){return this.divide(...arguments)}multiply(t){return this._arithmetic(t,MULTIPLY)}multiplyBy(){return this.multiply(...arguments)}log(){return this.logBase(10)}ln(){return this.logBase(Math.E)}logBase(t){var i=Math.log;let r=i(t);this.data.map((t)=>i(t)/r)}add(t){return this._arithmetic(t,ADD)}addBy(){return this.add(...arguments)}subtract(t){return this._arithmetic(t,SUBTRACT)}subtractBy(){return this.subtract(...arguments)}math(t){for(var r=0;r<this.getLength();r++)this.data[r]=t(this.getY(r),this.getX(r));return this._setData(this.data),this}_arithmetic(t,i){if(t instanceof Waveform)return this._waveArithmetic(t,i);return'number'==typeof t?this._numberArithmetic(t,i):void 0}_numberArithmetic(t,r){let a=0,i=this.getLength();if(r==MULTIPLY){for(;a<i;a++)this.data[a]*=t;this.minY*=t,this.maxY*=t}else if(r==DIVIDE){for(;a<i;a++)this.data[a]/=t;this.minY/=t,this.maxY/=t}else if(r==ADD){for(;a<i;a++)this.data[a]+=t;this.minY+=t,this.maxY+=t}else if(r==SUBTRACT){for(;a<i;a++)this.data[a]-=t;this.minY-=t,this.maxY-=t}return this}_waveArithmetic(t,r){let a=this.getDataY(),s=0;const i=this.getLength();if(this.requireXMonotonicity(),t.requireXMonotonicity(),r==MULTIPLY)for(;s<i;s++)a[s]*=t.interpolate(this.getX(s));else if(r==DIVIDE)for(;s<i;s++)a[s]/=t.interpolate(this.getX(s));else if(r==ADD)for(;s<i;s++)a[s]+=t.interpolate(this.getX(s));else if(r==SUBTRACT)for(;s<i;s++)a[s]-=t.interpolate(this.getX(s));return this._setData(a),this}aggregate(t='x'){this._dataAggregating={},this._dataAggregated={},this._dataAggregationDirection=t.toUpperCase();var i=pow2floor(this.getLength());this._dataAggregating=aggregator({minX:this.getMinX(),maxX:this.getMaxX(),minY:this.getMinY(),maxY:this.getMaxY(),data:this.data,xdata:this.xdata?this.xdata.getData():void 0,xScale:this.xScale,xOffset:this.xOffset,numPoints:i,direction:t}).then((t)=>{this._dataAggregated=t.aggregates,console.log(this._dataAggregated),this._dataAggregating=!1})}hasAggregation(){return!!this._dataAggregated}selectAggregatedData(t){if(2>t)return!1;var i=pow2ceil(t);return this._dataAggregated[i]?(this.dataInUseType='aggregate'+this._dataAggregationDirection,void(this.dataInUse=this._dataAggregated[i])):this._dataAggregating?this._dataAggregating:void(this.dataInUseType='none',this.dataInUse={y:this.data,x:this.getXWaveform().data})}duplicate(t){var i=new Waveform;return i._setData(this.getDataY().slice()),i.rescaleX(this.xOffset,this.xShift),i.setShift(this.getShift()),i.setScale(this.getScale()),this.xdata?(t?i.setXWaveform(this.xdata.duplicate()):i.setXWaveform(this.xdata),i.setXShift(this.getXShift()),i.setXScale(this.getXScale())):(i.xOffset=this.xOffset,i.xScale=this.xScale),i}subrangeX(t,r){if(!this.xdata){let i=this.getIndexFromX(t),r=this.getIndexFromX(r);return new Waveform().setData(this.data.slice(i,r)).rescaleX(this.xOffset,this.xScale)}for(var a=new Waveform,s=0,i=this.data.length;s<i;s++)this.data[s]>=t&&this.data[s]<r&&a.append(this.dataX[s],this.data[s]);return a}findLocalMinMax(t,i,r){let a=this.getIndexFromX(t),s=this.getIndexFromX(t+i),n=this.getIndexFromX(t-i);return this.findLocalMinMaxIndex(n,s,r)}findLocalMinMaxIndex(t,r,a){let s;r<t&&(s=r,r=t,t=s);let n,o;if('max'==a){n=Number.NEGATIVE_INFINITY;for(var l=t;l<=r;l++)this.getY(l)>n&&(n=this.getY(l),o=l)}else{n=Number.POSITIVE_INFINITY;for(var l=t;l<=r;l++)this.getY(l)<n&&(n=this.getY(l),o=l)}return o==t||o==r?!1:this.getX(o)}warn(t){console&&console.warn(t)}setUnit(t){return this.unit=t,this}setXUnit(t){return this.hasXWaveform()&&this.xdata.setUnit(t),this.xunit=t,this}getUnit(){return this.unit||''}getXUnit(){return this.hasXWaveform()?this.xdata.getUnit():''|this.xunit}hasXUnit(){return 0<this.getXUnit().length}hasUnit(){return 0<this.getUnit().length}findLevels(t,r){r=Object.assign({box:1,edge:'both',rounding:'before',rangeP:[0,this.getLength()]},r);for(var a=r.rangeP[0],s=[],n=0,i;i=this.findLevel(t,Object.assign({},r,{rangeP:[a,r.rangeP[1]]}));)if(s.push(i),a=Math.ceil(i),n++,1e3<n)return;return s}findLevel(t,r){r=Object.assign({box:1,edge:'both',direction:'ascending',rounding:'before',rangeP:[0,this.getLength()]},r),r.rangeX&&(r.rangeP=r.rangeX.map(this.getIndexFromX));var a=r.box,s,n,o,i,p,l;for(0==a%2&&a++,'descending'==r.direction?(o=r.rangeP[1],p=r.rangeP[0],l=-1):(o=r.rangeP[0],p=r.rangeP[1],l=1);;o+=l){if('descending'==r.direction){if(o<p)break;}else if(o>p)break;if(!(o<r.rangeP[0]+(a-1)/2)){if(o>r.rangeP[1]-(a-1)/2)break;if(s=this.getAverageP(o-(a-1)/2,o+(a-1)/2),void 0==n){n=s<t;continue}if(s>=t&&n){if(n=!1,'ascending'==r.edge||'both'==r.edge)for(i=o+(a-1)/2;i>=o-(a-1)/2;i--)if(this.data[i]>=t&&this.data[i-1]<t)switch(r.rounding){case'before':return i-1;break;case'after':return i;break;case'interpolate':return getIndexInterpolate(t,this.data[i],this.data[i-1],i,i-1);}}else if(s<=t&&!n&&(n=!0,'descending'==r.edge||'both'==r.edge))for(i=o+(a-1)/2;i>=o-(a-1)/2;i--)if(this.data[i]<=t&&this.data[i-1]>t)switch(r.rounding){case'before':return i-1;break;case'after':return i;break;case'interpolate':return getIndexInterpolate(t,this.data[i],this.data[i-1],i,i-1);}}}}normalize(t){let r,a,s,n,o,l;if('max1'==t||'max100'==t){for(r=1,'max100'==t&&(r=100),n=this.data[0],l=1;l<this.getLength();l++)this.data[l]>n&&(n=this.data[l]);for(l=0;l<this.getLength();l++)this.data[l]/=n/r}else if('sum1'==t){for(a=0,l=0;l<this.getLength();l++)a+=this.data[l];for(l=0;l<this.getLength();l++)this.data[l]/=a}else if('max1min0'==t){for(n=this.data[0],s=this.data[0],l=1;l<this.getLength();l++)this.data[l]>n?n=this.data[l]:this.data[l]<s&&(s=this.data[l]);for(o=1/(n-s),l=0;l<this.getLength();l++)this.data[l]=(this.data[l]-s)*o}this.setData(this.data)}setErrorBarX(t){Array.isArray(t)&&(t=new Waveform(t));var i=this.getXWaveform();return i.setErrorBar(t),this}setErrorBarXBelow(t){Array.isArray(t)&&(t=new Waveform(t));var i=this.getXWaveform();return i.setErrorBarBelow(t),this}setErrorBarXAbove(t){Array.isArray(t)&&(t=new Waveform(t));var i=this.getXWaveform();return i.setErrorBarAbove(t),this}setErrorBoxX(t){Array.isArray(t)&&(t=new Waveform(t));var i=this.getXWaveform();return i.setErrorBoxAbove(t),i.setErrorBoxBelow(t),this}setErrorBoxXBelow(t){Array.isArray(t)&&(t=new Waveform(t));var i=this.getXWaveform();return i.setErrorBoxBelow(t),this}setErrorBoxXAbove(t){Array.isArray(t)&&(t=new Waveform(t));var i=this.getXWaveform();return i.setErrorBoxAbove(t),this}setErrorBar(t,i=!0){Array.isArray(t)&&(t=new Waveform(t)),this.errors.nb++,this.errors.nb++,this.errors.bars.bottom=t,this.errors.bars.top=t,i&&this._setData()}setErrorBarBelow(t,i=!0){Array.isArray(t)&&(t=new Waveform(t)),this.errors.nb++,this.errors.bars.below=t,i&&this._setData()}setErrorBarAbove(t,i=!0){Array.isArray(t)&&(t=new Waveform(t)),this.errors.nb++,this.errors.bars.above=t,i&&this._setData()}setErrorBox(t,i=!0){Array.isArray(t)&&(t=new Waveform(t)),this.errors.nb++,this.errors.nb++,this.errors.boxes.above=t,this.errors.boxes.below=t,i&&this._setData()}setErrorBoxBelow(t,i=!0){Array.isArray(t)&&(t=new Waveform(t)),this.errors.nb++,this.errors.boxes.below=t,i&&this._setData()}setErrorBoxAbove(t,i=!0){Array.isArray(t)&&(t=new Waveform(t)),this.errors.boxes.above=t,i&&this._setData()}getMaxError(t,i=Waveform.ABOVE){return Math.max(this.getMaxErrorType(t,i,Waveform.BOX),this.getMaxErrorType(t,i,Waveform.BAR))}getMaxErrorType(t,i=Waveform.ABOVE,r=Waveform.BOX){let a;if(r==Waveform.BOX)a=this.errors.boxes;else if(r==Waveform.BAR)a=this.errors.bars;else throw'Unknown type of error';let s;return(s=a[i])||(i==Waveform.ABOVE?a[i]==Waveform.BELOW&&(s=a.below):a[i]==Waveform.ABOVE&&(s=a.above)),s?s.getY(t):0}getErrorBarXBelow(t){return this.getErrorX(t,Waveform.BELOW,Waveform.BAR)}getErrorBarXAbove(t){return this.getErrorX(t,Waveform.ABOVE,Waveform.BAR)}getErrorBoxXBelow(t){return this.getErrorX(t,Waveform.BELOW,Waveform.BOX)}getErrorBoxXAbove(t){return this.getErrorX(t,Waveform.ABOVE,Waveform.BOX)}getErrorBarYBelow(t){return this.getError(t,Waveform.BELOW,Waveform.BAR)}getErrorBarYAbove(t){return this.getError(t,Waveform.ABOVE,Waveform.BAR)}getErrorBoxYBelow(t){return this.getError(t,Waveform.BELOW,Waveform.BOX)}getErrorBoxYAbove(t){return this.getError(t,Waveform.ABOVE,Waveform.BOX)}getErrorX(t,i=Waveform.ABOVE,r=Waveform.BAR){return!!this.hasXWaveform()&&this.xdata.getError(t,i,r)}getError(t,i=Waveform.ABOVE,r=Waveform.BAR){let a=r==Waveform.BAR?this.errors.bars:this.errors.boxes;if(!a)return!1;let s;if(s=i==Waveform.ABOVE?a.above:a.below)return s==Waveform.ABOVE&&i==Waveform.BELOW?s=a.above:s==Waveform.BELOW&&i==Waveform.ABOVE&&(s=a.below),!!s&&s.getY(t)}hasErrorBars(){return 0<this.errors.nb||this.hasXWaveform()&&0<this.xdata.errors.nb}}function pow2ceil(t){t--;for(var i=2;t>>=1;)i<<=1;return i}function pow2floor(t){for(var i=1;t>>=1;)i<<=1;return i}function getIndexInterpolate(t,i,r,a,s){return(t-i)/(r-i)*(s-a)+a}function euclidianSearch(t,r,a,s,n=1,o=1){var p=Math.pow;let d=Number.MAX_VALUE,g=-1,c;for(var u=0,i=a.length;u<i;u++)c=p((t-a[u])*n,2)+p((r-s[u])*o,2),c<d&&(g=u,d=c);return g}function binarySearch(t,r,a){let s=0,n=r.length,o=n-1,l=0,i=1,p;if(r[s]==t)return s;if(r[o]==t)return o;for(;;){if(l++,100<l)throw'Error loop';for(p=Math.floor((s+o)/2);isNaN(r[p]);){if(p>=r.length-1)return r.length-1;if(0>=p)return 0;p+=i}if(p==s||r[p]==t||p==o)return p;if(r[p]<=t)a?o=p:s=p;else if(r[p]>t)a?s=p:o=p;else return!1;i*=-1}}Waveform.BELOW=Symbol(),Waveform.ABOVE=Symbol(),Waveform.BOX=Symbol(),Waveform.BAR=Symbol();const MULTIPLY=Symbol(),ADD=Symbol(),SUBTRACT=Symbol(),DIVIDE=Symbol(),GraphOptionsDefault={title:'',paddingTop:30,paddingBottom:5,paddingLeft:20,paddingRight:20,close:{left:!0,right:!0,top:!0,bottom:!0},closeColor:'black',fontSize:12,fontFamily:'Myriad Pro, Helvetica, Arial',plugins:{},pluginAction:{},mouseActions:[],keyActions:[],wheel:{},dblclick:{},shapesUnselectOnClick:!0,shapesUniqueSelection:!0},defaultScatterStyle={shape:'circle',r:4};var _constructors=new Map;class Graph$1 extends EventEmitter{constructor(t,r,a){for(var s in super(),this._creation=guid(),this._drawn=!1,t!==Object(t)||t instanceof HTMLElement?'string'==typeof t?t=document.getElementById(t):'number'==typeof t.length&&(t=t[0]):(a=r,r=t,t=null),this.options=extend({},GraphOptionsDefault,r),doDom.bind(this)(),t&&this.setWrapper(t),this.prevented=!1,this.axis={left:[],top:[],bottom:[],right:[]},this.shapes=[],this.shapesLocked=!1,this.plugins={},this.options.pluginAction)this.options.pluginAction.plugin=s,this.options.mouseActions.push(this.options.pluginAction);if(this.selectedShapes=[],this.series=[],this._axesHaveChanged=!0,this.options.hasOwnProperty('padding')&&isNumeric$1(this.options.padding)&&(this.options.paddingTop=this.options.paddingBottom=this.options.paddingLeft=this.options.paddingRight=this.options.padding),this.currentAction=!1,this.ns=Graph$1.ns,this.nsxlink=Graph$1.nsxlink,a)for(var s in a)for(var i=0,n=a[s].length;i<n;i++)'top'==s?this.getTopAxis(i,a[s][i]):'bottom'==s?this.getBottomAxis(i,a[s][i]):'left'==s?this.getLeftAxis(i,a[s][i]):'right'==s?this.getRightAxis(i,a[s][i]):void 0;this._pluginsInit()}setWrapper(t){if(!t)throw'The wrapper DOM element was not found.';if(!t.appendChild)throw'The wrapper appears to be an invalid HTMLElement';if(t.style['-webkit-user-select']='none',t.style['-moz-user-select']='none',t.style['-o-user-select']='none',t.style['-ms-user-select']='none',t.style['user-select']='none',t.style.position='relative',t.style.outline='none',this.wrapper=t,!this.height||!this.width){var i=getComputedStyle(t),r=parseInt(i.width),a=parseInt(i.height);this.setSize(r,a),this._resize()}t.appendChild(this.dom),_registerEvents(this)}getDom(){return this.dom}getId(){return this._creation}getWrapper(){return this.wrapper}setOption(t,i){return this.options[t]=i,this}setTitle(t){this.options.title=t,this.domTitle.textContent=t}displayTitle(){this.domTitle.setAttribute('display','inline')}hideTitle(){this.domTitle.setAttribute('display','none')}hide(){'none'!==this.dom.style.display&&(this.dom.style.display='none')}show(){'none'==this.dom.style.display&&(this.dom.style.display='initial')}redraw(t,i){if(this.width&&this.height)return this.sizeSet?!t||i||haveAxesChanged(this)||hasSizeChanged(this)?(this.executeRedrawSlaves(),refreshDrawingZone(this),!0):(this.executeRedrawSlaves(!0),!1):(this._resize(),this.executeRedrawSlaves(),!0)}executeRedrawSlaves(){this._pluginsExecute('preDraw')}draw(t){this.drawn=!0,this.updateLegend(!0),this.drawSeries(this.redraw(!0,t)),this._pluginsExecute('postDraw')}delayUpdate(){return this._lockUpdate=!0,this}doUpdate(){return this.legend&&this.legend.update(),this.draw(),this.legend&&this.legend.update(),this}resumeUpdate(){return this._lockUpdate=!1,this}isDelayedUpdate(){return this._lockUpdate}setWidth(t,i){this.width=t,i||this._resize()}setHeight(t,i){this.height=t,i||this._resize()}resize(t,i){return t&&i&&this.setSize(t,i),this._resize(),this}setSize(t,i){this.setWidth(t,!0),this.setHeight(i,!0),this.getDrawingHeight(),this.getDrawingWidth()}getWidth(){return this.width}getHeight(){return this.height}getPaddingTop(){return this.options.paddingTop}getPaddingLeft(){return this.options.paddingLeft}getPaddingBottom(){return this.options.paddingBottom}getPaddingRight(){return this.options.paddingRight}getDrawingHeight(t){return t&&this.innerHeight?this.innerHeight:this.innerHeight=this.height-this.options.paddingTop-this.options.paddingBottom}getDrawingWidth(t){return t&&this.innerWidth?this.innerWidth:this.innerWidth=this.width-this.options.paddingLeft-this.options.paddingRight}cacheOffset(){this.offsetCached=getOffset(this.wrapper)}uncacheOffset(){this.offsetCached=!1}getXAxis(t,i){return 0<this.axis.top.length&&0==this.axis.bottom.length?this.getTopAxis(t,i):this.getBottomAxis(t,i)}getYAxis(t,i){return 0<this.axis.right.length&&0==this.axis.left.length?this.getRightAxis(t,i):this.getLeftAxis(t,i)}getTopAxis(t,i){return _getAxis(this,t,i,'top')}getBottomAxis(t,i){return _getAxis(this,t,i,'bottom')}getLeftAxis(t,i){return _getAxis(this,t,i,'left')}getRightAxis(t,i){return _getAxis(this,t,i,'right')}setXAxis(t,i){this.setBottomAxis(t,i)}setYAxis(t,i){this.setLeftAxis(t,i)}setLeftAxis(t,i){i=i||0,this.axis.left[i]&&this.axis.left[i].kill(),this.axis.left[i]=t}setRightAxis(t,i){i=i||0,this.axis.right[i]&&this.axis.right[i].kill(),this.axis.right[i]=t}setTopAxis(t,i){i=i||0,this.axis.top[i]&&this.axis.top[i].kill(),this.axis.top[i]=t}setBottomAxis(t,i){i=i||0,this.axis.bottom[i]&&this.axis.bottom[i].kill(),this.axis.bottom[i]=t}killAxis(t,i=!1,r=!1){var a;t.isX()&&(-1<(a=this.axis.bottom.indexOf(t))&&this.axis.bottom.splice(a,1),-1<(a=this.axis.top.indexOf(t))&&this.axis.top.splice(a,1),!r&&this.series.map((i)=>{i.getXAxis()==t&&i.kill()})),t.isY()&&(-1<(a=this.axis.left.indexOf(t))&&this.axis.left.splice(a,1),-1<(a=this.axis.right.indexOf(t))&&this.axis.right.splice(a,1),!r&&this.series.map((i)=>{i.getYAxis()==t&&i.kill()})),this.axisGroup.removeChild(t.group),this.groupPrimaryGrids.removeChild(t.gridPrimary),this.groupSecondaryGrids.removeChild(t.gridSecondary),i||this.draw(!0)}hasXAxis(t){return this.hasTopAxis(t)||this.hasBottomAxis(t)}hasYAxis(t){return this.hasLeftAxis(t)||this.hasRightAxis(t)}hasTopAxis(t){return this.hasAxis(t,this.axis.top)}hasBottomAxis(t){return this.hasAxis(t,this.axis.bottom)}hasLeftAxis(t){return this.hasAxis(t,this.axis.left)}hasRightAxis(t){return this.hasAxis(t,this.axis.right)}hasAxis(t,r){for(var a=0,i=r.length;a<i;a++){if(r[a]==t)return!0;if(r[a].hasAxis(t))return!0}return!1}autoscaleAxes(){return this._applyToAxes('setMinMaxToFitSeries',null,!0,!0),this}autoscale(){return this.autoscaleAxes(...arguments)}autoScale(){return this.autoscaleAxes(...arguments)}autoScaleAxes(){return this.autoscaleAxes(...arguments)}autoScaleAxis(t){return t?(t.setMinMaxToFitSeries(),this):this}setBackgroundColor(t){return this.rectEvent.setAttribute('fill',t),this}getAxisState(){var t={};for(var r in this.axis)t[r]=this.axis[r].map(function(t){return[t.getCurrentMin(),t.getCurrentMax()]});return t}setAxisState(t){var r,a;for(var s in t)if(this.axis[s])for(r=0,a=t[s].length;r<a;r++)this.axis[s][r]&&(this.axis[s][r].setCurrentMin(t[s][r][0]),this.axis[s][r].setCurrentMax(t[s][r][1]));this.draw()}saveAxisState(t){return this.savedAxisState=this.savedAxisState||{},this.savedAxisState[t]=this.getAxisState(),this}recallAxisState(){return this.savedAxisState[savedName]&&this.recallAxisState(this.savedAxisState[savedName]),this}_applyToAxis(t){switch(t){case'string':return function(t,r,a){for(var s=0;s<this.axis[t].length;s++)this.axis[t][s][r].apply(this.axis[t][s],a)};break;case'function':return function(t,r,a){for(var s=0;s<this.axis[t].length;s++)r.call(this,this.axis[t][s],t,a)};}}getBoundaryAxis(t,i,r){var a=this.getBoundaryAxisFromSeries(t,i,r);return a}getBoundaryAxisFromSeries(t,r,a){var s='min'==r,n=t.isX()?['getMinX','getMaxX']:['getMinY','getMaxY'],o=n[s?0:1],p=s?+Infinity:-Infinity,d,g,c,u,h,i;for(d=p,c=this.getSeriesFromAxis(t),(h=0,i=c.length);h<i;h++)(g=c[h],!!g.isShown())&&(u=g[o](a),d=Math[r](isNaN(d)?p:d,isNaN(u)?p:u));return d}getSeriesFromAxis(t){for(var r=[],a=this.series.length-1;0<=a;a--)(this.series[a].getXAxis()==t||this.series[a].getYAxis()==t)&&r.push(this.series[a]);return r}updateDataMinMaxAxes(t){var r=['bottom','top','left','right'],a,s,n,o;for(s=0,n=r.length;s<n;s++)for(o=this.axis[r[s]].length-1;0<=o;o--){a=this.axis[r[s]][o],!a.isShown();let i=this.getBoundaryAxis(this.axis[r[s]][o],'min',t),n=this.getBoundaryAxis(this.axis[r[s]][o],'max',t);isFinite(i)&&a.setMinValueData(i),isFinite(n)&&a.setMaxValueData(n)}}_applyToAxes(t,r,a,s){var n=[],o=0,i;for((a||void 0==a)&&(n.push('top'),n.push('bottom')),(s||void 0==s)&&(n.push('left'),n.push('right')),i=n.length;o<i;o++)this._applyToAxis(typeof t).call(this,n[o],t,r)}findAxesLinkedTo(t){var i=[];return this._applyToAxes(function(r){r.linkedToAxis&&r.linkedToAxis.axis==t&&i.push(r)},{},t instanceof this.getConstructor('graph.axis.x'),t instanceof this.getConstructor('graph.axis.y')),i}_axisHasChanged(){this._axesHaveChanged=!0}newSerie(t,i,r){let a;return('object'==typeof i||r||(r=i,i={}),r||(r=Graph$1.SERIE_LINE),a=this.getSerie(t))?a:(a=makeSerie(this,t,i,r))?(this.series.push(a),this.emit('newSerie',a),a):void 0}getSerie(t){if('number'==typeof t)return this.series[t]||!1;'function'==typeof t&&(t=t());for(var r=0,i=this.series.length;r<i;r++)if(this.series[r].getName()==t||this.series[r]==t)return this.series[r];return!1}getSeries(){return this.series}allSeries(...t){return this.series.filter((i)=>t.include(i.getType()))}drawSerie(t,i){if(!t.draw)throw'Serie has no method draw';t.draw(i)}drawSeries(t){if(this.width&&this.height)for(var r=this.series.length-1;0<=r;r--)this.series[r].isShown()&&this.drawSerie(this.series[r],t)}resetSeries(){this.removeSeries()}killSeries(){this.resetSeries()}removeSeries(){for(;this.series[0];)this.series[0].kill(!0);this.series=[],this.legend&&this.legend.update()}selectSerie(t,i){'object'==typeof t||(t=this.getSerie(t));this.selectedSerie==t&&this.selectedSerie.selectionType==i||(this.selectedSerie!==t&&this.selectedSerie&&this.unselectSerie(this.selectedSerie),this.selectedSerie=t,this.triggerEvent('onSelectSerie',t),t.select(i||'selected'))}getSelectedSerie(){return this.selectedSerie}unselectSerie(t){t.unselect&&(t.unselect(),this.selectedSerie=!1,this.triggerEvent('onUnselectSerie',t))}getShapesOfSerie(t){for(var r=[],a=this.shapes.length-1;0<=a;a--)this.shapes[a].getSerie()==t&&r.push(this.shapes[a]);return r}makeToolbar(t){var i=this.getConstructor('graph.toolbar');return i?this.toolbar=new i(this,t):throwError('No constructor exists for toolbar')}getShapes(){return this.shapes||[]}newShape(t,r,a=!1,s){if(this.prevent(!1),!a&&(this.emit('beforeNewShape',r),this.prevent(!1)))return!1;'object'==typeof t&&(a=r,r=t,t=r.type),r=r||{},r._id=guid();var n;if(n='function'==typeof t?t:this.getConstructor('graph.shape.'+t),!n)return throwError('No constructor for this shape');var o=new n(this,r);if(!o)return throwError('Failed to construct shape.');if(o.type=t,o.graph=this,o._data=r,void 0!==r.properties&&o.setProperties(r.properties),o.init(this,s),void 0!==r.props)for(var p in r.props)o.setProp(p,r.props[p]);if(r.position)for(var p=0,i=r.position.length;p<i;p++)o.setPosition(new Position(r.position[p]),p);if(void 0!==r.fillColor&&o.setFillColor(r.fillColor),void 0!==r.fillOpacity&&o.setFillOpacity(r.fillOpacity),void 0!==r.strokeColor&&o.setStrokeColor(r.strokeColor),void 0!==r.strokeWidth&&o.setStrokeWidth(r.strokeWidth),void 0!==r.layer&&o.setLayer(r.layer),!0==r.locked&&o.lock(),!0==r.movable&&o.movable(),!0==r.selectable&&o.selectable(),!0==r.resizable&&o.resizable(),void 0!==r.attributes&&o.setProp('attributes',r.attributes),void 0!==r.handles&&o.setProp('handles',r.handles),void 0!==r.selectOnMouseDown&&o.setProp('selectOnMouseDown',!0),void 0!==r.selectOnClick&&o.setProp('selectOnClick',!0),void 0!==r.transforms&&Array.isArray(r.transforms)&&r.transforms.forEach(({type:t,value:i})=>{o.addTransform(t,i)}),void 0!==r.highlightOnMouseOver&&o.setProp('highlightOnMouseOver',!0),r.labelEditable&&o.setProp('labelEditable',r.labelEditable),r.labels&&!r.label&&(r.label=r.labels),void 0!==r.label){Array.isArray(r.label)||(r.label=[r.label]);for(var p=0,i=r.label.length;p<i;p++)o.showLabel(p),o.setLabelText(r.label[p].text,p),o.setLabelPosition(r.label[p].position,p),o.setLabelColor(r.label[p].color||'black',p),o.setLabelSize(r.label[p].size,p),o.setLabelAngle(r.label[p].angle||0,p),o.setLabelBaseline(r.label[p].baseline||'no-change',p),o.setLabelAnchor(r.label[p].anchor||'start',p),o.setLabelBackgroundColor(r.label[p].backgroundColor||'transparent',p),o.setLabelBackgroundOpacity(r.label[p].backgroundOpacity||1,p)}return r.serie&&o.setSerie(this.getSerie(r.serie)),o.createHandles(),o.applyStyle(),this.shapes.push(o),a||this.emit('newShape',o,r),o}newPosition(){return new Position(...arguments)}redrawShapes(){for(var t=0,i=this.shapes.length;t<i;t++)this.shapes[t].redraw()}removeShapes(){for(var t=0,i=this.shapes.length;t<i;t++)this.shapes[t]&&this.shapes[t].kill&&this.shapes[t].kill(!0);this.shapes=[]}selectShape(t,i){if(t){if(-1<this.selectedShapes.indexOf(t))return!1;if(!t.isSelectable())return!1;i||this.emit('beforeShapeSelect',t),this.prevent(!1)||(0<this.selectedShapes.length&&this.options.shapesUniqueSelection&&this.unselectShapes(i),t._select(i),this.selectedShapes.push(t),!i&&this.emit('shapeSelect',t))}}getSelectedShapes(){return this.selectedShapes}unselectShape(t,i){if(-1!=this.selectedShapes.indexOf(t))return i||this.emit('beforeShapeUnselect',t),this.cancelUnselectShape?void(this.cancelUnselectShape=!1):void(t._unselect(),this.selectedShapes.splice(this.selectedShapes.indexOf(t),1),!i&&this.emit('shapeUnselect',t))}unselectShapes(t){for(;this.selectedShapes[0];)this.unselectShape(this.selectedShapes[0],t);return this}_removeShape(t){this.shapes.splice(this.shapes.indexOf(t),1)}appendShapeToDom(t){t.isHTML()&&this.wrapper.insertBefore(t._dom,this.dom),this.getLayer(t.getLayer(),'shape').appendChild(t.group)}removeShapeFromDom(t){t.isHTML()&&this.wrapper.removeChild(t._dom),this.getLayer(t.getLayer(),'shape').removeChild(t.group)}appendSerieToDom(t){this.getLayer(t.getLayer(),'serie').appendChild(t.groupMain)}removeSerieFromDom(t){this.getLayer(t.getLayer(),'serie').removeChild(t.groupMain)}getLayer(t,r){if(!this.layers[t]){this.layers[t]=[],this.layers[t][0]=document.createElementNS(Graph$1.ns,'g'),this.layers[t][0].setAttribute('data-layer',t),this.layers[t][1]=document.createElementNS(Graph$1.ns,'g'),this.layers[t][2]=document.createElementNS(Graph$1.ns,'g'),this.layers[t][0].appendChild(this.layers[t][1]),this.layers[t][0].appendChild(this.layers[t][2]);for(var a=1,i;!(i=this.layers[t-a])&&0<=t-a;)a++;i?i.nextSibling?this.plotGroup.insertBefore(this.layers[t][0],i.nextSibling):this.plotGroup.appendChild(this.layers[t][0]):this.plotGroup.insertBefore(this.layers[t][0],this.plotGroup.firstChild)}return this.layers[t]['shape'==r?2:1]}focus(){this.wrapper.focus()}elementMoving(t){this.bypassHandleMouse=t}stopElementMoving(t){t&&t==this.bypassHandleMouse?this.bypassHandleMouse=!1:!t&&(this.bypassHandleMouse=!1)}_makeClosingLines(){this.closingLines={};for(var t=['top','bottom','left','right'],r=0;r<4;r++){var i=document.createElementNS(Graph$1.ns,'line');i.setAttribute('stroke',this.options.closeColor),i.setAttribute('shape-rendering','crispEdges'),i.setAttribute('stroke-linecap','square'),i.setAttribute('display','none'),this.closingLines[t[r]]=i,this.graphingZone.appendChild(i)}}isActionAllowed(t,i){if((i.type===t.type||void 0===i.type&&'mousedown'===t.type||('wheel'===t.type||'mousewheel'===t.type)&&'mousewheel'==i.type)&&!(i.enabled&&('function'==typeof i.enabled?!i.enabled(this):!actions.enabled))){if(i.key&&i.key!==t.keyCode){if({backspace:8,enter:13,tab:9,shift:16,ctrl:17,alt:18,pause:19,escape:27,up:33,down:34,left:37,right:39}[i.key]!==t.keyCode)return}return void 0===i.shift&&(i.shift=!1),void 0===i.ctrl&&(i.ctrl=!1),void 0===i.meta&&(i.meta=!1),void 0===i.alt&&(i.alt=!1),t.shiftKey==i.shift&&t.ctrlKey==i.ctrl&&t.metaKey==i.meta&&t.altKey==i.alt}}forcePlugin(t){this.forcedPlugin=t}unforcePlugin(){this.forcedPlugin=!1}_pluginsExecute(t,...r){for(var a in this.plugins)this.plugins[a]&&this.plugins[a][t]&&this.plugins[a][t].apply(this.plugins[a],r)}_pluginExecute(t,i,r){return t?this.plugins[t]&&this.plugins[t][i]?(this.plugins[t][i].apply(this.plugins[t],r),!0):void 0:void 0}pluginYieldActiveState(){this.activePlugin=!1}_serieExecute(t,i,r){'object'!=typeof serie&&(serie=this.getSerie(serie)),'function'==typeof serie[i]&&serie.apply(serie,r)}_pluginsInit(){var t,r,a;for(var s in this.options.plugins)r=s,a=this.options.plugins[s],t=this.getConstructor('graph.plugin.'+r),t?(this.plugins[r]=new t(a),mapEventEmission(this.plugins[r].options,this.plugins[r]),this.plugins[r].init(this,a)):throwError('Plugin "'+r+'" has not been registered')}getPlugin(t){var i=this.plugins[t];return i?i:throwError('Plugin "'+t+'" has not been loaded or properly registered')}triggerEvent(){var t=arguments[0],i=Array.prototype.splice.apply(arguments,[0,1]);return'function'==typeof this.options[t]?this.options[t].apply(this,arguments):void 0}makeLegend(t){if(this.legend)return this.legend;var i=this.getConstructor('graph.legend');if(i)this.legend=new i(this,t);else return throwError('Graph legend is not available as it has not been registered');return this.legend}updateLegend(t=!1){if(this.legend)return this.legend.update(t),this}getLegend(){return this.legend?this.legend:void 0}requireLegendUpdate(){this.legend&&this.legend.requireDelayedUpdate()}orthogonalProjectionSetup(){this.options.zAxis=extend(!0,{maxZ:10,minZ:0,shiftX:-25,shiftY:-15,xAxis:this.getXAxis(),yAxis:this.getYAxis()})}orthogonalProjectionUpdate(){this.zAxis||(this.zAxis={g:document.createElementNS(Graph$1.ns,'g'),l:document.createElementNS(Graph$1.ns,'line')},this.zAxis.g.appendChild(this.zAxis.l),this.groupGrids.appendChild(this.zAxis.g));let t=this.options.zAxis.xAxis,r=this.options.zAxis.yAxis;var a=t.getMinPx(),s=r.getMinPx(),n=t.getZProj(this.options.zAxis.maxZ),o=r.getZProj(this.options.zAxis.maxZ);this.zAxis.l.setAttribute('stroke','black'),this.zAxis.l.setAttribute('x1',a),this.zAxis.l.setAttribute('x2',a+n),this.zAxis.l.setAttribute('y1',s),this.zAxis.l.setAttribute('y2',s+o),this.updateDataMinMaxAxes(!0);var l=this.series.map((t)=>[t.getZPos(),t]);l.sort((t,i)=>i[0]-t[0]);let p=0;l.forEach((t)=>{t[1].setLayer(p),this.appendSerieToDom(t[1]),p++}),this.drawSeries(!0)}kill(){this.wrapper.removeChild(this.dom)}_removeSerie(t){this.series.splice(this.series.indexOf(t),1),this._pluginsExecute('serieRemoved',t)}contextListen(t,i,r){if(this.options.onContextMenuListen)return this.options.onContextMenuListen(t,i,r)}lockShapes(){this.shapesLocked=!0;for(var t=0,i=this.shapes.length;t<i;t++)this.shapes[t].moving=!1,this.shapes[t].resizing=!1}unlockShapes(){this.shapesLocked=!1}prevent(t){var i=this.prevented;return-1!=t&&(this.prevented=void 0==t||t),i}_getXY(t){var i=t.clientX,r=t.clientY,a=this.offsetCached||getOffset(this.wrapper);return i-=a.left,r-=a.top,{x:i,y:r}}_resize(){this.width&&this.height&&(this.getDrawingWidth(),this.getDrawingHeight(),this.sizeSet=!0,this.dom.setAttribute('width',this.width),this.dom.setAttribute('height',this.height),this.domTitle.setAttribute('x',this.width/2),this._sizeChanged=!0,this.drawn&&(this.requireLegendUpdate(),this.draw(!0)))}updateGraphingZone(){setAttributeTo(this.graphingZone,{transform:'translate('+this.options.paddingLeft+', '+this.options.paddingTop+')'}),this._sizeChanged=!0}getDrawingSpaceWidth(){return()=>this.drawingSpaceWidth}getDrawingSpaceHeight(){return()=>this.drawingSpaceHeight}getDrawingSpaceMinX(){return()=>this.drawingSpaceMinX}getDrawingSpaceMinY(){return()=>this.drawingSpaceMinY}getDrawingSpaceMaxX(){return()=>this.drawingSpaceMaxX}getDrawingSpaceMaxY(){return()=>this.drawingSpaceMaxY}trackingLine(t){var i=this;return'boolean'==typeof t?void(this.options.trackingLine&&(this.options.trackingLine.enable=t)):(t&&(this.options.trackingLine=t),t.series=t.series||[],t.enable=void 0===t.enable||!!t.enable,'individual'==t.mode?t.series&&(!Array.isArray(t.series)&&('all'==t.series?t.series=this.series.map(()=>{}):t.series=[t.series]),t.series.forEach((t)=>{if('object'!=typeof t.serie){if('object'!=typeof t)throw'Misuse of the trackingLine() method. Each serie must be an object with the serie property: { series: [ { serie: jsGraphSerie, options: { ... someOptions } } ] }';t.serie=this.getSerie(t.serie)}t.serie&&i.addSerieToTrackingLine(t.serie,t)})):t.series.map((t)=>{t.serie.disableTracking()}),!t.noLine)?(this.trackingObject||(this.trackingObject=this.newShape('line',extend(!0,{position:[{y:'min'},{y:'max'}],stroke:'black',layer:-1},t.trackingLineShapeOptions))),this.trackingObject.draw(),this.trackingObject):void 0}addSerieToTrackingLine(t,i){this.options.trackingLine||this.trackingLine({mode:'individual'}),this.options.trackingLine.series.push(Object.assign({serie:t},i)),t.enableTracking((t,r,a,s)=>{this.options.trackingLine.enable&&r&&(this.trackingObject&&(this.trackingObject.show(),this.trackingObject.getPosition(0).x=r.trueX,this.trackingObject.getPosition(1).x=r.trueX,this.trackingObject.redraw()),t._trackingLegend=_trackingLegendSerie(this,{serie:t},a,s,t._trackingLegend,i.textMethod?i.textMethod:(t)=>{for(var r in t){return t[r].serie.serie.getName()+': '+t[r].serie.serie.getYAxis().valueToHtml(t[r].yValue)}},r.trueX),t._trackingLegend&&(t._trackingLegend.style.display='block'))},(t)=>{this.trackingObject&&this.trackingObject.hide(),t.trackingShape&&t.trackingShape.hide(),t._trackingLegend&&(t._trackingLegend.style.display='none'),t._trackingLegend=_trackingLegendSerie(this,{serie:t},!1,!1,t._trackingLegend,!1,!1)})}setKatexRenderer(t){this._katexRenderer=t}hasKatexRenderer(){return!!this._katexRenderer}renderWithKatex(t,i){if(this._katexRenderer){i?i.removeChild(i.firstChild):i=document.createElementNS(Graph$1.ns,'foreignObject');let r=document.createElement('div');return i.appendChild(r),this._katexRenderer(t,r),i}return!1}static fromJSON(t,i){let r={},a={left:[],top:[],right:[],bottom:[]},s,n;return t.title&&(r.title=t.title),t.axis&&t.axis.map(function(t){t.type||throwError('Axis type is required (top, bottom, left or right)');var i={};t.label&&(i.labelValue=t.label),void 0!==t.unit&&(i.unit=t.unit),void 0!==t.unitWrapperAfter&&(i.unitWrapperAfter=t.unitWrapperAfter),void 0!==t.unitWrapperBefore&&(i.unitWrapperBefore=t.unitWrapperBefore),void 0!==t.min&&(i.forcedMin=t.min),void 0!==t.max&&(i.forcedMax=t.max),void 0!==t.flip&&(i.flipped=t.flip),a[t.type].push(i),t._jsGraphIndex=a[t.type].length-1}),s=new Graph$1(i,r,a),t.width&&s.setWidth(t.width),t.height&&s.setHeight(t.width),s._resize(),t.data&&t.data.map(function(r){var a=r.type,o={},p,d;let g;switch(r.type){case'bar':throwError('Bar charts not supported'),a=!1;break;case'color':a=Graph$1.SERIE_LINE_COLORED;break;case'scatter':a=Graph$1.SERIE_SCATTER;break;case'box':a=Graph$1.SERIE_BOX,('x'==r.orientation||'y'==r.orientation)&&(o.orientation=r.orientation);break;default:a=Graph$1.SERIE_LINE;}if(a!==Graph$1.SERIE_BOX&&(g=Graph$1.newWaveform()),!a)return void throwError('No valid serie type was found');p=s.newSerie(r.id||r.label||guid(),o,a),r.lineStyle&&(Array.isArray(lineStyle)&&(lineStyle={unselected:lineStyle}),Object.entries(lineStyle).forEach(([t,i])=>{var r={};a===Graph$1.SERIE_LINE?(void 0!==i.lineWidth&&(r.lineWidth=i.lineWidth),void 0!==i.color&&(r.lineColor=i.color),i.lineStyle&&(r.lineStyle=i.lineStyle),p.setStyle(r,t)):void 0}));let c={},u={};if(r.defaultStyle&&(c=r.defaultStyle),r.defaultStyles&&(u=r.defaultStyles),r.styles){let t=Array.isArray(r.styles)?{unselected:r.styles}:r.styles;let i=new Set(Object.keys(u).concat(Object.keys(t)));i.forEach((i)=>{let r=[],s;t&&t[i]&&(r=t[i],!Array.isArray(r)&&(r=[r]),s=r.map(function(t){switch(a){case Graph$1.SERIE_LINE:return{type:t.shape,zoom:t.zoom,strokeWidth:t.lineWidth,strokeColor:t.lineColor,fillColor:t.color,points:t.points};break;case Graph$1.SERIE_BOX:return t;break;case Graph$1.SERIE_SCATTER:return t;}})),a===Graph$1.SERIE_LINE?p.setMarkers(s,i):a===Graph$1.SERIE_SCATTER?p.setStyle(Object.assign({},defaultScatterStyle,c,u[i]||{}),s,i):a===Graph$1.SERIE_BOX?p.setStyle(s[0],i||'unselected'):void 0})}if(r.color&&a==Graph$1.SERIE_LINE_COLORED&&p.setColors(r.color),a!==Graph$1.SERIE_BOX&&g.setData(r.y,r.x),!!p){let o=[],l=[],c=[],u=[],x=[],m=[],y=[],b=[];if(void 0!==g){if(r.errorX)for(var h=0,i=r.errorX.length;h<i;h++)Array.isArray(r.errorX[h])?(o.push(r.errorX[h][0]),l.push(r.errorX[h][1])):(o.push(r.errorX[h]),l.push(r.errorX[h]));else if(r.errorBarX||r.errorBoxX){if(r.errorBarX)for(var h=0,i=r.errorBarX.length;h<i;h++)Array.isArray(r.errorBarX[h])?(o.push(r.errorBarX[h][0]),l.push(r.errorBarX[h][1])):(o.push(r.errorBarX[h]),l.push(r.errorBarX[h]));if(r.errorBoxX)for(var h=0,i=r.errorBoxX.length;h<i;h++)Array.isArray(r.errorBoxX[h])?(x.push(r.errorBoxX[h][0]),m.push(r.errorBoxX[h][1])):(x.push(r.errorBoxX[h]),m.push(r.errorBoxX[h]))}if(r.errorY)for(var h=0,i=r.errorY.length;h<i;h++)Array.isArray(r.errorY[h])?(c.push(r.errorY[h][0]),u.push(r.errorY[h][1])):(c.push(r.errorY[h]),u.push(r.errorY[h]));else if(r.errorBarY||r.errorBoxY){if(r.errorBarY)for(var h=0,i=r.errorBarY.length;h<i;h++)Array.isArray(r.errorBarY[h])?(c.push(r.errorBarY[h][0]),u.push(r.errorBarY[h][1])):(c.push(r.errorBarY[h]),u.push(r.errorBarY[h]));if(r.errorBoxY)for(var h=0,i=r.errorBoxY.length;h<i;h++)Array.isArray(r.errorBoxY[h])?(y.push(r.errorBoxY[h][0]),b.push(r.errorBoxY[h][1])):(y.push(r.errorBoxY[h]),b.push(r.errorBoxY[h]))}n={},0<o.length&&(g.setErrorBarXAbove(Graph$1.newWaveform(o)),n.right={}),0<l.length&&(g.setErrorBarXAbove(Graph$1.newWaveform(o)),n.left={}),0<c.length&&(g.setErrorBarXAbove(Graph$1.newWaveform(c)),n.top={}),0<u.length&&(g.setErrorBarXAbove(Graph$1.newWaveform(c)),n.bottom={}),p.setErrorBarStyle(n),n={},0<x.length&&(g.setErrorBoxXAbove(Graph$1.newWaveform(x)),n.right={}),0<m.length&&(g.setErrorBoxXBelow(Graph$1.newWaveform(m)),n.left={}),0<y.length&&(g.setErrorBoxAbove(Graph$1.newWaveform(y)),n.top={}),0<b.length&&(g.setErrorBoxBelow(Graph$1.newWaveform(b)),n.bottom={}),p.setErrorBoxStyle(n)}switch(t.axis?(d=t.axis[r.xAxis],d&&('top'===d.type||'bottom'===d.type)?'top'==d.type?p.setXAxis(s.getTopAxis(d._jsGraphIndex)):'bottom'==d.type&&p.setXAxis(s.getBottomAxis(d._jsGraphIndex)):(warn('No x axis found. Setting automatically'),p.setXAxis(s.getXAxis(0))),d=t.axis[r.yAxis],d&&('left'===d.type||'right'===d.type)?'left'==d.type?p.setYAxis(s.getLeftAxis(d._jsGraphIndex)):'right'==d.type&&p.setYAxis(s.getRightAxis(d._jsGraphIndex)):(warn('No y axis found. Setting automatically'),p.setYAxis(s.getYAxis(0)))):(warn('No axes found. Setting automatically'),p.autoAxis()),a){case Graph$1.SERIE_BOX:p.setData(r.boxes);break;default:case Graph$1.SERIE_SCATTER:case Graph$1.SERIE_LINE_COLORED:case Graph$1.SERIE_LINE:p.setWaveform(g);}}}),s.autoscaleAxes(),s.draw(),s}exportToSchema(){let t={title:this.options.title,width:this.getWidth(),height:this.getHeight()},i=[],r={x:[],y:[]};['top','bottom','left','right'].map((t)=>{this.axis[t]&&(i=i.concat(this.axis[t].map((i)=>({type:t,label:i.options.label,unit:i.options.unit,min:i.options.forcedMin,max:i.options.forcedMax,flip:i.options.flipped}))),'top'==t||'bottom'==t?r.x=r.x.concat(this.axis[t]):r.y=r.y.concat(this.axis[t]))}),t.axis=i;let a=(t)=>{switch(t){case Graph$1.SERIE_LINE:return'line';break;case Graph$1.SERIE_BAR:return'bar';break;case Graph$1.SERIE_LINE_COLORED:return'color';break;case Graph$1.SERIE_SCATTER:return'scatter';}},s=(t,r)=>{let a=[];switch(t.getType()){case Graph$1.SERIE_LINE:for(var s=0;s<t.data.length;s++)for(var i=0;i<t.data[s].length-1;i+=2)a.push(t.data[s][i+(r&&t.isFlipped()||!r&&!t.isFlipped()?1:0)]);break;case Graph$1.SERIE_SCATTER:for(var i=0;i<t.data.length-1;i+=2)a.push(t.data[s+(r&&t.isFlipped()||!r&&!t.isFlipped()?1:0)]);}return a};return t.data=[].concat(this.series.map((t)=>{style=[];let i=[];if(t.getType()==Graph$1.SERIE_LINE)for(var n in t.styles){i.push({styleName:n,color:t.styles[n].lineColor,lineWidth:t.styles[n].lineWidth,lineStyle:t.styles[n].lineStyle});let r={styleName:n,styles:[]};style.push(r),r.styles=r.styles.concat((t.styles[n].markers||[]).map((t)=>({shape:t.type,zoom:t.zoom,lineWidth:t.strokeWidth,lineColor:t.strokeColor,color:t.fillColor,points:t.points})))}return{label:t.getLabel(),id:t.getName(),type:a(t.getType()),x:s(t,!0),y:s(t,!1),xAxis:r.x.indexOf(t.getXAxis()),yAxis:r.y.indexOf(t.getYAxis()),style:style,lineStyle:i}})),t}static registerConstructor(t,i){return _constructors.has(t)?throwError('Constructor '+i+' already exists.'):void _constructors.set(t,i)}static getConstructor(t,i=!1){return _constructors.has(t)?_constructors.get(t):!i&&throwError('Constructor "'+t+'" doesn\'t exist')}static newWaveform(){return new Waveform(...arguments)}static waveform(){return new Waveform(...arguments)}}Graph$1.prototype.getConstructor=Graph$1.getConstructor;function makeSerie(t,i,r,a){var s=t.getConstructor(a,!0);if(s||'string'!=typeof a||(s=t.getConstructor('graph.serie.'+a,!0)),s){var n=new s(t,i,r);t.appendSerieToDom(n)}else return throwError('No constructor exists for the serie type provided. Use Graph.registerConstructor( name, constructor ) first is you use your own series');return n}function getAxisLevelFromSpan(t,r){for(var a=0,i=r.length,s;a<i;a++){s=!0;for(var n=0,o=r[a].length;n<o;n++)t[0]<r[a][n][0]&&t[1]<r[a][n][0]||t[0]>r[a][n][1]&&t[1]>r[a][n][1]||(s=!1);if(s)return r[a].push(t),a}return r.push([t]),r.length-1}function refreshDrawingZone(t){var i=Math.max,r={top:[],bottom:[],left:[],right:[]},a={top:[],bottom:[],left:[],right:[]};t._painted=!0,t._applyToAxes(function(t,s){if(!t.isShown())return void t.hideGroup();if(t.showGroup(),!t.floating){var n=getAxisLevelFromSpan(t.getSpan(),a[s]);t.setLevel(n),r[s][n]=i(t.getAxisPosition(),r[s][n]||0)}},!1,!0,!1);var s=r.top.reduce(function(t,i){return t+i},0),n=r.bottom.reduce(function(t,i){return t+i},0);t.drawingSpaceHeight=t.getDrawingHeight()-s-n,[r.top,r.bottom].map(function(t){t.reduce(function(i,r,a){return t[a]=i+r,i+r},0)}),t._applyToAxes(function(t,i){!t.isShown()||t.floating||t.setShift(r[i][t.getLevel()])},!1,!0,!1),t._applyToAxes(function(o,l){if(o.isShown()?o.showGroup():o.hideGroup(),o.setMinPx(s),o.setMaxPx(t.getDrawingHeight(!0)-n),!o.floating){let t=o.linkedToAxis?0:o.draw();if(o.isShown()){var p=getAxisLevelFromSpan(o.getSpan(),a[l]);o.setLevel(p),r[l][p]=i(t,r[l][p]||0)}}},!1,!1,!0);var o=extend(!0,{},r);t._applyToAxes(function(t,a){!t.isShown()||t.floating||(o[a][t.getLevel()]=i(r[a][t.getLevel()],t.equalizePosition(r[a][t.getLevel()])))},!1,!1,!0),r=o;var l=r.left.reduce(function(t,i){return t+i},0),p=r.right.reduce(function(t,i){return t+i},0);t.drawingSpaceWidth=t.getDrawingWidth()-l-p,[r.left,r.right].map(function(t){t.reduce(function(i,r,a){return t[a]=i+r,i+r},0)}),t._applyToAxes((t,i)=>{!t.isShown()||t.floating||t.setShift(r[i][t.getLevel()])},!1,!1,!0),t._applyToAxes(function(i){!i.isShown(),i.setMinPx(l),i.setMaxPx(t.getDrawingWidth(!0)-p);i.floating||!i.linkedToAxis&&i.draw()},!1,!0,!1),t._applyToAxes(function(t){if(t.floating){var i=t.getFloatingAxis(),r=t.getFloatingValue(),a=i.getPx(r);t.setShift(a),t.linkedToAxis||t.draw()}},!1,!0,!0),_closeLine(t,'right',t.getDrawingWidth(!0),t.getDrawingWidth(!0),s,t.getDrawingHeight(!0)-n),_closeLine(t,'left',0,0,s,t.getDrawingHeight(!0)-n),_closeLine(t,'top',l,t.getDrawingWidth(!0)-p,0,0),_closeLine(t,'bottom',l,t.getDrawingWidth(!0)-p,t.getDrawingHeight(!0)-n,t.getDrawingHeight(!0)-n),t.clipRect.setAttribute('y',s),t.clipRect.setAttribute('x',l),t.clipRect.setAttribute('width',t.getDrawingWidth()-l-p),t.clipRect.setAttribute('height',t.getDrawingHeight()-s-n),t.rectEvent.setAttribute('y',s+t.getPaddingTop()),t.rectEvent.setAttribute('x',l+t.getPaddingLeft()),t.rectEvent.setAttribute('width',t.drawingSpaceWidth),t.rectEvent.setAttribute('height',t.drawingSpaceHeight),t.drawingSpaceMinX=l+t.getPaddingLeft(),t.drawingSpaceMinY=s+t.getPaddingTop(),t.drawingSpaceMaxX=t.getDrawingWidth()-p+t.getPaddingLeft(),t.drawingSpaceMaxY=t.getDrawingHeight()-n+t.getPaddingTop(),t._applyToAxes(function(t){t.isShown()&&t.drawLines()},!1,!0,!0),t.shift=r,t.redrawShapes()}function _handleKey(t,i,r){return t.forcedPlugin?(t.activePlugin=t.forcedPlugin,void t._pluginExecute(t.activePlugin,r,[t,e])):void checkKeyActions(t,i,[t,i],r)}function checkKeyActions(t,r,a,s){var n=t.options.keyActions,o,i;for(o=0,i=n.length;o<i;o++){if(n[o].plugin){if(t.forcedPlugin==n[o].plugin||t.isActionAllowed(r,n[o]))return n[o].options&&a.push(n[o].options),t.activePlugin=n[o].plugin,t._pluginExecute(n[o].plugin,s,a),r.preventDefault(),r.stopPropagation(),!0;}else if(n[o].callback&&t.isActionAllowed(r,n[o]))return n[o].options&&a.push(n[o].options),r.preventDefault(),r.stopPropagation(),n[o].callback.apply(t,a),!0;n[o].removeSelectedShape&&t.isActionAllowed(r,n[o])&&(r.preventDefault(),r.stopPropagation(),t.selectedShapes.map((t)=>{t.kill()}))}return!1}function doDom(){this.dom=document.createElementNS(Graph$1.ns,'svg'),this.dom.setAttributeNS('http://www.w3.org/2000/xmlns/','xmlns:xlink','http://www.w3.org/1999/xlink'),setAttributeTo(this.dom,{xmlns:Graph$1.ns,"font-family":this.options.fontFamily,"font-size":this.options.fontSize});try{setAttributeTo(this.dom,{"data-jsgraph-version":'v<%= pkg.version %>'})}catch(t){}this.defs=document.createElementNS(Graph$1.ns,'defs'),this.dom.appendChild(this.defs),this.groupEvent=document.createElementNS(Graph$1.ns,'g'),this.rectEvent=document.createElementNS(Graph$1.ns,'rect'),setAttributeTo(this.rectEvent,{"pointer-events":'fill',fill:'transparent'}),this.groupEvent.appendChild(this.rectEvent),this.dom.appendChild(this.groupEvent),this.domTitle=document.createElementNS(Graph$1.ns,'text'),this.setTitle(this.options.title),setAttributeTo(this.domTitle,{"text-anchor":'middle',y:20}),this.groupEvent.appendChild(this.domTitle),this.graphingZone=document.createElementNS(Graph$1.ns,'g'),this.updateGraphingZone(),this.groupEvent.appendChild(this.graphingZone),this.axisGroup=document.createElementNS(Graph$1.ns,'g'),this.graphingZone.appendChild(this.axisGroup),this.groupGrids=document.createElementNS(Graph$1.ns,'g'),this.groupPrimaryGrids=document.createElementNS(Graph$1.ns,'g'),this.groupSecondaryGrids=document.createElementNS(Graph$1.ns,'g'),this.axisGroup.appendChild(this.groupGrids),this.groupGrids.appendChild(this.groupSecondaryGrids),this.groupGrids.appendChild(this.groupPrimaryGrids),this.plotGroup=document.createElementNS(Graph$1.ns,'g'),this.graphingZone.appendChild(this.plotGroup),this.layers=[],this._makeClosingLines(),this.clip=document.createElementNS(Graph$1.ns,'clipPath'),this.clip.setAttribute('id','_clipplot'+this._creation),this.defs.appendChild(this.clip),this.clipRect=document.createElementNS(Graph$1.ns,'rect'),this.clip.appendChild(this.clipRect),this.clip.setAttribute('clipPathUnits','userSpaceOnUse'),this.markerArrow=document.createElementNS(this.ns,'marker'),this.markerArrow.setAttribute('viewBox','0 0 10 10'),this.markerArrow.setAttribute('id','arrow'+this._creation),this.markerArrow.setAttribute('refX','6'),this.markerArrow.setAttribute('refY','5'),this.markerArrow.setAttribute('markerUnits','strokeWidth'),this.markerArrow.setAttribute('markerWidth','8'),this.markerArrow.setAttribute('markerHeight','6'),this.markerArrow.setAttribute('orient','auto');var t=document.createElementNS(Graph$1.ns,'path');t.setAttribute('d','M 0 0 L 10 5 L 0 10 z'),this.markerArrow.appendChild(t),this.defs.appendChild(this.markerArrow),this.markerHorizontalSplit=document.createElementNS(Graph$1.ns,'marker'),this.markerHorizontalSplit.setAttribute('viewBox','0 0 6 8'),this.markerHorizontalSplit.setAttribute('id','horionzalsplit_'+this.getId()),this.markerHorizontalSplit.setAttribute('refX','3'),this.markerHorizontalSplit.setAttribute('refY','4'),this.markerHorizontalSplit.setAttribute('markerUnits','strokeWidth'),this.markerHorizontalSplit.setAttribute('markerWidth','6'),this.markerHorizontalSplit.setAttribute('markerHeight','8');var i=document.createElementNS(Graph$1.ns,'line');i.setAttribute('x1','0'),i.setAttribute('y1','8'),i.setAttribute('x2','6'),i.setAttribute('y2','0'),i.setAttribute('stroke','black'),this.markerHorizontalSplit.appendChild(i),this.defs.appendChild(this.markerHorizontalSplit),this.markerVerticalSplit=document.createElementNS(Graph$1.ns,'marker'),this.markerVerticalSplit.setAttribute('viewBox','0 0 8 6'),this.markerVerticalSplit.setAttribute('id','verticalsplit_'+this.getId()),this.markerVerticalSplit.setAttribute('refX','4'),this.markerVerticalSplit.setAttribute('refY','3'),this.markerVerticalSplit.setAttribute('markerUnits','strokeWidth'),this.markerVerticalSplit.setAttribute('markerWidth','8'),this.markerVerticalSplit.setAttribute('markerHeight','6');var i=document.createElementNS(Graph$1.ns,'line');i.setAttribute('x1','0'),i.setAttribute('y1','0'),i.setAttribute('x2','8'),i.setAttribute('y2','6'),i.setAttribute('stroke','black'),this.markerVerticalSplit.appendChild(i),this.defs.appendChild(this.markerVerticalSplit),this.vertLineArrow=document.createElementNS(Graph$1.ns,'marker'),this.vertLineArrow.setAttribute('viewBox','0 0 10 10'),this.vertLineArrow.setAttribute('id','verticalline'+this._creation),this.vertLineArrow.setAttribute('refX','0'),this.vertLineArrow.setAttribute('refY','5'),this.vertLineArrow.setAttribute('markerUnits','strokeWidth'),this.vertLineArrow.setAttribute('markerWidth','20'),this.vertLineArrow.setAttribute('markerHeight','10'),this.vertLineArrow.setAttribute('orient','auto'),this.vertLineArrow.setAttribute('stroke-width','1px');var r=document.createElementNS(Graph$1.ns,'path');r.setAttribute('d','M 0 -10 L 0 10'),r.setAttribute('stroke','black'),this.vertLineArrow.appendChild(r),this.defs.appendChild(this.vertLineArrow),this.bypassHandleMouse=!1}function _registerEvents(t){if(!t.wrapper)throw'No wrapper exists. Cannot register the events.';t.wrapper.addEventListener('keydown',(i)=>{_handleKey(t,i,'keydown')}),t.wrapper.addEventListener('keypress',(i)=>{_handleKey(t,i,'keypress')}),t.wrapper.addEventListener('keyup',(i)=>{_handleKey(t,i,'keyup')}),t.dom.addEventListener('mousemove',function(i){var r=t._getXY(i);_handleMouseMove(t,r.x,r.y,i)}),t.dom.addEventListener('mouseleave',function(){_handleMouseLeave(t)}),t.groupEvent.addEventListener('mousedown',function(i){if(t.focus(),!(3==i.which||i.ctrlKey)){var r=t._getXY(i);_handleMouseDown(t,r.x,r.y,i)}}),t.dom.addEventListener('mouseup',function(i){t.emit('mouseUp',i);var r=t._getXY(i);_handleMouseUp(t,r.x,r.y,i)}),t.wrapper.addEventListener('mouseup',(t)=>{t.stopPropagation()}),t.dom.addEventListener('dblclick',function(i){t.emit('dblClick',i);var r=t._getXY(i);_handleDblClick(t,r.x,r.y,i)}),t.groupEvent.addEventListener('click',function(i){if(!(3==i.which||i.ctrlKey)){var r=t._getXY(i);t.prevent(!1)||_handleClick(t,r.x,r.y,i)}}),t.groupEvent.addEventListener('mousewheel',function(i){var r=i.wheelDeltaY||i.wheelDelta||-i.deltaY,a=t._getXY(i);return _handleMouseWheel(t,r,a.x,a.y,i),!1}),t.groupEvent.addEventListener('wheel',function(i){var r=t._getXY(i),a=i.wheelDeltaY||i.wheelDelta||-i.deltaY;return _handleMouseWheel(t,a,r.x,r.y,i),!1})}function _handleMouseDown(t,i,r,a){return t.forcedPlugin?(t.activePlugin=t.forcedPlugin,void t._pluginExecute(t.activePlugin,'onMouseDown',[t,i,r,a])):void(t.activePlugin&&(t.activePlugin=!1),checkMouseActions(t,a,[t,i,r,a],'onMouseDown'))}function _handleMouseMove(t,r,a,s){if(t.bypassHandleMouse)return void t.bypassHandleMouse.handleMouseMove(s);if(!(t.activePlugin&&t._pluginExecute(t.activePlugin,'onMouseMove',[t,r,a,s]))){if(t._applyToAxes('handleMouseMove',[r-t.options.paddingLeft,s],!0,!1),t._applyToAxes('handleMouseMove',[a-t.options.paddingTop,s],!1,!0),!t.activePlugin){var n;if(t.options.trackingLine&&t.options.trackingLine.enable&&t.options.trackingLine.snapToSerie&&'common'==t.options.trackingLine.mode){var o=t.options.trackingLine.snapToSerie;if(n=o.handleMouseMove(!1,!0),this.trackingObject)if(!n)t.trackingObject.hide();else{t.trackingObject.show(),t.trackingObject.getPosition(0).x=n.xClosest,t.trackingObject.getPosition(1).x=n.xClosest,t.trackingObject.redraw();var r=o.getXAxis().getPx(n.xClosest)+t.options.paddingLeft}var l=t.options.trackingLine.series;l||(l=t.getSeries().map(function(t){return{serie:t,withinPx:20,withinVal:-1}})),t._trackingLegend=_trackingLegendSerie(t,l,r,a,t._trackingLegend,t.options.trackingLine.textMethod,n.xClosest)}}if(t.options.onMouseMoveData){for(var p={},d=0;d<t.series.length;d++)p[t.series[d].getName()]=t.series[d].handleMouseMove(!1,!0);t.options.onMouseMoveData.call(t,s,p)}checkMouseActions(t,s,[t,r,a,s],'onMouseMove')}}function checkMouseActions(t,r,a,s){var n=t.options.mouseActions,o=!1,p,i;for(p=0,i=n.length;p<i;p++)if(n[p].plugin){if(t.forcedPlugin==n[p].plugin||t.isActionAllowed(r,n[p])){n[p].options&&a.push(n[p].options),'wheel'!==r.type&&'mousewheel'!==r.type&&(t.activePlugin=n[p].plugin),t._pluginExecute(n[p].plugin,s,a),o=!0;continue}}else if(n[p].callback&&t.isActionAllowed(r,n[p])){n[p].options&&a.push(n[p].options),n[p].callback.apply(t,a),o=!0;continue}else if(n[p].series){var l;'all'===n[p].series&&(l=t.series),Array.isArray(n[p].series)||(l=[l]),n[p].options&&a.push(n[p].options);for(;0<l.length;p++)t._serieExecute(l[p],s,a);o=!0;continue}return o}var _trackingLegendSerie=function(t,i,r,a,s,n,o){var l=Math.abs,p=!1;Array.isArray(i)||(i=[i]);var d=[];if(!s&&t.options.trackingLine.legend&&(p=!0,s=_makeTrackingLegend(t)),i.map((i)=>{var a=i.serie.handleMouseMove(o,!1);if(!a||!n)return i.serie.trackingShape&&i.serie.trackingShape.hide(),s;if(0<i.withinPx&&1e-14<l(r-t.options.paddingLeft-i.serie.getXAxis().getPx(a.xClosest))-i.withinPx||0<i.withinVal&&l(i.serie.getXAxis().getVal(r-t.options.paddingLeft)-a.xClosest)-i.withinVal>i.serie.getXAxis().getVal(r-t.options.paddingLeft)/1e5)i.serie.trackingShape&&i.serie.trackingShape.hide();else{d[i.serie.getName()]={yValue:a.xClosest,xValue:a.yClosest,serie:i,index:a};let r;if(r=t.options.trackingLine&&t.options.trackingLine.serieShape?t.options.trackingLine.serieShape:{shape:'ellipse',properties:{rx:[3*i.serie.getLineWidth()+'px'],ry:[3*i.serie.getLineWidth()+'px']}},i.serie.trackingShape||(i.serie.trackingShape=t.newShape(r.shape,{fillColor:i.serie.getLineColor(),strokeColor:'White',strokeWidth:i.serie.getLineWidth()},!0,r.properties).setSerie(i.serie).forceParentDom(i.serie.groupMain).draw(),r.onCreated&&r.onCreated(i.serie.trackingShape),i.serie.trackingShape.on('changed',()=>{r.onChanged&&r.onChanged(i.serie.trackingShape)})),i.serie.trackingShape.show(),i.serie.trackingShape.getPosition(0).x=a.xClosest,r.magnet){let t=r.magnet,s=t.within,n;t.withinPx&&(s=i.serie.getXAxis().getRelVal(t.withinPx)),(n=i.serie.findLocalMinMax(a.xClosest,s,t.mode))&&(i.serie.trackingShape.getPosition(0).x=n)}i.serie.trackingShape.redraw()}}),!!t.options.trackingLine.legend){if(0==Object.keys(d).length||!n)s.style.display='none';else{'none'==s.style.display||p?forceTrackingLegendMode(t,s,r,a,!0):_trackingLegendMove(t,s,r,a),s.style.display='block';var g=n(d,o,r,a);s.innerHTML=g}return s}},forceTrackingLegendMode=function(t,i,r,a,s){function n(){var t=(Date.now()-o)/200;1<t&&(t=1),i.style.marginLeft=(r-p)*t+p+'px',i.style.marginTop=(a-d)*t+d+'px',1>t&&window.requestAnimationFrame(n)}var o=Date.now(),l=i.offsetHeight,p=parseInt(i.style.marginLeft.replace('px','')||0),d=parseInt(i.style.marginTop.replace('px','')||0);return r=r>t.getWidth()/2?r-r%10-20-i.offsetWidth:r-r%10+30,a=a-a%10+l/2,s?(i.style.marginLeft=r+'px',void(i.style.marginTop=a+'px')):void window.requestAnimationFrame(n)},_trackingLegendMove=debounce(forceTrackingLegendMode,50);function _makeTrackingLegend(t){var i=document.createElement('div');return i.setAttribute('class','trackingLegend'),i.style.position='absolute',i.style.borderRadius='4px',i.style.boxShadow='1px 1px 3px 0px rgba(100,100,100,0.6)',i.style.border='2px solid #333333',i.style.backgroundColor='rgba(255, 255, 255, 0.5 )',i.style.pointerEvents='none',i.style.paddingTop='5px',i.style.paddingBottom='5px',i.style.paddingLeft='10px',i.style.paddingRight='10px',t.getWrapper().insertBefore(i,t.getDom()),i}function _handleDblClick(t,i,r,a){t.options.dblclick;checkMouseActions(t,a,[i,r,a],'onDblClick')}function _handleMouseUp(t,i,r,a){return t.bypassHandleMouse?(t.bypassHandleMouse.handleMouseUp(a),void(t.activePlugin=!1)):void(t._pluginExecute(t.activePlugin,'onMouseUp',[t,i,r,a]),t.activePlugin=!1)}function _handleClick(t,i,r,a){t.emit('click',[t,i,r,a]),checkMouseActions(t,a,[i,r,a],'onClick'),a.target.jsGraphIsShape||t.prevent(!1)||!t.options.shapesUnselectOnClick||t.unselectShapes()}function _getAxis(t,i,r,a){var r=r||{},s={def:{x:t.getConstructor('graph.axis.x'),y:t.getConstructor('graph.axis.y')},time:{x:t.getConstructor('graph.axis.x.time')},bar:{x:t.getConstructor('graph.axis.x.bar')}},n;switch(r.type){case'time':var o=s.time;break;case'bar':var o=s.bar;break;case'broken':var o=s.broken;break;default:var o=s.def;}return'top'===a||'bottom'===a?n=o.x:'left'===a||'right'===a?n=o.y:void 0,i=i||0,'object'==typeof i&&(r=i,i=0),t.axis[a][i]||(t.axis[a][i]=new n(t,a,r),t.axis[a][i].init(t,r)),t.axis[a][i]}function _closeLine(t,i,r,a,s,n){if(!1!==t.options.close){var o=0;t.axis[i].map(function(t){t.isDisplayed()&&!t.floating&&o++}),(!0===t.options.close||t.options.close[i])&&0==o?(t.closingLines[i].setAttribute('display','block'),t.closingLines[i].setAttribute('x1',r),t.closingLines[i].setAttribute('x2',a),t.closingLines[i].setAttribute('y1',s),t.closingLines[i].setAttribute('y2',n)):t.closingLines[i].setAttribute('display','none')}}function _handleMouseWheel(t,i,r,a,s){checkMouseActions(t,s,[i,s,r,a],'onMouseWheel')&&(s.preventDefault(),s.stopPropagation())}function _handleMouseLeave(t){t.options.handleMouseLeave&&t.options.handleMouseLeave.call(t)}function haveAxesChanged(t){var i=t._axesHaveChanged;return t._axesHaveChanged=!1,i}function hasSizeChanged(t){var i=t._sizeChanged;return t._sizeChanged=!1,i}Graph$1.SERIE_LINE=Symbol(),Graph$1.SERIE_SCATTER=Symbol(),Graph$1.SERIE_CONTOUR=Symbol(),Graph$1.SERIE_BAR=Symbol(),Graph$1.SERIE_BOX=Symbol(),Graph$1.SERIE_ZONE=Symbol(),Graph$1.SERIE_LINE_COLORED=Symbol(),Graph$1.SERIE_ZONE=Symbol(),Graph$1.SERIE_DENSITYMAP=Symbol(),Graph$1.SERIE_LINE_3D=Symbol(),Graph$1.SERIE_ZONE_3D=Symbol(),Graph$1.TICKS_OUTSIDE=Symbol(),Graph$1.TICKS_INSIDE=Symbol(),Graph$1.TICKS_CENTERED=Symbol(),Graph$1.ns='http://www.w3.org/2000/svg',Graph$1.nsxlink='http://www.w3.org/1999/xlink';var legendDefaults={backgroundColor:'rgba(255, 255, 255, 0.8)',frame:!0,frameWidth:1,frameColor:'black',paddingTop:10,paddingLeft:10,paddingBottom:10,paddingRight:10,color:'black',frameRounding:0,movable:!1,shapesToggleable:!0,isSerieHideable:!0,isSerieSelectable:!0};class Legend{constructor(t,i){this.options=extend({},legendDefaults,i),this.graph=t,this.svg=document.createElementNS(this.graph.ns,'g'),this.subG=document.createElementNS(this.graph.ns,'g'),this.groups=[],this.rect=document.createElementNS(this.graph.ns,'rect'),this.rectBottom=document.createElementNS(this.graph.ns,'rect'),this.rect.setAttribute('x',0),this.rect.setAttribute('y',0),this.rectBottom.setAttribute('x',0),this.rectBottom.setAttribute('y',0),this.series=!1,this.svg.setAttribute('display','none'),this.pos={x:void 0,y:void 0,transformX:0,transformY:0},this.setEvents(),this.eyeId=guid(),this.eyeCrossedId=guid();var r=SVGParser('<svg xmlns="http://www.w3.org/2000/svg"><symbol id="'+this.eyeCrossedId+'" viewBox="0 -256 1850 1850"><rect pointer-events="fill" fill="transparent" x="-256" y="0" width="2106" height="1850" /><g transform="matrix(1,0,0,-1,30.372881,1214.339)"><path d="m 555,201 78,141 q -87,63 -136,159 -49,96 -49,203 0,121 61,225 Q 280,812 128,576 295,318 555,201 z m 389,759 q 0,20 -14,34 -14,14 -34,14 -125,0 -214.5,-89.5 Q 592,829 592,704 q 0,-20 14,-34 14,-14 34,-14 20,0 34,14 14,14 14,34 0,86 61,147 61,61 147,61 20,0 34,14 14,14 14,34 z m 363,191 q 0,-7 -1,-9 Q 1201,954 991,576 781,198 675,9 l -49,-89 q -10,-16 -28,-16 -12,0 -134,70 -16,10 -16,28 0,12 44,87 Q 349,154 228.5,262 108,370 20,507 0,538 0,576 q 0,38 20,69 153,235 380,371 227,136 496,136 89,0 180,-17 l 54,97 q 10,16 28,16 5,0 18,-6 13,-6 31,-15.5 18,-9.5 33,-18.5 15,-9 31.5,-18.5 16.5,-9.5 19.5,-11.5 16,-10 16,-27 z m 37,-447 Q 1344,565 1265,450.5 1186,336 1056,286 l 280,502 q 8,-45 8,-84 z m 448,-128 q 0,-35 -20,-69 Q 1733,443 1663,362 1513,190 1315.5,95 1118,0 896,0 l 74,132 q 212,18 392.5,137 180.5,119 301.5,307 -115,179 -282,294 l 63,112 q 95,-64 182.5,-153 87.5,-89 144.5,-184 20,-34 20,-69 z" fill="#c0c0c0"></path></g></symbol></svg>'),a=SVGParser('<svg xmlns="http://www.w3.org/2000/svg"><symbol id="'+this.eyeId+'" viewBox="0 -256 1850 1850"><rect pointer-events="fill" x="-256" y="0" fill="transparent" width="2106" height="1850" /><g transform="matrix(1,0,0,-1,30.372881,1259.8983)"><path d="m 1664,576 q -152,236 -381,353 61,-104 61,-225 0,-185 -131.5,-316.5 Q 1081,256 896,256 711,256 579.5,387.5 448,519 448,704 448,825 509,929 280,812 128,576 261,371 461.5,249.5 662,128 896,128 1130,128 1330.5,249.5 1531,371 1664,576 z M 944,960 q 0,20 -14,34 -14,14 -34,14 -125,0 -214.5,-89.5 Q 592,829 592,704 q 0,-20 14,-34 14,-14 34,-14 20,0 34,14 14,14 14,34 0,86 61,147 61,61 147,61 20,0 34,14 14,14 14,34 z m 848,-384 q 0,-34 -20,-69 Q 1632,277 1395.5,138.5 1159,0 896,0 633,0 396.5,139 160,278 20,507 0,542 0,576 q 0,34 20,69 140,229 376.5,368 236.5,139 499.5,139 263,0 499.5,-139 236.5,-139 376.5,-368 20,-35 20,-69 z" fill="#444444" /></g></symbol></svg>');this.svg.appendChild(document.adoptNode(a.documentElement.firstChild)),this.svg.appendChild(document.adoptNode(r.documentElement.firstChild)),this.svg.appendChild(this.subG),this.applyStyle()}setPosition(t,i,r){t&&(this.position=t,this.alignToX=i||'left',this.alignToY=r||'top')}setDraggable(t){this.options.movable=t}setAutoPosition(t){return-1<['bottom','left','top','right'].indexOf(t=t.toLowerCase())?(this.autoPosition=t,this):void(this.requireDelayedUpdate(),this.autoPosition=!1)}autoPosition(){return this.setAutoPosition(...arguments)}buildLegendBox(){var t=this.series||this.graph.getSeries(),r=0,a=this.options.paddingTop;this.autoPosition?this.graph.getDom().appendChild(this.getDom()):this.graph.graphingZone.appendChild(this.getDom());for(var s=0,i=t.length;s<i;s++)if(!t[s].excludedFromLegend||this.series){if('bottom'==this.autoPosition||'top'==this.autoPosition){var n=getBBox(this.groups[s]);r+n.width>this.graph.getDrawingWidth()-this.options.paddingRight&&(a+=16,r=0)}this.groups[s].setAttribute('transform','translate( '+r+', '+a+')'),'bottom'==this.autoPosition||'top'==this.autoPosition?(r+=n.width+10,a+=0):(r=0,a+=16)}var n=getBBox(this.subG);switch(this.width=n.width+this.options.paddingRight+this.options.paddingLeft,this.height=n.height+this.options.paddingBottom+this.options.paddingTop,this.rect.setAttribute('width',this.width),this.rect.setAttribute('height',this.height),this.rect.setAttribute('fill','none'),this.rect.setAttribute('pointer-events','fill'),this.rect.setAttribute('display','none'),this.options.movable&&(this.rectBottom.style.cursor='move'),this.rectBottom.setAttribute('width',this.width),this.rectBottom.setAttribute('height',this.height),this.rectBottom.setAttribute('x',n.x-this.options.paddingLeft),this.rectBottom.setAttribute('y',n.y-this.options.paddingTop),this.position=this.position||{},this.autoPosition){case'bottom':this.position.y=this.graph.getHeight()+'px',this.position.x=(this.graph.drawingSpaceWidth-this.width)/2+this.graph.drawingSpaceMinX+'px',this.alignToY='bottom',this.alignToX=!1;break;case'left':this.position.x='6px',this.position.y=(this.graph.getHeight()-this.height)/2+'px',this.alignToX='left',this.alignToY=!1;break;case'right':this.position.x=this.graph.getWidth()+'px',this.position.y=(this.graph.getHeight()-this.height)/2+'px',this.alignToX='right',this.alignToY=!1;break;case'top':this.position.x=(this.graph.drawingSpaceWidth-this.width)/2+this.graph.drawingSpaceMinX+'px',this.position.y='10px',this.alignToY='top',this.alignToX=!1;}if(this.autoPosition){switch(this.autoPosition){case'bottom':this.graph.options.paddingBottom=this.height+10;break;case'left':this.graph.options.paddingLeft=this.width+5;break;case'right':this.graph.options.paddingRight=this.width+10;break;case'top':this.graph.options.paddingTop=this.height+14;}this.graph.updateGraphingZone(),this.graph.getDrawingHeight(),this.graph.getDrawingWidth()}this.bbox=n}calculatePosition(){var t=Position.check(this.position);let i=t.compute(this.graph,this.graph.getXAxis(),this.graph.getYAxis());i&&('max'==t.y&&(i.y+=this.graph.getPaddingTop()),'max'==t.x&&(i.x-=this.graph.getPaddingRight()),'right'==this.alignToX&&(i.x-=this.width,i.x-=this.bbox.x),'bottom'==this.alignToY?(i.y-=this.height,i.y-=this.bbox.y):i.y-=this.bbox.y,this.pos.transformX=i.x,this.pos.transformY=i.y,this._setPosition())}update(t){if(!(this.graph.isDelayedUpdate()||!this._requiredUpdate&&t)){this._requiredUpdate=!1;var r=this;for(this.applyStyle();this.subG.hasChildNodes();)this.subG.removeChild(this.subG.lastChild);this.svg.insertBefore(this.rectBottom,this.svg.firstChild);var a=this.series||this.graph.getSeries();if(0<a.length)this.svg.setAttribute('display','block');else return;if('bottom'==this.autoPosition||'top'==this.autoPosition)this.graph.getDrawingWidth();for(var s=0,i=a.length;s<i;s++)(!a[s].excludedFromLegend||this.series)&&function(t){var i,n,o;if('bottom'==this.autoPosition||'top'==this.autoPosition)this.graph.getDrawingWidth();i=document.createElementNS(r.graph.ns,'g');var l=document.createElementNS(r.graph.ns,'rect');r.subG.appendChild(i),i.appendChild(l);var n=a[t].getSymbolForLegend(),p=a[t].getMarkerForLegend(),o=a[t].getTextForLegend(),d=35;if(this.isHideable()){d+=20;var g=document.createElementNS(r.graph.ns,'use');g.setAttributeNS('http://www.w3.org/1999/xlink','xlink:href','#'+(a[s].isShown()?this.eyeId:this.eyeCrossedId)),g.setAttribute('width',15),g.setAttribute('height',15),g.setAttribute('x',35),g.setAttribute('y',-8),g.addEventListener('click',function(i){i.stopPropagation();var s;a[t].isShown()?(a[t].hide(r.options.hideShapesOnHideSerie),s=r.eyeCrossedId):(a[t].show(r.options.hideShapesOnHideSerie),s=r.eyeId),g.setAttributeNS('http://www.w3.org/1999/xlink','xlink:href','#'+s)})}o.setAttribute('transform','translate('+d+', 3)'),o.setAttribute('color',this.options.color),n&&i.appendChild(n),'scatter'==a[t].getType()&&n.setAttribute('transform','translate( 20, 0 )'),p&&i.appendChild(p),g&&i.appendChild(g),i.appendChild(o);var c=getBBox(i);l.setAttribute('x',c.x),l.setAttribute('y',c.y),l.setAttribute('width',c.width),l.setAttribute('height',c.height),l.setAttribute('fill','none'),l.setAttribute('pointer-events','fill'),r.groups[t]=i,i.addEventListener('click',function(i){var s=a[t];s.isShown()&&(r.isSelectable()&&!s.isSelected()?r.graph.selectSerie(s):r.graph.unselectSerie(s),i.preventDefault(),i.stopPropagation())})}.call(this,s);this.svg.appendChild(this.rect),this.buildLegendBox(),this.calculatePosition()}}isHideable(){return this.options.isSerieHideable}notHideable(){return this.options.isSerieHideable=!1,this}hideable(){return this.options.isSerieHideable=!0,this}set seriesHideable(t){this.options.isSerieHideable=!!t}get seriesHideable(){return this.options.isSerieHideable}isSelectable(){return this.options.isSerieSelectable}isToggleShapes(){return this.options.shapesToggleable}getDom(){return this.svg}setEvents(){var t=this,i=this.pos;this.svg.addEventListener('mousedown',function(r){r.stopPropagation(),console.log('down'),t.options.movable&&(i.x=r.clientX,i.y=r.clientY,r.preventDefault(),t.mousedown=!0,t.graph.elementMoving(t),t.rect.setAttribute('display','block'))}),this.svg.addEventListener('click',function(t){t.stopPropagation()}),this.svg.addEventListener('dblclick',function(t){t.stopPropagation()}),this.svg.addEventListener('mousemove',function(i){t.handleMouseMove(i)})}handleMouseUp(t){t.stopPropagation(),t.preventDefault(),this.mousedown=!1,this.rect.setAttribute('display','none'),this.graph.elementMoving(!1)}handleMouseMove(t){if(this.mousedown){var i=this.pos,r=t.clientX-i.x,a=t.clientY-i.y;i.transformX+=r,i.transformY+=a,i.x=t.clientX,i.y=t.clientY,t.stopPropagation(),t.preventDefault(),this._setPosition()}}_setPosition(){var t=this.pos;isNaN(t.transformX)||isNaN(t.transformY)||!1===t.transformX||!1===t.transformY||this.svg.setAttribute('transform','translate('+t.transformX+', '+t.transformY+')')}applyStyle(){this.options.frame&&(this.rectBottom.setAttribute('stroke',this.options.frameColor),this.rectBottom.setAttribute('stroke-width',this.options.frameWidth+'px'),this.rectBottom.setAttribute('rx',this.options.frameRounding),this.rectBottom.setAttribute('ry',this.options.frameRounding)),this.rectBottom.setAttribute('fill',this.options.backgroundColor)}fixSeries(){var t=[];if(!1===arguments[0])return this.series=!1,void this.update();for(var r=0,i=arguments.length;r<i;r++)Array.isArray(arguments[r])?t=t.concat(arguments[r]):t.push(arguments[r]);this.update(),this.series=t}fixSeriesAdd(t){this.series=this.series||[],this.series.push(t)}requireDelayedUpdate(){this._requiredUpdate=!0}}function getBBox(t){try{return t.getBBox()}catch(t){return{height:0,width:0,x:0,y:0}}}const defaults$1={lineAt:!1,display:!0,flipped:!1,axisDataSpacing:{min:0.1,max:0.1},unitModification:!1,primaryGrid:!0,secondaryGrid:!0,primaryGridColor:'#f0f0f0',secondaryGridColor:'#f0f0f0',primaryGridWidth:1,secondaryGridWidth:1,hideWhenNoSeriesShown:!1,shiftToZero:!1,tickPosition:1,nbTicksPrimary:3,nbTicksSecondary:10,ticklabelratio:1,exponentialFactor:0,exponentialLabelFactor:0,logScale:!1,forcedMin:!1,forcedMax:!1,span:[0,1],marginMin:0,marginMax:0,scientificScale:!1,scientificScaleExponent:!1,engineeringScale:!1,unitInTicks:!1,unit:!1,unitWrapperBefore:'',unitWrapperAfter:'',splitMarks:!1,tickLabelOffset:0,useKatexForLabel:!1};class Axis extends EventEmitter{constructor(){super()}init(t,i,r){this.unitModificationTimeTicks=[[1,[1,2,5,10,20,30]],[60,[1,2,5,10,20,30]],[3600,[1,2,6,12]],[86400,[1,2,3,4,5,10,20,40]]],this.graph=t,this.options=extend(!0,{},defaults$1,r,i),this.group=document.createElementNS(this.graph.ns,'g'),this.hasChanged=!0,this.rectEvent=document.createElementNS(this.graph.ns,'rect'),this.rectEvent.setAttribute('pointer-events','fill'),this.rectEvent.setAttribute('fill','transparent'),this.group.appendChild(this.rectEvent),this.graph.axisGroup.appendChild(this.group),this._lines=[],this.line=document.createElementNS(this.graph.ns,'line'),this.line.setAttribute('stroke','black'),this.line.setAttribute('shape-rendering','crispEdges'),this.line.setAttribute('stroke-linecap','square'),this.groupTicks=document.createElementNS(this.graph.ns,'g'),this.groupTickLabels=document.createElementNS(this.graph.ns,'g'),this.group.appendChild(this.groupTicks),this.group.appendChild(this.groupTickLabels),this.group.appendChild(this.line),this.labelValue,this.label=document.createElementNS(this.graph.ns,'text'),this.labelTspan=document.createElementNS(this.graph.ns,'tspan'),this.preunit='',this.unitTspan=document.createElementNS(this.graph.ns,'tspan'),this.expTspan=document.createElementNS(this.graph.ns,'tspan'),this.expTspanExp=document.createElementNS(this.graph.ns,'tspan'),this.label.appendChild(this.labelTspan),this.label.appendChild(this.unitTspan),this.label.appendChild(this.expTspan),this.label.appendChild(this.expTspanExp),this.expTspan.setAttribute('dx',6),this.expTspanExp.setAttribute('dy',-5),this.expTspanExp.setAttribute('font-size','0.8em'),this.label.setAttribute('text-anchor','middle'),this.setTickPosition(this.options.tickPosition),this.gridLinePath={primary:'',secondary:''},this.gridPrimary=document.createElementNS(this.graph.ns,'path'),this.gridSecondary=document.createElementNS(this.graph.ns,'path'),this.graph.groupPrimaryGrids.appendChild(this.gridPrimary),this.graph.groupSecondaryGrids.appendChild(this.gridSecondary),this.setGridLinesStyle(),this.group.appendChild(this.label),this.groupSeries=document.createElementNS(this.graph.ns,'g'),this.group.appendChild(this.groupSeries),this.widthHeightTick=0,this.ticks={},this.ticksLabels=[],this.tickScaling={1:3,2:2,3:1,4:0.5},this.currentTick={},this.lastCurrentTick={},this.series=[],this.totalDelta=0,this.currentAction=!1,this.group.addEventListener('mousemove',(t)=>{t.preventDefault();var r=this.graph._getXY(t);this.handleMouseMoveLocal(r.x,r.y,t);for(var a=0,i=this.series.length;a<i;a++)this.series[a].handleMouseMove(!1,!0)}),this.labels=[],this.group.addEventListener('click',(t)=>{t.preventDefault();var i=this.graph._getXY(t);this.addLabel(this.getVal(i.x-this.graph.getPaddingLeft()))}),this.gridPrimary.setAttribute('clip-path','url(#_clipplot'+this.graph._creation+')'),this.gridSecondary.setAttribute('clip-path','url(#_clipplot'+this.graph._creation+')'),this.graph._axisHasChanged(this)}handleMouseMoveLocal(){}hide(){return this.options.display=!1,this}show(){return this.options.display=!0,this}setDisplay(t){return this.options.display=!!t,this}isDisplayed(){return this.options.hideWhenNoSeriesShown?this.graph.getSeriesFromAxis(this).reduce((t,i)=>t||i.isShown(),!1):this.options.display}isShown(){return this.isDisplayed(...arguments)}hideGroup(){this._hidden||(this._hidden=!0,this.group.setAttribute('display','none'))}showGroup(){this._hidden&&(this._hidden=!1,this.group.setAttribute('display','initial'))}kill(t,i){this.graph.killAxis(this,t,i)}setLineAt(t){return this.options.lineAt=t,this}adaptTo(t,i,r,a){return t?(this.options.adaptTo={axis:t,thisValue:i,foreignValue:r,preference:a},this.adapt(),this):(this.options.adaptTo=!1,this)}adapt(){if(this.options.adaptTo){var t=this.options.adaptTo.axis,i=this.options.adaptTo.thisValue,r=this.options.adaptTo.foreignValue;if((void 0===t.currentAxisMin||void 0===t.currentAxisMax)&&t.setMinMaxToFitSeries(),!1!==this.options.forcedMin&&!1==this.options.forcedMax||'max'!==this.options.adaptTo.preference){this.currentAxisMin=!1===this.options.forcedMin?this._zoomed?this.getCurrentMin():this.getMinValue()-(i-this.getMinValue())*(this.options.axisDataSpacing.min*(t.getCurrentMax()-t.getCurrentMin())/(r-t.getCurrentMin())):this.options.forcedMin,this.currentAxisMin==i&&(this.currentAxisMin-=this.options.axisDataSpacing.min*this.getInterval());var a=!1===this.options.forcedMin?this.currentAxisMin:this.options.forcedMin;this.currentAxisMax=(i-a)*(t.getCurrentMax()-t.getCurrentMin())/(r-t.getCurrentMin())+a}else{this.currentAxisMax=!1===this.options.forcedMax?this._zoomed?this.getCurrentMax():this.getMaxValue()+(this.getMaxValue()-i)*(this.options.axisDataSpacing.max*(t.getCurrentMax()-t.getCurrentMin())/(t.getCurrentMax()-r)):this.options.forcedMax,this.currentAxisMax==i&&(this.currentAxisMax+=this.options.axisDataSpacing.max*this.getInterval());var a=!1===this.options.forcedMax?this.currentAxisMax:this.options.forcedMax;this.currentAxisMin=(i-a)*(t.getCurrentMin()-t.getCurrentMax())/(r-t.getCurrentMax())+a}this.graph._axisHasChanged(this)}}setFloating(t,i){return this.floating=!0,this.floatingAxis=t,this.floatingValue=i,this}getFloatingAxis(){return this.floatingAxis}getFloatingValue(){return this.floatingValue}setAxisDataSpacing(t,i){return this.options.axisDataSpacing.min=t,this.options.axisDataSpacing.max=i||t,this}dataSpacing(){return this.setAxisDataSpacing(...arguments)}setAxisDataSpacingMin(t){this.options.axisDataSpacing.min=t}setAxisDataSpacingMax(t){this.options.axisDataSpacing.max=t}setMinPx(t){this.minPx=t,this.setMinMaxFlipped()}setMaxPx(t){this.maxPx=t,this.setMinMaxFlipped()}getMinPx(){return this.minPxFlipped}getMaxPx(){return this.maxPxFlipped}getMathMaxPx(){return this.maxPx}getMathMinPx(){return this.minPx}getMinValue(){return!1===this.options.forcedMin?this.dataMin:this.options.forcedMin}getMaxValue(){return!1===this.options.forcedMax?this.dataMax:this.options.forcedMax}setMinValueData(t){this.dataMin=t,isNaN(this.getCurrentMin())&&(this.setCurrentMin(this.getMinValue()),this.cache())}setMaxValueData(t){this.dataMax=t,isNaN(this.getCurrentMax())&&(this.setCurrentMax(this.getMaxValue()),this.cache())}getDataMax(){return this.dataMax}getDataMin(){return this.dataMin}forceMin(t,i=!1){return this.options.forcedMin=t,this.setCurrentMin(i?this.getCurrentMin():void 0),this.graph._axisHasChanged(this),this}forceMax(t,i=!1){return this.options.forcedMax=t,this.setCurrentMax(i?this.getCurrentMax():void 0),this.graph._axisHasChanged(this),this}getForcedMin(){return this.options.forcedMin}getForcedMax(){return this.options.forcedMax}forceToAxis(t){return t.getMaxValue&&t.getMinValue&&(this.options.forcedMin=t.getMinValue(),this.options.forcedMax=t.getMaxValue()),this}getNbTicksPrimary(){return this.options.nbTicksPrimary}setNbTicksPrimary(t){this.options.nbTicksPrimary=t}getNbTicksSecondary(){return this.options.nbTicksSecondary}setNbTicksSecondary(t){return this.options.nbTicksSecondary=t,this}handleMouseMove(t){this.mouseVal=this.getVal(t)}handleMouseWheel(t,i,r){t=Math.min(0.2,Math.max(-0.2,t)),'min'==r?r=this.getMinValue():'max'==r?r=this.getMaxValue():!r&&(r=0),this._doZoomVal((this.getCurrentMax()-r)*(1+t)+r,(this.getCurrentMin()-r)*(1+t)+r),this.graph.draw()}set zoomLock(t){this._zoomLocked=t}get zoomLock(){return this._zoomLocked||!1}zoom(t,i,r){return!r&&this.zoomLock?void 0:this._doZoomVal(t,i,!0)}_doZoomVal(t,i,r){return this._doZoom(this.getPx(t),this.getPx(i),t,i,r)}_doZoom(t,i,r,a,s){var r=void 0===r?this.getVal(t):r,a=void 0===a?this.getVal(i):a;return this.setCurrentMin(Math.min(r,a)),this.setCurrentMax(Math.max(r,a)),this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval(),this._zoomed=!0,this.adapt(),this._hasChanged=!0,s||this.emit('zoom',[this.currentAxisMin,this.currentAxisMax,this]),this}getSerieShift(){return this._serieShift}getSerieScale(){return this._serieScale}getMouseVal(){return this.mouseVal}getUnitPerTick(t,r,a){var s=Math.pow,n=Math.abs,o=t/A;r=r?Math.min(r,t/10):t/10;var p=a/r;switch(this.options.unitModification){case'time':case'time:min.sec':for(var d=this.getModifiedValue(this.getMaxValue()),g=!1,c=0,i=this.unitModificationTimeTicks.length;c<i;c++){for(var l=0,u=this.unitModificationTimeTicks[c][1].length;l<u;l++)if(p<this.unitModificationTimeTicks[c][0]*this.unitModificationTimeTicks[c][1][l]){g=!0;break}if(g)break}b=c===this.unitModificationTimeTicks.length?1:this.unitModificationTimeTicks[c][0]*this.unitModificationTimeTicks[c][1][l];break;default:var h=Math.floor(Math.log(p)/2.302585092994046),x=p*s(10,-h);this.decimals=-h;for(var m=[1,2,5,10],y=!1,c=m.length-1;0<=c;c--)(!y||n(m[c]-x)<n(y-x))&&(y=m[c]);var b=y*s(10,h);}var A=a/b,o=t/r;return[b,A,o]}setMinMaxToFitSeries(t){var i=Math.max,r=this.getInterval();return this.options.logScale?(this.currentAxisMin=i(1e-50,0.9*this.getMinValue()),this.currentAxisMax=i(1e-50,1.1*this.getMaxValue())):(this.currentAxisMin=this.getMinValue(),this.currentAxisMax=this.getMaxValue(),!1===this.getForcedMin()&&(this.currentAxisMin-=this.options.axisDataSpacing.min*r),!1===this.getForcedMax()&&(this.currentAxisMax+=this.options.axisDataSpacing.max*r)),(isNaN(this.currentAxisMin)||isNaN(this.currentAxisMax))&&(this.currentAxisMax=void 0,this.currentAxisMin=void 0),this.cache(),this._zoomed=!1,this.adapt(),t||this.graph._axisHasChanged(this),this.emit('zoomOutFull',[this.currentAxisMin,this.currentAxisMax,this]),this}getInterval(){return this.getMaxValue()-this.getMinValue()}getCurrentInterval(){return this.cachedInterval}getCurrentMin(){return this.cachedCurrentMin}getCurrentMax(){return this.cachedCurrentMax}cacheCurrentMin(){this.cachedCurrentMin=this.currentAxisMin==this.currentAxisMax?this.options.logScale?this.currentAxisMin/10:this.currentAxisMin-1:this.currentAxisMin}cacheCurrentMax(){this.cachedCurrentMax=this.currentAxisMax==this.currentAxisMin?this.options.logScale?10*this.currentAxisMax:this.currentAxisMax+1:this.currentAxisMax}cacheInterval(){this.cachedInterval=this.cachedCurrentMax-this.cachedCurrentMin}cache(){this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval()}setCurrentMin(t){return(void 0===t||!1!==this.getForcedMin()&&(t<this.getForcedMin()||void 0===t))&&(t=this.getMinValue()),this.currentAxisMin=t,this.options.logScale&&(this.currentAxisMin=Math.max(1e-50,t)),this.cacheCurrentMin(),this.cacheInterval(),this.graph._axisHasChanged(this),this}setCurrentMax(t){(t===void 0||!1!==this.getForcedMax()&&(t>this.getForcedMax()||t===void 0))&&(t=this.getMaxValue()),this.currentAxisMax=t,this.options.logScale&&(this.currentAxisMax=Math.max(1e-50,t)),this.cacheCurrentMax(),this.cacheInterval(),this.graph._axisHasChanged(this)}flip(t){return this.options.flipped=t,this.setMinMaxFlipped(),this}isFlipped(){return this.options.flipped}_draw(){var t=Math.abs,i=this;(void 0===this.currentAxisMin||void 0===this.currentAxisMax)&&this.setMinMaxToFitSeries(!0);var r=t(this.getMaxPx()-this.getMinPx()),a=this.getCurrentInterval();if(!this.isShown())return this.line.setAttribute('display','none'),0;this.line.setAttribute('display','block'),this.scientificExponent=!0==this.options.scientificScale?this.options.scientificScaleExponent?this.options.scientificScaleExponent:Math.floor(Math.log(Math.max(t(this.getCurrentMax()),t(this.getCurrentMin())))/2.302585092994046):0,this.gridLinePath.primary='',this.gridLinePath.secondary='';let s;if(!this.options.useKatexForLabel||!this.graph.hasKatexRenderer())this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(s=this.getExponentGreekLetter(this.scientificExponent))?(this.preunit=s,this.unitTspan.setAttribute('dx',0)):0===this.scientificExponent||isNaN(this.scientificExponent)?(!this.options.unit&&this.unitTspan.setAttribute('display','none'),this.preunit='',this.expTspan.setAttribute('display','none'),this.expTspanExp.setAttribute('display','none')):(this.options.engineeringScale&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent)),this.preunit='',this.expTspan.setAttribute('display','visible'),this.expTspanExp.setAttribute('display','visible'),this.expTspan.textContent='x10',this.expTspanExp.textContent=this.scientificExponent),this.writeUnit();else{let t=this.getLabel();this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(s=this.getExponentGreekLetter(this.scientificExponent))?(t+=s,this.preunitTspan.innerHTML=s,this.preunitTspan.setAttribute('display','visible'),this.unitTspan.setAttribute('dx',0),t+=' '+s+' '+this.options.unit):0!==this.scientificExponent&&!isNaN(this.scientificExponent)&&(this.options.engineeringScale&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent)),t+=' \\cdot 10^'+this.scientificExponent+' '+this.options.unit),this.katexElement=this.graph.renderWithKatex(t,this.katexElement)}if(!!this.options.hideTicks)var n=0;else if(this.resetTicksLength(),this.linkedToAxis){this.linkedToAxis.deltaPx=10;var n=this.drawLinkedToAxisTicksWrapper(r,a)}else if(!this.options.logScale)var n=this.drawLinearTicksWrapper(r,a);else var n=this.drawLogTicks();this.removeUselessTicks(),this.removeUselessTickLabels(),this.gridPrimary.setAttribute('d',this.gridLinePath.primary),this.gridSecondary.setAttribute('d',this.gridLinePath.secondary);var o=this.graph.findAxesLinkedTo(this);return o.map(function(t){t.linkedToAxis&&(t.setMinPx(i.getMinPx()),t.setMaxPx(i.getMaxPx()),t.draw())}),n}drawLines(){this.options.lineAt&&Array.isArray(this.options.lineAt)&&this.options.lineAt.forEach((t,i)=>{!isNaN(t)&&this.getCurrentMin()<=t&&this.getCurrentMax()>=t?this._lines[i]=this._drawLine(t,this._lines[i]):this._hideLine(this._lines[i])})}writeUnit(){this.options.unit?(this.unitTspan.setAttribute('display','visible'),this.unitTspan.setAttribute('dx',5),this.expTspan.setAttribute('display','none'),this.expTspanExp.setAttribute('display','none'),this.unitTspan.innerHTML=(this.options.unitWrapperBefore+this.preunit+this.options.unit+this.options.unitWrapperAfter).replace(/\^([-+0-9]*)(.*)/g,'<tspan dy=\'-5\' font-size=\'0.7em\'>$1</tspan><tspan dy=\'5\' font-size=\'1em\'>$2</tspan>')):this.unitTspan.setAttribute('display','none')}getExponentGreekLetter(t){switch(t){case 3:return'k';break;case 6:return'M';break;case 9:return'G';break;case 12:return'T';break;case 15:return'E';break;case-3:return'm';break;case-6:return'&mu;';break;case-9:return'n';break;case-12:return'p';break;case-15:return'f';}}drawLinearTicksWrapper(t,i){let r;return this.options.primaryTickUnit?r=this.options.primaryTickUnit:(r=this.getUnitPerTick(t,this.getNbTicksPrimary(),i)[0],this.options.maxPrimaryTickUnit&&this.options.maxPrimaryTickUnit<r?r=this.options.maxPrimaryTickUnit:this.options.minPrimaryTickUnit&&this.options.minPrimaryTickUnit>r&&(r=this.options.minPrimaryTickUnit)),this.drawTicks(r,this.secondaryTicks())}forcePrimaryTickUnit(t){this.options.primaryTickUnit=t}forcePrimaryTickUnitMax(t){this.options.maxPrimaryTickUnit=t}forcePrimaryTickUnitMin(t){this.options.minPrimaryTickUnit=t}getPrimaryTickUnit(){return this.incrTick}setTickLabelRatio(t){this.options.ticklabelratio=t}doesHideWhenNoSeriesShown(){return this.options.hideWhenNoSeriesShown}draw(){this._widthLabels=0;var t=this._draw();return this._widthLabels+=t,t}drawTicks(t,i){var r=t,a=this.getCurrentMin(),s=this.getCurrentMax(),n=0,o,l,p;for(i&&(o=r/i),l=this.options.shiftToZero?this.dataMin-Math.ceil((this.dataMin-a)/r)*r:Math.floor(a/r)*r,this.incrTick=t;l<=s&&(n++,!(200<n));){if(i){p=l+o,this.subIncrTick=p;for(var d=0;p<l+r&&(d++,!(100<d));){if(p<a||p>s){p+=o;continue}this.drawTickWrapper(p,!1,1e-4>Math.abs(p-l-r/2)?2:3),p+=o}}if(l<a||l>s){l+=t;continue}this.drawTickWrapper(l,!0,1),l+=t}return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick}nextTick(t,i){if(this.ticks[t]=this.ticks[t]||[],this.lastCurrentTick[t]=this.lastCurrentTick[t]||0,this.currentTick[t]=this.currentTick[t]||0,this.currentTick[t]>=this.ticks[t].length){var r=document.createElementNS(this.graph.ns,'line');this.groupTicks.appendChild(r),this.ticks[t].push(r),i(r)}var r=this.ticks[t][this.currentTick[t]];return this.currentTick[t]>=this.lastCurrentTick[t]&&r.setAttribute('display','visible'),this.currentTick[t]++,r}nextTickLabel(t){if(this.ticksLabels=this.ticksLabels||[],this.lastCurrentTickLabel=this.lastCurrentTickLabel||0,this.currentTickLabel=this.currentTickLabel||0,this.currentTickLabel>=this.ticksLabels.length){var i=document.createElementNS(this.graph.ns,'text');this.groupTickLabels.appendChild(i),this.ticksLabels.push(i),t(i)}var i=this.ticksLabels[this.currentTickLabel];return this.currentTickLabel>=this.lastCurrentTickLabel&&i.setAttribute('display','visible'),this.currentTickLabel++,i}removeUselessTicks(){for(var t in this.currentTick){for(var r=this.currentTick[t];r<this.ticks[t].length;r++)this.ticks[t][r].setAttribute('display','none');this.lastCurrentTick[t]=this.currentTick[t],this.currentTick[t]=0}}removeUselessTickLabels(){for(var t=this.currentTickLabel;t<this.ticksLabels.length;t++)this.ticksLabels[t].setAttribute('display','none');this.lastCurrentTickLabel=this.currentTickLabel,this.currentTickLabel=0}nextGridLine(t,i,r,a,s){(t&&this.options.primaryGrid||!t&&this.options.secondaryGrid)&&(this.gridLinePath[t?'primary':'secondary']+='M '+i+' '+a+' L '+r+' '+s)}setGridLineStyle(t,i){t.setAttribute('shape-rendering','crispEdges'),t.setAttribute('stroke',i?this.getPrimaryGridColor():this.getSecondaryGridColor()),t.setAttribute('stroke-width',i?this.getPrimaryGridWidth():this.getSecondaryGridWidth()),t.setAttribute('stroke-opacity',i?this.getPrimaryGridOpacity():this.getSecondaryGridOpacity());var r;(r=i?this.getPrimaryGridDasharray():this.getSecondaryGridDasharray())&&t.setAttribute('stroke-dasharray',r)}setGridLinesStyle(){return this.setGridLineStyle(this.gridPrimary,!0),this.setGridLineStyle(this.gridSecondary,!1),this}resetTicksLength(){}secondaryTicks(){return this.options.nbTicksSecondary}drawLogTicks(){var t=Math.pow,i=Math.log,r=this.getCurrentMin(),a=this.getCurrentMax(),s=Math.min(r,a),a=Math.max(r,a);1e-50>s&&(s=1e-50),20<i(s)-i(a)&&(a=t(10,20*i(s)));var n={fontSize:'1.0em',exponential:!0,overwrite:!1};0>s&&(s=0);for(var o=0==s?0:Math.floor(i(s)/2.302585092994046),s=1,l;(l=s*t(10,o))<a;)1==s&&l>r&&this.drawTickWrapper(l,!0,1,n),10==s?(s=1,o++):(1!=s&&l>r&&this.drawTickWrapper(l,!1,2,{overwrite:'',fontSize:'0.6em'}),s++);return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick}drawTickWrapper(t,i,r,a){this.drawTick(t,r,a)}linkToAxis(t,i,r){this.linkedToAxis={axis:t,scalingFunction:i,decimals:r||1}}drawLinkedToAxisTicksWrapper(i,r){var a=this.linkedToAxis,s=0,n,o,p,l;a.deltaPx||(a.deltaPx=10);do{if(n=a.scalingFunction(a.axis.getVal(s+this.getMinPx())),a.decimals&&(this.decimals=a.decimals),o=this.drawTick(n,1,{},s+this.getMinPx()),!o)throw console.log(n,s,this.getMinPx()),'Unable to draw tick. Please report the test-case';if(p=8*(o[1].textContent+'').length,l=5*Math.round(p/5),l>a.deltaPx)return a.deltaPx=l,void this.drawLinkedToAxisTicksWrapper(i,r);s+=a.deltaPx}while(s<i)}getPos(t){return this.getPx(t)}getPx(t){var i=Math.log;if(!this.options.logScale)return(t-this.getCurrentMin())/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())+this.getMinPx();if(!(0>t)){var t=(i(t)-i(this.getCurrentMin()))/(i(this.getCurrentMax())-i(this.getCurrentMin()))*(this.getMaxPx()-this.getMinPx())+this.getMinPx();return t}}getRoundedPx(t){return Math.round(10*this.getPx(t))/10}getVal(t){var i=Math.log;return this.options.logScale?Math.exp((t-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*(i(this.getCurrentMax())-i(this.getCurrentMin()))+i(this.getCurrentMin())):(t-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*this.getCurrentInterval()+this.getCurrentMin()}getRelPx(t){return t/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())}getRelVal(t){return t/(this.getMaxPx()-this.getMinPx())*this.getCurrentInterval()}valueToText(t){var i=Math.pow;if(this.scientificExponent)return t/=i(10,this.scientificExponent),t.toFixed(1);if(t=t*i(10,this.getExponentialFactor())*i(10,this.getExponentialLabelFactor()),this.options.shiftToZero&&(t-=this.dataMin),this.options.ticklabelratio&&(t*=this.options.ticklabelratio),this.options.unitModification)return t=this.modifyUnit(t,this.options.unitModification),t;var r=this.decimals-this.getExponentialFactor()-this.getExponentialLabelFactor();return isNaN(t)?'':(t=0<r?t.toFixed(r):t.toFixed(0),this.options.unitInTicks&&this.options.unit&&(t+=' '+this.options.unit),t)}valueToHtml(t,i,r){var a=this.valueToText(t),s;return this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(s=this.getExponentGreekLetter(this.scientificExponent))?a+=s:0!==this.scientificExponent&&!isNaN(this.scientificExponent)&&!i&&(a+='x10',a+='<sup>'+this.scientificExponent+'</sup>'),this.options.unit&&!r&&(a+=this.options.unit.replace(/\^([-+0-9]*)/g,'<sup>$1</sup>')),a}getModifiedValue(t){return this.options.ticklabelratio&&(t*=this.options.ticklabelratio),this.options.shiftToZero&&(t-=this.getMinValue()*(this.options.ticklabelratio||1)),t}modifyUnit(t,i){var r=Math.floor,a=Math.round,n='',o=this.incrTick;switch(i){case'time':var l=this.getModifiedValue(this.getMaxValue()),p=[[60,'min'],[3600,'h'],[86400,'d']],d;if(3600>l?d=0:86400>l?d=1:2592000>l&&(d=2),!p[d])return!1;t/=p[d][0];var g=r(t);for(n=g+p[d][1],d--;o<1*p[d+1][0]&&-1<d;)t=(t-g)*p[d+1][0]/p[d][0],g=a(t),n+=' '+g+p[d][1],d--;break;case'time:min.sec':t/=60;var g=r(t),c=a(60*(t-g))+'';c=1==c.length?'0'+c:c,n=g+'.'+c;}return n}getExponentialFactor(){return this.options.exponentialFactor}setExponentialFactor(t){this.options.exponentialFactor=t}setExponentialLabelFactor(t){this.options.exponentialLabelFactor=t}getExponentialLabelFactor(){return this.options.exponentialLabelFactor}setLabel(t){return this.options.labelValue=t,this}setLabelFont(t){return this.options.labelFont=t,this}getLabel(){return this.options.labelValue}setSpan(t,i){return this.options.span=[t,i],this}getSpan(){return this.options.span}setLevel(t){return this._level=t,this}getLevel(){return this._level}setShift(t){this.shift=t}getShift(){return this.shift}setTickPosition(t){switch(t){case 3:case'outside':case Graph$1.TICKS_OUTSIDE:t=3;break;case 2:case'centered':case Graph$1.TICKS_CENTERED:t=2;break;default:case 1:case'inside':case Graph$1.TICKS_INSIDE:t=1;}switch(this.options.tickPosition=t,this.options.tickPosition){case 3:this.tickPx1=-2,this.tickPx2=0;break;case 2:this.tickPx1=-1,this.tickPx2=1;break;case 1:this.tickPx1=0,this.tickPx2=2;}return this}setGrids(t){return this.options.primaryGrid=t,this.options.secondaryGrid=t,this}setPrimaryGrid(t){return this.options.primaryGrid=t,this}setSecondaryGrid(t){return this.options.secondaryGrid=t,this}primaryGridOn(){return this.setPrimaryGrid(!0)}primaryGridOff(){return this.setPrimaryGrid(!1)}secondaryGridOn(){return this.setSecondaryGrid(!0)}secondaryGridOff(){return this.setSecondaryGrid(!1)}gridsOn(){return this.setGrids(!0)}gridsOff(){return this.setGrids(!1)}turnGridsOff(){return this.gridsOff(...arguments)}turnGridsOn(){return this.gridsOn(...arguments)}setAxisColor(t){return this.options.axisColor=t,this}getAxisColor(){return this.options.axisColor||'black'}setTickLabelOffset(t){return this.options.tickLabelOffset=t,this}setPrimaryTicksColor(t){return this.options.primaryTicksColor=t,this}getPrimaryTicksColor(){return this.options.primaryTicksColor||'black'}setSecondaryTicksColor(t){return this.options.secondaryTicksColor=t,this}getSecondaryTicksColor(){return this.options.secondaryTicksColor||'black'}setTicksLabelColor(t){return this.options.ticksLabelColor=t,Array.isArray(this.ticksLabels)&&this.ticksLabels.forEach((i)=>{i.setAttribute('fill',t)}),this}getTicksLabelColor(){return this.options.ticksLabelColor||'black'}setPrimaryGridColor(t){return this.options.primaryGridColor=t,this.setGridLinesStyle(),this}getPrimaryGridColor(){return this.options.primaryGridColor}setSecondaryGridColor(t){return this.options.secondaryGridColor=t,this.setGridLinesStyle(),this}getSecondaryGridColor(){return this.options.secondaryGridColor}setPrimaryGridWidth(t){return this.options.primaryGridWidth=t,this.setGridLinesStyle(),this}getPrimaryGridWidth(){return this.options.primaryGridWidth}setSecondaryGridWidth(t){return this.options.secondaryGridWidth=t,this.setGridLinesStyle(),this}getSecondaryGridWidth(){return this.options.secondaryGridWidth}setPrimaryGridOpacity(t){return this.options.primaryGridOpacity=t,this}getPrimaryGridOpacity(){return this.options.primaryGridOpacity}setSecondaryGridOpacity(t){return this.options.secondaryGridOpacity=t,this}getSecondaryGridOpacity(){return this.options.secondaryGridOpacity}setPrimaryGridDasharray(t){return this.options.primaryGridDasharray=t,this}getPrimaryGridDasharray(){return this.options.primaryGridDasharray}setSecondaryGridDasharray(t){return this.options.secondaryGridDasharray=t,this}getSecondaryGridDasharray(){return this.options.secondaryGridDasharray}setLabelColor(t){return this.options.labelColor=t,this}getLabelColor(){return this.options.labelColor}setTickContent(t,i,r){if(r||(r={}),r.overwrite||!r.exponential)t.textContent=r.overwrite||this.valueToText(i);else{var a=Math.round(Math.log(i)/2.302585092994046),s=Math.floor(i*Math.pow(10,-a));t.textContent=1==s?'10':s+'x10';var n=document.createElementNS(this.graph.ns,'tspan');n.textContent=a,n.setAttribute('font-size','0.7em'),n.setAttribute('dy',-5),t.appendChild(n)}r.fontSize&&t.setAttribute('font-size',r.fontSize)}isX(){return!1}isY(){return!1}setUnit(t){return this.options.unit=t,this}setUnitInTicks(t){return this.options.unitInTicks=t,this}setUnitWrapper(t,i){return this.options.unitWrapperBefore=t,this.options.unitWrapperAfter=i,this}setUnitDecade(t){return this.options.unitDecade=t,this}setScientific(t){return this.options.scientificScale=t,this}setScientificScaleExponent(t){return this.options.scientificScaleExponent=t,this}setEngineering(t){return this.options.scientificScale=t,this.options.engineeringScale=t,this}getEngineeringExponent(t){return t-=0<t?t%3:(3- -t%3)%3,t}setLogScale(t){return this.options.logScale=t,this}isZoomed(){return this.currentAxisMin!=this.getMinValue()&&this.currentAxisMax!=this.getMaxValue()}hasAxis(){return!1}getType(){return null}useKatexForLabel(t=!0){return this.options.useKatexForLabel=t,this}}Axis.prototype.getValue=Axis.prototype.getVal,Axis.prototype.getDeltaPx=Axis.prototype.getRelPx;class AxisX extends Axis{constructor(t,i,r={}){super(t,i,r),this.top='top'==i}getAxisPosition(){if(!this.options.display)return 0;let t;return 0==this.options.tickLabelOffset?(t=1==this.options.tickPosition?8:20,t+=1*this.graph.options.fontSize):t=1==this.options.tickPosition?0:12,this.getLabel()&&(t+=this.graph.options.fontSize),t}isX(){return!0}isY(){return!1}setShift(t){this.shift=t;void 0!==this.getShift()&&this.graph.getDrawingHeight()&&this.group.setAttribute('transform','translate(0 '+(this.floating?this.getShift():this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+')')}getMaxSizeTick(){return(this.top?-1:1)*(1==this.options.tickPosition?10:10)}drawTick(t,i,r,a){var s=this,n;if(n=a||this.getPos(t),!(void 0==n||isNaN(n))){var o=this.nextTick(i,function(t){t.setAttribute('y1',(s.top?1:-1)*s.tickPx1*s.tickScaling[i]),t.setAttribute('y2',(s.top?1:-1)*s.tickPx2*s.tickScaling[i]),1==i?t.setAttribute('stroke',s.getPrimaryTicksColor()):t.setAttribute('stroke',s.getSecondaryTicksColor())});if(o.setAttribute('x1',n),o.setAttribute('x2',n),this.nextGridLine(1==i,n,n,0,this.graph.getDrawingHeight()),1==i){var l=this.nextTickLabel((t)=>{t.setAttribute('y',(s.top?-1:1)*((1==s.options.tickPosition?8:20)+(s.top?10:0))+this.options.tickLabelOffset),t.setAttribute('text-anchor','middle'),'black'!==s.getTicksLabelColor()&&t.setAttribute('fill',s.getTicksLabelColor()),t.style.dominantBaseline='hanging'});l.setAttribute('x',n),this.setTickContent(l,t,r)}return[o,l]}}drawLabel(){'black'!==this.getLabelColor()&&this.label.setAttribute('fill',this.getLabelColor()),this.options.labelFont&&this.label.setAttribute('font-family',this.options.labelFont),this.label.setAttribute('text-anchor','middle'),this.label.setAttribute('style','display: initial;'),this.label.setAttribute('x',Math.abs(this.getMaxPx()+this.getMinPx())/2),this.label.setAttribute('y',(this.top?-1:1)*((1==this.options.tickPosition?10:25)+this.graph.options.fontSize)),this.labelTspan.textContent=this.getLabel()}draw(){var t=super.draw(...arguments);return this.drawSpecifics(),t}drawSpecifics(){this.drawLabel(),this.line.setAttribute('x1',this.getMinPx()),this.line.setAttribute('x2',this.getMaxPx()),this.line.setAttribute('y1',0),this.line.setAttribute('y2',0),this.line.setAttribute('stroke',this.getAxisColor()),this.top||(this.labelTspan.style.dominantBaseline='hanging',this.expTspan.style.dominantBaseline='hanging',this.expTspanExp.style.dominantBaseline='hanging',this.unitTspan.style.dominantBaseline='hanging');var t=this.getSpan();this.line.setAttribute('marker-start',this.options.splitMarks&&0!=t[0]?'url(#horionzalsplit_'+this.graph.getId()+')':''),this.line.setAttribute('marker-end',this.options.splitMarks&&1!=t[1]?'url(#horionzalsplit_'+this.graph.getId()+')':'')}_drawLine(t,i){let r=this.getPx(t);return i?i.setAttribute('display','initial'):i=document.createElementNS(this.graph.ns,'line'),i.setAttribute('x1',r),i.setAttribute('x2',r),i.setAttribute('y1',0),i.setAttribute('y2',this.graph.drawingSpaceHeight),i.setAttribute('stroke','black'),this.group.appendChild(i),i}_hideLine(t){t&&t.setAttribute('display','none')}handleMouseMoveLocal(t){t-=this.graph.getPaddingLeft(),this.mouseVal=this.getVal(t)}setMinMaxFlipped(){var t=this.maxPx-this.minPx;if(!isNaN(t)){var i=t*this.options.span[1]+this.minPx-this.options.marginMax,r=t*this.options.span[0]+this.minPx+this.options.marginMin;this.minPxFlipped=this.isFlipped()?i:r,this.maxPxFlipped=this.isFlipped()?r:i}}getZProj(t){return t*this.graph.options.zAxis.shiftX}}class AxisY extends Axis{constructor(t,i,r){super(t,i,r),this.leftright=i,this.left='left'==i}setAxisPosition(t){this.shiftPosition=t}getAxisPosition(){return this.shiftPosition||0}getAdditionalWidth(){let t=0;return this.getLabel()&&(t+=this.graph.options.fontSize),this.isShown()&&(t+=Math.abs(this.tickMargin)),t}isX(){return!1}isY(){return!0}resetTicksLength(){this.longestTick=[!1,0]}getMaxSizeTick(){return this.longestTick&&this.longestTick[0]?this.longestTick[0].getComputedTextLength()+5:0}draw(){this.tickMargin=this.left?-5-this.tickPx1*this.tickScaling[1]:2-this.tickPx1*this.tickScaling[1];var t=super.draw(...arguments);return t+=this.getAdditionalWidth(),this.drawSpecifics(t),this.fullwidthlabel=t,t}equalizePosition(t){return this.placeLabel(this.left?-t:t),this.getLabel()?t+this.graph.options.fontSize:0}drawTick(t,i,r,a){var s=this,n=this.groupTicks,o,l;if(o=a||this.getPos(t),!(void 0==o||isNaN(o))){var p=this.nextTick(i,(t)=>{t.setAttribute('x1',(this.left?1:-1)*this.tickPx1*this.tickScaling[i]),t.setAttribute('x2',(this.left?1:-1)*this.tickPx2*this.tickScaling[i]),1==i?t.setAttribute('stroke',this.getPrimaryTicksColor()):t.setAttribute('stroke',this.getSecondaryTicksColor())});if(p.setAttribute('y1',o),p.setAttribute('y2',o),this.nextGridLine(1==i,0,this.graph.getDrawingWidth(),o,o),1==i){var l=this.nextTickLabel((t)=>{t.setAttribute('x',this.tickMargin+this.options.tickLabelOffset),'black'!==this.getTicksLabelColor()&&t.setAttribute('fill',this.getTicksLabelColor()),this.left?t.setAttribute('text-anchor','end'):t.setAttribute('text-anchor','start'),t.style.dominantBaseline='central'});l.setAttribute('y',o),this.setTickContent(l,t,r),(l.textContent+'').length>=this.longestTick[1]&&(this.longestTick[0]=l,this.longestTick[1]=(l.textContent+'').length)}}}drawLabel(){'black'!==this.getLabelColor()&&this.label.setAttribute('fill',this.getLabelColor()),this.label.setAttribute('dominant-baseline',this.left?'auto':'auto'),this.labelTspan.textContent=this.getLabel()}placeLabel(t){this.label.setAttribute('transform','translate('+t+', '+Math.abs(this.getMaxPx()+this.getMinPx())/2+') rotate(-90)')}drawSpecifics(){this.line.setAttribute('y1',this.getMinPx()),this.line.setAttribute('y2',this.getMaxPx()),this.line.setAttribute('x1',0),this.line.setAttribute('x2',0),this.line.setAttribute('stroke',this.getAxisColor());var t=this.getSpan();this.line.setAttribute('marker-start',this.options.splitMarks&&0!=t[0]?'url(#verticalsplit_'+this.graph.getId()+')':''),this.line.setAttribute('marker-end',this.options.splitMarks&&1!=t[1]?'url(#verticalsplit_'+this.graph.getId()+')':'')}setShift(t){if(this.shift=t,!this.shift||!this.graph.getWidth())return;let i=this.shift;i=this.floating?i:this.isLeft()?i:this.graph.getWidth()-this.graph.getPaddingRight()-this.graph.getPaddingLeft()-i,this.group.setAttribute('transform','translate( '+i+' 0 )'),this.drawLabel()}isLeft(){return this.left}isRight(){return!this.left}isFlipped(){return!this.options.flipped}_drawLine(t,i){let r=this.getPx(t);return i?i.setAttribute('display','initial'):i=document.createElementNS(this.graph.ns,'line'),i.setAttribute('y1',r),i.setAttribute('y2',r),i.setAttribute('x1',0),i.setAttribute('x2',this.graph.drawingSpaceWidth),i.setAttribute('stroke','black'),this.group.appendChild(i),i}_hideLine(t){t&&t.setAttribute('display','none')}handleMouseMoveLocal(t,i){i-=this.graph.getPaddingTop(),this.mouseVal=this.getVal(i)}scaleToFitAxis(t,r,a,s,n,o){t&&t.isX()||(t=this.graph.getXAxis()),isNaN(a)&&(a=t.getCurrentMin()),isNaN(s)&&(s=t.getCurrentMax()),n===void 0&&(n=!0),o===void 0&&(o=!0),'number'==typeof r&&(s=a,a=r,r=!1);for(var p=-Infinity,d=Infinity,g=0,c=0,i=this.graph.series.length;c<i;c++)this.graph.series[c].isShown()&&this.graph.series[c]!=r&&this.graph.series[c].getXAxis()==t&&this.graph.series[c].getYAxis()===this&&(g++,p=o?Math.max(p,this.graph.series[c].getMax(a,s)):0,d=n?Math.min(d,this.graph.series[c].getMin(a,s)):0);if(0==g)this.setMinMaxToFitSeries();else{d=n?d:this.getCurrentMin(),p=o?p:this.getCurrentMax();var l=p-d;d-=this.options.axisDataSpacing.min*l,p+=this.options.axisDataSpacing.max*l,this._doZoomVal(d,p)}return this}setMinMaxFlipped(){var t=this.maxPx-this.minPx;if(!isNaN(t)){var i=this.maxPx-t*this.options.span[0]-this.options.marginMin,r=this.maxPx-t*this.options.span[1]+this.options.marginMax;this.minPxFlipped=this.isFlipped()?i:r,this.maxPxFlipped=this.isFlipped()?r:i}}getZProj(t){return t*this.graph.options.zAxis.shiftY}}class AxisXBar extends AxisX{constructor(t,i,r={}){super(t,i,r)}set categories(t){return this._barCategories=t,this}draw(){var t=this,r=this.graph.drawingSpaceWidth,a=this._barCategories,s;if(this.forceMin(0),this.forceMax(1),this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval(),!!a){Array.isArray(a)||(a=[a]);for(var n=0;n<=a.length;n++)this.drawTick(n/a.length,2),n<a.length&&(s=this.nextTickLabel(function(i){i.setAttribute('y',(t.top?-1:1)*((1==t.options.tickPosition?8:20)+(t.top?10:0))),i.setAttribute('text-anchor','middle'),'black'!==t.getTicksLabelColor()&&i.setAttribute('fill',t.getTicksLabelColor()),i.style.dominantBaseline='hanging'}),s.setAttribute('x',this.getPos((n+0.5)/a.length)),s.textContent=a[n].title);return this.drawSpecifics(),this}}autoSeries(){let t=[];for(let i of this.graph.series)i.getXAxis()==this&&t.push(i);return this.setSeries(...t),this}setSeries(){var t=this;return this.series=arguments,Array.prototype.map.call(this.series,function(i,r){'object'==typeof i||(i=t.graph.getSerie(i)),i.setCategoryConfig&&i.setCategoryConfig(r,t._barCategories,t.series.length)}),this._getUsedCategories(),this}_getUsedCategories(){let t={},i=0;Array.prototype.map.call(this.series,(r)=>{let a=r.getUsedCategories();for(let s of a)t.hasOwnProperty(s)||(t[s]=1,i+=1),t[s]++,i++});let r=0;for(let a in t){let i=t[a];t[a]=r,r+=i}let a={};Array.prototype.map.call(this.series,(r)=>{let s=r.getUsedCategories(),n={};s.map((r)=>{a[r]=a[r]||0.5,n[r]=(t[r]+a[r])/i,a[r]++}),r.setDataIndices(n,i)})}getType(){return'category'}}var axisFormat=[{threshold:20,increments:{1:{increment:1,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:1,unit:'s',format:'MM:ss"s"'}}},{threshold:50,increments:{1:{increment:1,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:2,unit:'s',format:'MM:ss"s"'}}},{threshold:100,increments:{1:{increment:1,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:5,unit:'s',format:'MM:ss"s"'}}},{threshold:600,increments:{1:{increment:10,unit:'i',format:'HH"h"MM (dd/mm/yy)'},2:{increment:30,unit:'s',format:'MM:ss"s"'}}},{threshold:1e3,increments:{1:{increment:1,unit:'h',format:'HH"h"MM (dd/mm/yy)'},2:{increment:10,unit:'i',format:'MM"min"'}}},{threshold:1500,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:1,unit:'i',format:'H"h"MM'}}},{threshold:3e3,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:2,unit:'i',format:'H"h"MM'}}},{threshold:8e3,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:10,unit:'i',format:'H"h"MM'}}},{threshold:26400,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:20,unit:'i',format:'H"h"MM'}}},{threshold:86400,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:1,unit:'h',format:'H"h"MM'}}},{threshold:2e5,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:2,unit:'h',format:'H"h"MM'}}},{threshold:4e5,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:6,unit:'h',format:'H"h"MM'}}},{threshold:1.4e6,increments:{1:{increment:1,unit:'d',format:'dd/mm/yyyy'},2:{increment:12,unit:'h',format:'HH"h"MM'}}},{threshold:6.4e6,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:1,unit:'d',format:'dd'}}},{threshold:1.24e7,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:2,unit:'d',format:'dd'}}},{threshold:43200000,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:7,unit:'d',format:'dd'}}},{threshold:69120000,increments:{1:{increment:1,unit:'m',format:'mmmm yyyy'},2:{increment:15,unit:'d',format:'dd'}}},{threshold:86400000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:3,unit:'m',format:'mm/yyyy'}}},{threshold:172800000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:4,unit:'m',format:'mm/yyyy'}}},{threshold:864000000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:6,unit:'m',format:'mm/yyyy'}}},{threshold:1036800000,increments:{1:{increment:1,unit:'y',format:'yyyy'},2:{increment:1,unit:'y',format:'yyyy'}}}],dateFormat=function(){var t=Math.abs,i=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[WLloSZ]|"[^"]*"|'[^']*'/g,r=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g,n=function(t,i){for(t+='',i=i||2;t.length<i;)t='0'+t;return t},l=function(t,i){var r=new Date(t[i+'FullYear'](),0,1);return Math.ceil(((t-r)/8.64e7+r[i+'Day']()+1)/7)};return function(p,g,c){var u=dateFormat;if(1!=arguments.length||'[object String]'!=Object.prototype.toString.call(p)||/\d/.test(p)||(g=p,p=void 0),p=p?new Date(p):new Date,isNaN(p))throw SyntaxError('invalid date:'+p);g=(u.masks[g]||g||u.masks.default)+'','UTC:'==g.slice(0,4)&&(g=g.slice(4),c=!0);var h=c?'getUTC':'get',x=p[h+'Date'](),b=p[h+'Day'](),A=p[h+'Month'](),m=p[h+'FullYear'](),f=p[h+'Hours'](),k=p[h+'Minutes'](),S=p[h+'Seconds'](),C=p[h+'Milliseconds'](),v=c?0:p.getTimezoneOffset(),o={d:x,dd:n(x),ddd:u.i18n.dayNames[b],dddd:u.i18n.dayNames[b+7],m:A+1,mm:n(A+1),mmm:u.i18n.monthNames[A],mmmm:u.i18n.monthNames[A+12],yy:(m+'').slice(2),yyyy:m,h:f%12||12,hh:n(f%12||12),H:f,HH:n(f),M:k,MM:n(k),s:S,ss:n(S),l:n(C,3),L:n(99<C?Math.round(C/10):C),t:12>f?'a':'p',tt:12>f?'am':'pm',T:12>f?'A':'P',TT:12>f?'AM':'PM',Z:c?'UTC':((p+'').match(r)||['']).pop().replace(a,''),o:(0<v?'-':'+')+n(100*Math.floor(t(v)/60)+t(v)%60,4),S:['th','st','nd','rd'][3<x%10?0:(10!=x%100-x%10)*x%10],W:l(p,h)};return g.replace(i,function(t){return t in o?o[t]:t.slice(1,t.length-1)})}}();dateFormat.masks={default:'ddd mmm dd yyyy HH:MM:ss',shortDate:'m/d/yy',mediumDate:'mmm d, yyyy',longDate:'mmmm d, yyyy',fullDate:'dddd, mmmm d, yyyy',shortTime:'h:MM TT',mediumTime:'h:MM:ss TT',longTime:'h:MM:ss TT Z',isoDate:'yyyy-mm-dd',isoTime:'HH:MM:ss',isoDateTime:'yyyy-mm-dd\'T\'HH:MM:ss',isoUtcDateTime:'UTC:yyyy-mm-dd\'T\'HH:MM:ss\'Z\''},dateFormat.i18n={dayNames:['Sun','Mon','Tue','Wed','Thu','Fri','Sat','Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],monthNames:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec','January','February','March','April','May','June','July','August','September','October','November','December']};function getClosestIncrement(t,i){return Math.round(t/i)*i}function roundDate(t,i){switch(i.unit){case's':t.setSeconds(getClosestIncrement(t.getSeconds(),i.increment)),t.setMilliseconds(0);break;case'i':t.setMinutes(getClosestIncrement(t.getMinutes(),i.increment)),t.setSeconds(0),t.setMilliseconds(0);break;case'h':t.setHours(getClosestIncrement(t.getHours(),i.increment)),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);break;case'd':t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(0),t.setDate(getClosestIncrement(t.getDate(),i.increment));break;case'm':t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(0),t.setDate(1),t.setMonth(getClosestIncrement(t.getMonth(),i.increment));break;case'y':t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(0),t.setDate(1),t.setMonth(0);break;default:throw'Date format not recognized';}return t}function incrementDate(t,i){switch(i.unit){case's':t.setSeconds(t.getSeconds()+i.increment),t.setMilliseconds(0);break;case'i':t.setMinutes(t.getMinutes()+i.increment),t.setSeconds(0),t.setMilliseconds(0);break;case'h':t.setHours(t.getHours()+i.increment),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);break;case'd':t.setDate(t.getDate()+i.increment),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(0);break;case'm':t.setMonth(t.getMonth()+i.increment),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(0),t.setDate(1);break;case'y':t.setFullYear(t.getFullYear()+i.increment),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(0),t.setDate(1),t.setMonth(0);break;default:throw'Date format not recognized';}return t}function getGroup(t,i,r){if(t.groups[i][r])return t.groups[i][r].group.setAttribute('display','block'),t.groups[i][r];var a={group:document.createElementNS(t.graph.ns,'g'),text:document.createElementNS(t.graph.ns,'text')},s=document.createElementNS(t.graph.ns,'line');return s.setAttribute('stroke','black'),s.setAttribute('y1',0),2===i?(s.setAttribute('y2',6),a.text.setAttribute('y',15),a.line=s,a.group.appendChild(a.line)):1===i?(s.setAttribute('y2',20),a.text.setAttribute('y',10),a.line1=s,a.line2=s.cloneNode(),a.group.appendChild(a.line1),a.group.appendChild(a.line2)):void 0,(a.text.setAttribute('text-anchor','middle'),a.text.setAttribute('dominant-baseline','middle'),a.group.appendChild(a.text),t.getWrapper(i).appendChild(a.group),t.groups[i][r]=a)}function hideGroups(t,i,r){for(;r<t.groups[i].length;r++)hideGroup(t.groups[i][r])}function hideGroup(t){t.group.setAttribute('display','none')}function getDateText(t,i){return dateFormat(t,i)}function renderGroup(t,i,r,a,s,n,o){var l=Math.max,p=Math.min;switch(t){case 1:var d=l(a,p(s,n)),g=l(a,p(s,o));if(isNaN(g)||isNaN(d))return;for(i.line1.setAttribute('x1',d),i.line2.setAttribute('x1',g),i.line1.setAttribute('x2',d),i.line2.setAttribute('x2',g),i.text.setAttribute('x',(d+g)/2);8*r.length>g-d;)if(r=r.substr(0,r.length-2)+'.',1==r.length){r='';break}i.text.textContent=r;break;case 2:if(n<a||n>s)return void hideGroup(i);i.line.setAttribute('x1',n),i.line.setAttribute('x2',n),i.text.setAttribute('x',n),i.text.textContent=r;}}class GraphTimeAxis extends Axis{constructor(){super(...arguments)}init(t,i){super.init(t,i),this.wrapper={1:document.createElementNS(t.ns,'g'),2:document.createElementNS(t.ns,'g')},this.groups={1:[],2:[]};var r=document.createElementNS(t.ns,'rect');r.setAttribute('fill','#c0c0c0'),r.setAttribute('stroke','#808080'),r.setAttribute('height','20'),r.setAttribute('x','0'),r.setAttribute('y','0'),this.rect=r,this.wrapper[1].appendChild(this.rect),this.group.appendChild(this.wrapper[1]),this.group.appendChild(this.wrapper[2]),this.wrapper[1].setAttribute('transform','translate( 0, 25 )'),this.wrapper[2].setAttribute('transform','translate( 0, 00 )')}draw(){this.cacheCurrentMax(),this.cacheCurrentMin(),(void 0==this.currentAxisMin||void 0==this.currentAxisMax)&&this.setMinMaxToFitSeries(!0),this.line.setAttribute('x1',this.getMinPx()),this.line.setAttribute('x2',this.getMaxPx()),this.line.setAttribute('y1',0),this.line.setAttribute('y2',0);var t=this.maxPx-this.minPx,r=this.getCurrentInterval(),a=this.getCurrentMax(),s=this.getCurrentMin();if(this.rect.setAttribute('width',t),this.rect.setAttribute('x',this.minPx),!a||!s)return 0;var n;for(h=0;h<axisFormat.length;h++)if(axisFormat[h].threshold>r/t){n=axisFormat[h];break}n||(n=axisFormat[axisFormat.length-1]);var o=0,l,p,d,g,c,u,h;for(o=1;2>=o;o++){if(!isNumeric$1(s)){hideGroups(this,o,0);break}d=new Date(s),g=roundDate(d,n.increments[o]),h=0;do if(c=getDateText(g,n.increments[o].format),u=getGroup(this,o,h),l=this.getPx(g.getTime()),g=incrementDate(g,n.increments[o]),p=this.getPx(g.getTime()),renderGroup(o,u,c,this.getMinPx(),this.getMaxPx(),l,p),h++,100<h)break;while(g.getTime()<a);hideGroups(this,o,h)}}isX(){return!0}getWrapper(t){return this.wrapper[t]}setShift(t){this.shift=t,this.group.setAttribute('transform','translate(0 '+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+')')}getAxisPosition(){return 60}setMinMaxFlipped(){var t=this.maxPx-this.minPx,i=t*this.options.span[1]+this.minPx,r=t*this.options.span[0]+this.minPx;this.minPxFlipped=this.isFlipped()?i:r,this.maxPxFlipped=this.isFlipped()?r:i}}class Serie extends EventEmitter{static default(){return{redrawShapesAfterDraw:!1}}constructor(t,i,r){super(...arguments),this.graph=t,this.name=i,this.options=Object.assign({},Serie.default(),this.constructor.default(),r)}draw(){}beforeDraw(){}afterDraw(){this.options.redrawShapesAfterDraw&&this.graph.getShapesOfSerie(this).forEach((t)=>{t.redraw()}),this.emit('draw')}setData(t){if(t instanceof Waveform)return this.setWaveform(t);throw'Setting data other than waveforms in not supported by default. You must implemented this method in the inherited class.'}_addData(){return[]}clearData(){return this.setData(new Waveform),this}getData(){return this.data}setOptions(t){this.options=t||{}}setOption(t,i){this.options[t]=i}kill(t){return this.graph.removeSerieFromDom(this),this.graph._removeSerie(this),this.graph.legend&&!t&&this.graph.legend.update(),this.graph=void 0,this}hide(t,r=!1){if(this.hidden=!0,this.groupMain.setAttribute('display','none'),this.getSymbolForLegend().setAttribute('opacity',0.5),this.getTextForLegend().setAttribute('opacity',0.5),this.hideImpl(),t)for(var a=this.graph.getShapesOfSerie(this),s=0,i=a.length;s<i;s++)a[s].hide();return r||this.emit('hide'),(this.getXAxis().doesHideWhenNoSeriesShown()||this.getYAxis().doesHideWhenNoSeriesShown())&&this.graph.draw(!0),this}show(t,r=!1){if(this.hidden=!1,this.groupMain.setAttribute('display','block'),this.getSymbolForLegend().setAttribute('opacity',1),this.getTextForLegend().setAttribute('opacity',1),this.showImpl(),this.draw(!0),t)for(var a=this.graph.getShapesOfSerie(this),s=0,i=a.length;s<i;s++)a[s].show();return r||this.emit('show'),(this.getXAxis().doesHideWhenNoSeriesShown()||this.getYAxis().doesHideWhenNoSeriesShown())&&this.graph.draw(!0),this}hideImpl(){}showImpl(){}toggleDisplay(){return this.isShown()?this.hide():this.show(),this}isShown(){return!this.hidden}axisCheck(){if(!this.getXAxis()||!this.getYAxis())throw'No axis exist for this serie. Check that they were properly assigned';if(isNaN(this.getXAxis().getCurrentMin())||isNaN(this.getXAxis().getCurrentMax())||isNaN(this.getYAxis().getCurrentMin())||isNaN(this.getYAxis().getCurrentMax()))throw'Axis min and max values are not defined. Try autoscaling'}getX(t){return(t=this.getXAxis().getPx(t))-t%0.2}getY(t){return(t=this.getYAxis().getPx(t))-t%0.2}isSelected(){return this.selected||'unselected'!==this.selectionType}_checkX(t){this.minX=Math.min(this.minX,t),this.maxX=Math.max(this.maxX,t)}_checkY(t){this.minY=Math.min(this.minY,t),this.maxY=Math.max(this.maxY,t)}getName(){return this.name}autoAxis(){return this.isFlipped()?(this.setXAxis(this.graph.getYAxis()),this.setYAxis(this.graph.getXAxis())):(this.setXAxis(this.graph.getXAxis()),this.setYAxis(this.graph.getYAxis())),this.graph.updateDataMinMaxAxes(),this}autoAxes(){return this.autoAxis(...arguments)}setXAxis(t){return this.xaxis='number'==typeof t?this.isFlipped()?this.graph.getYAxis(t):this.graph.getXAxis(t):t,this.graph.updateDataMinMaxAxes(),this}setYAxis(t){return'number'==typeof t?this.xaxis=this.isFlipped()?this.graph.getXAxis(t):this.graph.getYAxis(t):this.yaxis=t,this.graph.updateDataMinMaxAxes(),this}setAxes(){for(var t=0;2>t;t++)arguments[t]&&this[arguments[t].isX()?'setXAxis':'setYAxis'](arguments[t]);return this.graph.updateDataMinMaxAxes(),this}getXAxis(){return this.xaxis}getYAxis(){return this.yaxis}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getWaveform(){return this.waveform}getWaveforms(){return[this.waveform]}setWaveform(t){if(!(t instanceof Waveform))throw'Cannot assign waveform to serie. Waveform is not of the proper Waveform instance';return this.waveform=t,this.minX=this.waveform.getXMin(),this.maxX=this.waveform.getXMax(),this.minY=this.waveform.getMin(),this.maxY=this.waveform.getMax(),this.graph.updateDataMinMaxAxes(),this.dataHasChanged(),this}getSymbolForLegend(){if(!this.lineForLegend){var t=document.createElementNS(this.graph.ns,'line');this.applyLineStyle(t),t.setAttribute('x1',5),t.setAttribute('x2',25),t.setAttribute('y1',0),t.setAttribute('y2',0),t.setAttribute('cursor','pointer'),this.lineForLegend=t}return this.lineForLegend}setLegendSymbolStyle(){this.applyLineStyle(this.getSymbolForLegend())}updateStyle(){this.setLegendSymbolStyle(),this.graph.updateLegend()}getTextForLegend(){if(!this.textForLegend){var t=document.createElementNS(this.graph.ns,'text');t.setAttribute('cursor','pointer'),t.textContent=this.getLabel(),this.textForLegend=t}return this.textForLegend}getIndex(){return this.graph.series.indexOf(this)}getLabel(){return this.options.label||this.name}setLabel(t){return this.options.label=t,this.textForLegend&&(this.textForLegend.textContent=t),this.graph.requireLegendUpdate(),this}setFlip(t){return this.options.flip=t,this}getFlip(){return this.options.flip}isFlipped(){return this.options.flip}setLayer(t){let i=parseInt(t)||1;return i!==this.options.layer&&(this.options.layer=i,this.graph.appendSerieToDom(this)),this}getLayer(){return this.options.layer||1}setStyle(t,i='unselected'){this.styles[i]=t,this.styleHasChanged(i)}styleHasChanged(t='unselected'){if(this._changedStyles=this._changedStyles||{},!1===t)for(var r in this._changedStyles)this._changedStyles[r]=!1;else this._changedStyles[t||'unselected']=!0;return this.graph.requireLegendUpdate(),this}hasStyleChanged(t){return this._changedStyles=this._changedStyles||{},this._changedStyles[t||'unselected']}dataHasChanged(t){return this._dataHasChanged=void 0===t||t,this}hasDataChanged(){return this._dataHasChanged}setInfo(t,i){return this.infos=this.infos||{},this.infos[t]=i,this}getInfo(t){return(this.infos||{})[t]}setAdditionalData(t){return this.additionalData=t,this}getAdditionalData(){return this.additionalData}select(){return this.selected=!0,this}unselect(){return this.selected=!1,this}enableTracking(t,i){return this._tracker=!0,this._trackingCallback=t,this._trackingOutCallback=i,this}disableTracking(){return this._trackerDom&&(this._trackerDom.remove(),this._trackerDom=null),this._tracker=!1,this._trackingCallback=null,this}allowTrackingLine(t){t=t||{},this.graph.addSerieToTrackingLine(this,t)}getMarkerForLegend(){return!1}get type(){return this._type}getType(){return this._type}set excludedFromLegend(t){this._excludedFromLegend=t}get excludedFromLegend(){return!!this._excludedFromLegend}setDataIndices(t,i){this.categoryIndices=t,this.nbCategories=i}hasErrors(){return!!this.waveform&&this.waveform.hasErrorBars()}}var ErrorBarMixin={makeBarY:function(t,i,r){if(t&&void 0!==r){var a=isNumeric$1(r.width)?r.width:10;return' V '+t+' m -'+a/2+' 0 h '+a+' m -'+a/2+' 0 V '+i+' '}},makeBoxY:function(t,i,r){return t&&void 0!==r?' m 5 0 V '+t+' h -10 V '+i+' m 5 0 ':void 0},makeBarX:function(t,i,r){if(t&&void 0!==r){var a=isNumeric$1(r.width)?r.width:10;return' H '+t+' m 0 -'+a/2+' v '+a+' m 0 -'+a/2+' H '+i+' '}},makeBoxX:function(t,i,r){return t&&void 0!==r?' v 5 H '+t+' v -10 H '+i+' v 5 ':void 0},setErrorBarStyle:function(t){return this.errorbarStyle=this._setErrorStyle(t),this},setErrorBoxStyle:function(t){return this.errorboxStyle=this._setErrorStyle(t),this},_setErrorStyle(t={}){var i=[],r=[['y','top','bottom'],['x','left','right']],a=(t)=>{t.dom=document.createElementNS(this.graph.ns,'path'),t.dom.setAttribute('fill',t.fillColor||'none'),t.dom.setAttribute('stroke',t.strokeColor||'black'),t.dom.setAttribute('stroke-opacity',t.strokeOpacity||1),t.dom.setAttribute('fill-opacity',t.fillOpacity||1),t.dom.setAttribute('stroke-width',t.strokeWidth||1),this.groupMain.appendChild(t.dom)},i={};'string'==typeof t&&(t={});for(var s=0,n=r.length;s<n;s++){t.all&&(t[r[s][1]]=extend(!0,{},t.all),t[r[s][2]]=extend(!0,{},t.all)),t[r[s][0]]&&(t[r[s][1]]=extend(!0,{},t[r[s][0]]),t[r[s][2]]=extend(!0,{},t[r[s][0]]));for(var o=1;2>=o;o++)t[r[s][o]]&&(i[r[s][o]]=t[r[s][o]],a(i[r[s][o]]))}return i},errorDrawInit:function(){this.errorboxStyle&&(this.errorboxStyle.paths={top:'',bottom:'',left:'',right:''}),this.errorbarStyle&&(this.errorbarStyle.paths={top:'',bottom:'',left:'',right:''})},errorAddPoint:function(t,i,r,a,s){let n;(n=this.waveform.getErrorBarXBelow(t))&&(this.errorbarStyle.paths.left+=' M '+a+' '+s,this.errorbarStyle.paths.left+=this.makeBarX(this.getX(i-n),a,this.errorbarStyle.left)),(n=this.waveform.getErrorBarXAbove(t))&&(this.errorbarStyle.paths.right+=' M '+a+' '+s,this.errorbarStyle.paths.right+=this.makeBarX(this.getX(i+n),a,this.errorbarStyle.right)),(n=this.waveform.getErrorBarYBelow(t))&&(this.errorbarStyle.paths.bottom+=' M '+a+' '+s,this.errorbarStyle.paths.bottom+=this.makeBarY(this.getY(r-n),s,this.errorbarStyle.bottom)),(n=this.waveform.getErrorBarYAbove(t))&&(this.errorbarStyle.paths.top+=' M '+a+' '+s,this.errorbarStyle.paths.top+=this.makeBarY(this.getY(r+n),s,this.errorbarStyle.top)),(n=this.waveform.getErrorBoxXBelow(t))&&(this.errorboxStyle.paths.left+=' M '+a+' '+s,this.errorboxStyle.paths.left+=this.makeBoxX(this.getX(i-n),a,this.errorboxStyle.left)),(n=this.waveform.getErrorBoxXAbove(t))&&(this.errorboxStyle.paths.right+=' M '+a+' '+s,this.errorboxStyle.paths.right+=this.makeBoxX(this.getX(i+n),a,this.errorboxStyle.right)),(n=this.waveform.getErrorBoxYBelow(t))&&(this.errorboxStyle.paths.bottom+=' M '+a+' '+s,this.errorboxStyle.paths.bottom+=this.makeBoxY(this.getY(r-n),s,this.errorboxStyle.bottom)),(n=this.waveform.getErrorBoxYAbove(t))&&(this.errorboxStyle.paths.top+=' M '+a+' '+s,this.errorboxStyle.paths.top+=this.makeBoxY(this.getY(r+n),s,this.errorboxStyle.top))},errorAddPointBarChart:function(t,i,r,a){var s;this.error&&(s=this.error[t])&&this.doErrorDraw('y',s,i,a,r,a)},errorDraw:function(){if(this.errorbarStyle)for(var t in this.errorbarStyle.paths)this.errorbarStyle[t]&&this.errorbarStyle[t].dom&&this.errorbarStyle[t].dom.setAttribute('d',this.errorbarStyle.paths[t]);if(this.errorboxStyle)for(var t in this.errorboxStyle.paths)this.errorboxStyle[t]&&this.errorboxStyle[t].dom&&this.errorboxStyle[t].dom.setAttribute('d',this.errorboxStyle.paths[t])}};class SerieLine extends Serie{static default(){return{lineColor:'black',lineStyle:1,flip:!1,label:'',lineWidth:1,markers:!1,trackMouse:!1,trackMouseLabel:!1,trackMouseLabelRouding:1,lineToZero:!1,selectableOnClick:!1,markersIndependant:!1,overflowX:!1,overflowY:!1}}constructor(){super(...arguments),this.selectionType='unselected',this.markerFamilies={},mapEventEmission(this.options,this),this.styles={},this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,lineWidth:this.options.lineWidth,markers:this.options.markers},this.styles.selected={lineWidth:3},this.extendStyles(),this.markersDom=new Map,this.shown=!0,this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupLines=document.createElementNS(this.graph.ns,'g'),this.domMarker=document.createElementNS(this.graph.ns,'path'),this.domMarker.style.cursor='pointer',this.groupMain=document.createElementNS(this.graph.ns,'g'),this.additionalData={},this.marker=document.createElementNS(this.graph.ns,'circle'),this.marker.setAttribute('fill','black'),this.marker.setAttribute('r',3),this.marker.setAttribute('display','none'),this.markerLabel=document.createElementNS(this.graph.ns,'text'),this.markerLabelSquare=document.createElementNS(this.graph.ns,'rect'),this.markerLabelSquare.setAttribute('fill','white'),this.domMarkerHover={},this.domMarkerSelect={},this.markerHovered=0,this.groupMarkerSelected=document.createElementNS(this.graph.ns,'g'),this.markerPoints={},this.lines=[],this.groupMain.appendChild(this.groupLines),this.groupMain.appendChild(this.marker),this.groupMain.appendChild(this.groupMarkerSelected),this.groupMain.appendChild(this.markerLabelSquare),this.groupMain.appendChild(this.markerLabel),this.groupMarkers=document.createElementNS(this.graph.ns,'g'),this.groupMain.appendChild(this.groupMarkers),this.independantMarkers=[],this.initExtended1&&this.initExtended1(),this.groupLines.addEventListener('click',()=>{this.options.selectableOnClick&&(this.isSelected()?this.graph.unselectSerie(this):this.graph.selectSerie(this))}),this.options.markers&&this.setMarkers(this.options.markers,'unselected')}setWaveform(t){if(!(t instanceof Waveform))throw'Cannot assign waveform to serie. Waveform is not of the proper Waveform instance';return this.waveform=t,this.minX=this.waveform.getXMin(),this.maxX=this.waveform.getXMax(),this.minY=this.waveform.getMin(),this.maxY=this.waveform.getMax(),this.graph.updateDataMinMaxAxes(),this.dataHasChanged(),this}setOptions(t){return this.options=extend(!0,{},SerieLine.prototype.defaults,t||{}),this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,markers:this.options.markers},this.applyLineStyles(),this}onMouseOverMarker(t,i){this.toggleMarker(i,!0,!0);this.options.onMouseOverMarker&&this.options.onMouseOverMarker(i,!!this.infos&&(this.infos[i]||!1),[this.waveform.getX(i),this.waveform.getY(i)])}onMouseOutMarker(t,i){this.markersOffHover(),this.options.onMouseOutMarker&&this.options.onMouseOutMarker(i,!!this.infos&&(this.infos[i]||!1),[this.waveform.getX(i),this.waveform.getY(i)])}toggleMarker(t,r,a){let s=t;var i;'undefined'==typeof r&&(i=a?!this.domMarkerHover[t]:!this.domMarkerSelect[t]);var n=this['domMarker'+(a?'Hover':'Select')];if(i||!0===r){if(!n[t]){var o=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(o,this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(s)]),this['domMarker'+(a?'Hover':'Select')][t]=o,this.groupMarkerSelected.appendChild(o)}else o=n[t];let i=this.getX(this.waveform.getX(s)),r=this.getY(this.waveform.getY(s));o.setAttribute('d','M '+i+' '+r+' '+this.getMarkerPath(this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(s)],1)),a&&this.markerHovered++}else if((!i||!1===r)&&(a&&this.domMarkerHover[t]&&!this.domMarkerSelect[t]||this.domMarkerSelect[t])){if(!n[t])return;this.groupMarkerSelected.removeChild(n[t]),delete n[t],a&&this.markerHovered--}return i}markersOffHover(){for(var t in this.domMarkerHover)this.toggleMarker(t.split(','),!1,!0);return this}markersOffSelect(){for(var t in this.domMarkerSelect)this.toggleMarker(t.split(','),!1,!1);return this}onClickOnMarker(t,i){var r=this.toggleMarker(i);r&&this.options.onSelectMarker&&this.options.onSelectMarker(i,!!this.infos&&(this.infos[i[0]]||!1)),!r&&this.options.onUnselectMarker&&this.options.onUnselectMarker(i,!!this.infos&&(this.infos[i[0]]||!1)),this.options.onToggleMarker&&this.options.onToggleMarker(i,!!this.infos&&(this.infos[i[0]]||!1),r)}_getMarkerIndexFromEvent(t){var i=this.graph._getXY(t);return this.searchIndexByPxXY(i.x-this.graph.getPaddingLeft(),i.y-this.graph.getPaddingTop())}onMouseWheel(){}empty(){for(var t=0,i=this.lines.length;t<i;t++)this.groupLines.removeChild(this.lines[t]);return this.lines=[],this}select(t){return t=t||'selected',this.selected='unselected'!==t,this.areMarkersShown()||this.areMarkersShown(t)?(this.selectionType=t,this.draw(!0),this.applyLineStyles()):(this.selectionType=t,this.applyLineStyles()),this.applyLineStyle(this.getSymbolForLegend()),this}unselect(){return this.selected=!1,this.select('unselected')}degrade(t){return this.degradationPx=t,this}drawInit(t){try{this.axisCheck()}catch(t){return console.warn(t),!1}if(this.currentLineId=0,this.counter=0,this._drawn=!0,this.currentLine='',!this.waveform)this._dataToUse=this.data,this._xDataToUse=this.xData;else if(this.degradationPx)this.waveform.resampleForDisplay({resampleToPx:this.degradationPx,xPosition:this.getXAxis().getPx.bind(this.getXAxis()),minX:this.getXAxis().getCurrentMin(),maxX:this.getXAxis().getCurrentMax()}),this._dataToUse=[this.waveform.getDataToUseFlat()];else if(this.waveform.hasAggregation()){let i=this.getXAxis(),r=this.graph.getDrawingWidth()*(i.getDataMax()-i.getDataMin())/(i.getCurrentMax()-i.getCurrentMin()),a=this.waveform.selectAggregatedData(r);if(a instanceof Promise)return a.then(()=>{this.draw(t)}),!1;if(!1===a)return!1;this._dataToUse=this.waveform.getDataToUseFlat()}return!0}removeLinesGroup(){this._afterLinesGroup=this.groupLines.nextSibling,this.groupMain.removeChild(this.groupLines)}insertLinesGroup(){if(!this._afterLinesGroup)throw'Could not find group after lines to insertion.';this.groupMain.insertBefore(this.groupLines,this._afterLinesGroup),this._afterLinesGroup=!1}removeExtraLines(){for(var t=this.currentLineId,i=this.lines.length;t<i;t++)this.groupLines.removeChild(this.lines[t]);this.lines.splice(this.currentLineId,i-this.currentLineId),this.currentLineId=0}draw(t){if(super.draw(...arguments),!this.getXAxis()||!this.getYAxis())throw'No axes were defined for this serie';if(t||this.hasDataChanged()){if(!this.drawInit(t))return;var r=this._dataToUse,a=this._xDataToUse,s=this._slotToUse;this.removeLinesGroup(),this.eraseMarkers(),this.lookForMaxima=!0,this.lookForMinima=!1,this.markerFamily=this.markerFamilies[this.selectionType||'unselected'],this.pos0=this.getYAxis().getPos(0),this.hasErrors()&&this.errorDrawInit(),this._draw(),this.hasErrors()&&this.errorDraw(),this.removeExtraLines(),this.insertMarkers(),this.insertLinesGroup()}for(var n in this.domMarkerHover)this.toggleMarker(n.split(','),!1,!0);for(var n in this.domMarkerSelect)this.toggleMarker(n.split(','),!1,!1);this.applyLineStyle(this.getSymbolForLegend()),this.hasStyleChanged(this.selectionType)&&this.updateStyle(),this.dataHasChanged(!1),super.afterDraw()}_draw(){let t=this,r=this.waveform,a=!1,s=!1,n=this.getXAxis(),o=this.getYAxis(),p=n.getCurrentMin(),d=o.getCurrentMin(),g=n.getCurrentMax(),c=o.getCurrentMax(),u,h,x,m,y,b,A;if(!r)return;u=r.getData(!0);let f=r.getShift(),k=r.getScale(),S=!1,M=!1,C=this.isMonotoneous(),v=this.markersShown(),P=0,i=r.getLength(),l,_,L,w,E,X,T,Y,I;for(this.currentLine='',r.isXMonotoneous()&&(r.isXMonotoneousAscending()?(P=r.getIndexFromX(p,!0)||0,i=r.getIndexFromX(g,!0),!1===i&&(i=r.getLength())):(P=r.getIndexFromX(g,!0)||0,i=r.getIndexFromX(p,!0),!1===i&&(i=r.getLength())),i+=2,i>u.length&&(i=u.length));P<i;P+=1){if(h=r.getX(P,!0),x=u[P]*k+f,h!=h||x!=x){this._createLine();continue}if(!this.options.overflowX&&h<p&&a<p||!this.options.overflowX&&h>g&&a>g||(!this.options.overflowY&&x<d&&s<d||!this.options.overflowY&&x>c&&s>c)&&!this.options.lineToZero){a=h,s=x,M=!0;continue}if(this.counter2=P,v&&this.getMarkerCurrentFamily(this.counter2),b=this.getX(h),A=this.getY(x),b!=m||A!=y){if(b!=b||A!=A){0<this.counter&&this._createLine();continue}if(S=C?!this.options.overflowY&&(x<d||x>c):!this.options.overflowX&&(h<p||h>g)||!this.options.overflowY&&(x<d||x>c),this.options.lineToZero){if(S=h<p||h>g,S)continue;}else if(S||M){!1!==a&&!1!==s||M?(I=[],l=(h-p)/(h-a),_=x-l*(x-s),L=(h-g)/(h-a),w=x-L*(x-s),E=(x-d)/(x-s),X=h-E*(h-a),T=(x-c)/(x-s),Y=h-T*(h-a),1>l&&0<l&&!1!==_&&_<c&&_>d&&I.push([p,_]),1>L&&0<L&&!1!==w&&w<c&&w>d&&I.push([g,w]),1>E&&0<E&&!1!==X&&X<g&&X>p&&I.push([X,d]),1>T&&0<T&&!1!==Y&&Y<g&&Y>p&&I.push([Y,c]),0<I.length?S?M?2==I.length&&(this._createLine(),this._addPoint(this.getX(I[0][0]),this.getY(I[0][1]),I[0][0],I[0][1],!1,!1,!1),this._addPoint(this.getX(I[1][0]),this.getY(I[1][1]),I[0][0],I[0][1],!1,!1,!1)):(1<I.length&&(console.error('Programmation error. Please e-mail me.'),console.log(I,Y,X,w,_,x,d,c,s)),this._addPoint(this.getX(I[0][0]),this.getY(I[0][1]),I[0][0],I[0][1],!1,!1,!1)):(1<I.length&&(console.error('Programmation error. Please e-mail me.'),console.log(I,Y,X,w,_,x,d,c,s)),this._createLine(),this._addPoint(this.getX(I[0][0]),this.getY(I[0][1]),I[0][0],I[0][1],!1,!1,!1),this._addPoint(b,A,a,s,!1,!1,!0)):!S&&this._addPoint(b,A,a,s,P,!1,!1)):(m=b,y=A,a=h,s=x),m=b,y=A,a=h,s=x,M=S;continue}this._addPoint(b,A,h,x,P,!1,!0),m=b,y=A,a=h,s=x}}if(this._createLine(),this._tracker){this._trackerDom&&this._trackerDom.remove();var D=this.groupLines.cloneNode(!0);for(this.groupMain.appendChild(D),P=0,i=D.children.length;P<i;P++)D.children[P].setAttribute('stroke','transparent'),D.children[P].setAttribute('stroke-width','25px'),D.children[P].setAttribute('pointer-events','stroke');this._trackerDom=D,this.groupMain.addEventListener('mousemove',(t)=>{var i=this.graph._getXY(t),r=this.handleMouseMove(!1,!1);this._trackingCallback(this,r,i.x,i.y)}),this.groupMain.addEventListener('mouseleave',()=>{this._trackingOutCallback(this)})}return this}kill(){super.kill()}getMarkerCurrentFamily(t){if(this.markerPoints&&this.markerPoints[this.selectionType]){for(var i=0,r;i<this.markerPoints[this.selectionType].length&&this.markerPoints[this.selectionType][i][0]<=t;i++)this.markerPoints[this.selectionType][i][1]>=t&&(this.markerCurrentFamily=this.markerPoints[this.selectionType][i][2],r=this.markerFamilies[this.selectionType][this.markerCurrentFamily]);return!!r&&(this.getMarkerDom(r),this.markerCurrentFamily)}}setMarkerStyleTo(t,i){if(!t||!i)throw console.trace(),'Cannot set marker style. DOM does not exist.';t.setAttribute('fill',i.fillColor||'transparent'),t.setAttribute('stroke',i.strokeColor||this.getLineColor()),t.setAttribute('stroke-width',i.strokeWidth||1)}hideTrackingMarker(){this.marker.setAttribute('display','none'),this.markerLabel.setAttribute('display','none'),this.markerLabelSquare.setAttribute('display','none')}_addPoint(t,i,r,a,s,n,o){if(t===t&&i===i)return 0==this.counter?this.currentLine='M ':this.options.lineToZero||n?this.currentLine+='M ':this.currentLine+='L ',this.currentLine+=t,this.currentLine+=' ',this.currentLine+=i,this.currentLine+=' ',this.options.lineToZero&&void 0!==this.pos0&&(this.currentLine+='L ',this.currentLine+=t,this.currentLine+=' ',this.currentLine+=this.pos0,this.currentLine+=' '),this.hasErrors()&&this.errorAddPoint(s,r,a,t,i),this.markerPoints?void(this.markersShown()&&!1!==o&&this.markerFamily&&drawMarkerXY(this,this.markerFamily[this.markerCurrentFamily],t,i,this.markersDom.get(this.markerFamily[this.markerCurrentFamily])),this.counter++):void this.counter++}_createLine(){var t=this.currentLineId++,i;return this.lines[t]?i=this.lines[t]:(i=document.createElementNS(this.graph.ns,'path'),this.applyLineStyle(i),this.groupLines.appendChild(i),this.lines[t]=i),0==this.counter?i.setAttribute('d',''):i.setAttribute('d',this.currentLine),this.currentLine='M ',this.counter=0,i}applyLineStyles(){for(var t=0;t<this.lines.length;t++)this.applyLineStyle(this.lines[t])}applyLineStyle(t){t.setAttribute('stroke',this.getLineColor()),t.setAttribute('stroke-width',this.getLineWidth()),this.getLineDashArray()?t.setAttribute('stroke-dasharray',this.getLineDashArray()):t.removeAttribute('stroke-dasharray'),t.setAttribute('fill','none')}updateStyle(){this.applyLineStyles(),this.setLegendSymbolStyle(),this.styleHasChanged(!1)}getMarkerPath(t,r){var a=t.zoom||1,r=r||0,s=[];switch(t.type){case 2:s=['m',-2,-2,'l',4,4,'m',-4,0,'l',4,-4];break;case 3:s=['m',-2,0,'l',4,0,'m',-2,-2,'l',0,4];break;case 4:s=['m',-1,-1,'l',2,0,'l',-1,2,'z'];break;default:case 1:s=['m',-2,-2,'l',4,0,'l',0,4,'l',-4,0,'z'];}if((1==a||!a)&&!r)return s.join(' ');if(s){for(var n=0,i=s.length;n<i;n++)typeof s[n]=='number'&&(s[n]*=a+r);return s.join(' ')}}getMarkerDom(t){var i=this;if(!this.markersDom.has(t)){var r=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(r,t),this.markersDom.set(t,{dom:r,path:''}),r.addEventListener('mouseover',function(t){var r=i._getMarkerIndexFromEvent(t);i.onMouseOverMarker(t,r)}),r.addEventListener('mouseout',function(t){var r=i._getMarkerIndexFromEvent(t);i.onMouseOutMarker(t,r)}),r.addEventListener('click',function(t){var r=i._getMarkerIndexFromEvent(t);i.onClickOnMarker(t,r)})}return t.dom}getMarkerDomIndependent(t,i){if(!this.independantMarkers[t]){var r=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(r,i),r.addEventListener('mouseover',(i)=>{this.onMouseOverMarker(i,t)}),r.addEventListener('mouseout',(i)=>{this.onMouseOutMarker(i,t)}),r.addEventListener('click',(i)=>{this.onClickOnMarker(i,t)}),this.independantMarkers[t]=r}return this.groupMarkers.appendChild(this.independantMarkers[t]),this.independantMarkers[t]}searchIndexByPxXY(t,i){for(var r=Math.pow,a=!1,s=!1,n=this._xDataToUse,o=0,l=this.waveform.getLength(),p,d,g;o<l;o+=1)d=this.waveform.getX(o),g=this.waveform.getY(o),p=r(this.getX(d)-t,2)+r(this.getY(g)-i,2),(!a||p<a)&&(a=p,s=o);return s}searchClosestValue(t,i){if(this.waveform){const r=this.waveform.getIndexFromXY(t,i,void 0,void 0,this.getXAxis().getRelPx(1),this.getYAxis().getRelPx(1));let a={},s;return s=t>this.waveform.getX(r)?0:1,Object.assign(a,{indexMin:r+s,indexMax:r+s+1,indexClosest:r,xMin:this.waveform.getX(r+s),xMax:this.waveform.getX(r+s+1),yMin:this.waveform.getY(r+s),yMax:this.waveform.getY(r+s+1),xClosest:this.waveform.getX(r),yClosest:this.waveform.getY(r),xExact:t}),a}}handleMouseMove(t,i,r){var a=t||this.getXAxis().getMouseVal(),s=r||this.getYAxis().getMouseVal(),n=this.searchClosestValue(a,s);if(n){var o;if(n.xMax==n.xMin&&(o=n.yMin),i&&this.options.trackMouse){if(void 0==n.xMin)return!1;if(!this.marker)return;var l=this.getX(this.getFlip()?n.yClosest:n.xClosest),p=this.getY(this.getFlip()?n.xClosest:n.yClosest);if(isNaN(l)||isNaN(p))return;switch(this.marker.setAttribute('display','block'),this.marker.setAttribute('cx',l),this.marker.setAttribute('cy',p),this.markerLabel.setAttribute('display','block'),this.markerLabelSquare.setAttribute('display','block'),this.options.trackMouseLabel){case!1:break;default:this.markerLabel.textContent=this.options.trackMouseLabel.replace('<x>',a.toFixed(this.options.trackMouseLabelRouding)).replace('<y>',o.toFixed(this.options.trackMouseLabelRouding));}this.markerLabel.setAttribute('x',l+5),this.markerLabel.setAttribute('y',p-5),this.markerLabelSquare.setAttribute('x',l+5),this.markerLabelSquare.setAttribute('y',p-5-this.graph.options.fontSize),this.markerLabelSquare.setAttribute('width',this.markerLabel.getComputedTextLength()+2),this.markerLabelSquare.setAttribute('height',this.graph.options.fontSize+2)}return{xBefore:n.xMin,xAfter:n.xMax,yBefore:n.yMin,yAfter:n.yMax,trueX:n.xExact,indexClosest:n.indexClosest,interpolatedY:o,xClosest:n.xClosest,yClosest:n.yClosest}}}getMax(t,r){var a=Math.max,s=Math.min(t,r),n=a(t,r),o=this.searchClosestValue(s),l=this.searchClosestValue(n),p=-Infinity,d,i,g,c;if(o||(s=this.minX,o=this.searchClosestValue(s)),l||(n=this.maxX,l=this.searchClosestValue(n)),!o||!l)return-Infinity;for(d=o.dataIndex;d<=l.dataIndex;d++)for(g=d==o.dataIndex?o.xBeforeIndexArr:0,c=d==l.dataIndex?l.xBeforeIndexArr:this.data[d].length,i=g;i<=c;i+=2)p=a(p,this.data[d][i+1]);return p}getMin(t,r){var a=Math.min,s=a(t,r),n=Math.max(t,r),o=this.searchClosestValue(s),l=this.searchClosestValue(n),p=Infinity,d,i,g,c;if(o||(s=this.minX,o=this.searchClosestValue(s)),l||(n=this.maxX,l=this.searchClosestValue(n)),!o||!l)return Infinity;for(d=o.dataIndex;d<=l.dataIndex;d++)for(g=d==o.dataIndex?o.xBeforeIndexArr:0,c=d==l.dataIndex?l.xBeforeIndexArr:this.data[d].length,i=g;i<=c;i+=2)p=a(p,this.data[d][i+1]);return p}setStyle(t,i='unselected'){this.styles[i]=t,this.styleHasChanged(i)}setLineStyle(t,i='unselected',r){return this.styles[i]=this.styles[i]||{},this.styles[i].lineStyle=t,r&&this.setLineStyle(t,'selected'),this.styleHasChanged(i),this}getLineStyle(t){return this.getStyle(t).lineStyle}getLineDashArray(t=this.selectionType||'unselected'){switch(this.getStyle(t).lineStyle){case 2:return'1, 1';break;case 3:return'2, 2';break;case 4:return'3, 3';break;case 5:return'4, 4';break;case 6:return'5, 5';break;case 7:return'5 2';break;case 8:return'2 5';break;case 9:return'4 2 4 4';break;case 10:return'1,3,1';break;case 11:return'9 2';break;case 12:return'2 9';break;case 1:case!1:return!1;break;default:return this.styles[t].lineStyle;}this.styleHasChanged(t)}getStyle(t=this.selectionType||'unselected'){return this.styles[t]}extendStyles(){for(var t in this.styles){var i=this.styles[t];i&&(this.styles[t]=extend(!0,{},this.styles.unselected,i))}}extendStyle(t,i){var r=this.styles[t];this.styles[t]=extend(!0,{},this.styles[i||'unselected'],r||{}),this.styles[t].markers.map(function(t){t.dom&&(t.dom='')}),this._recalculateMarkerPoints(t,this.styles[t].markers),this.styleHasChanged(t)}setLineWidth(t,i,r){return i=i||'unselected',this.styles[i]=this.styles[i]||{},this.styles[i].lineWidth=t,r&&this.setLineWidth(t,'selected'),this.styleHasChanged(i),this}getLineWidth(t){return this.getStyle(t).lineWidth||1}setLineColor(t,i,r){return i=i||'unselected',this.styles[i]=this.styles[i]||{},this.styles[i].lineColor=t,r&&this.setLineColor(t,'selected'),this.styleHasChanged(i),this}getLineColor(t){return this.getStyle(t).lineColor||'black'}showMarkers(t,i){return t=t||'unselected',this.styles[t]=this.styles[t]||{},this.styles[t].showMarkers=!0,i&&this._drawn?this.draw(!0):this.styleHasChanged(t),this}hideMarkers(t,i){return t=t||'unselected',this.styles[t].showMarkers=!1,i&&this._drawn?this.draw(!0):this.styleHasChanged(t),this}markersShown(t){return!1!==this.getStyle(t).showMarkers}areMarkersShown(){return this.markersShown.apply(this,arguments)}isMarkersShown(){return this.markersShown.apply(this,arguments)}setMarkers(t,i,r){return this.styles[i||'unselected']=this.styles[i||'unselected']||{},this.showMarkers(i,!1),Array.isArray(t)||'object'!=typeof t?!t&&(t=[{type:1,zoom:1,points:'all'}]):t=[t],this.styles[i||'unselected'].markers=t,r&&(this.styles.selected.markers=extend(!0,{},t)),this._recalculateMarkerPoints(i,t),this.styleHasChanged(i),this.dataHasChanged(!0),this}setMarkersPoints(t,i,r){this._extendMarkers('points',t,i,r,!0)}setMarkersColor(t,i,r){this._extendMarkers('color',t,i,r)}setMarkersType(t,i,r){this._extendMarkers('type',t,i,r)}setMarkersZoom(t,i,r){this._extendMarkers('zoom',t,i,r)}setMarkersStrokeColor(t,i,r){this._extendMarkers('strokeColor',t,i,r)}setMarkersStrokeWidth(t,i,r){this._extendMarkers('strokeWidth',t,i,r)}setMarkersFillColor(t,i,r){this._extendMarkers('fillColor',t,i,r)}_extendMarkers(t,i,r,a,s){(r=r||0,a=a||'unselected',this.styles[a]&&this.styles[a].markers)&&(this.styles[a].markers[r][t]=i,s&&this._recalculateMarkerPoints(a,this.styles[a].markers),this.markersDom[this.styles[a].markers[r]]&&this.setMarkerStyleTo(this.markersDom[this.styles[a].markers[r]].dom,this.styles[a].markers[r]))}_recalculateMarkerPoints(t,r){for(var a=[[0,Infinity,null]],s=0,i=r.length;s<i;s++){r[s].markerPath=this.getMarkerPath(r[s]),r[s].points||(r[s].points='all'),Array.isArray(r[s].points)||(r[s].points=[r[s].points]);for(var n=0,o=r[s].points.length;n<o;n++)'all'==r[s].points[n]?a.push([0,Infinity,s]):Array.isArray(r[s].points[n])?a.push([r[s].points[n][0],r[s].points[n][1],s]):a.push([r[s].points[n],r[s].points[n],s])}this.markerFamilies[t||'unselected']=r,a.sort(function(t,i){return t[0]-i[0]||(null==t[2]?-1:1)}),this.markerPoints[t||'unselected']=a}insertMarkers(t){if(this.markerFamilies&&this.markerFamilies[t||this.selectionType]&&!this.options.markersIndependant)for(var r=0,i=this.markerFamilies[t||this.selectionType].length;r<i;r++){if(!this.markersDom.has(this.markerFamilies[t||this.selectionType][r]))continue;let i=this.markersDom.get(this.markerFamilies[t||this.selectionType][r]);i.dom.setAttribute('d',i.path),this.groupMarkers.appendChild(i.dom),this.currentMarkersSelectionType=this.selectionType}}getMarkerForLegend(){if(this.markerPoints&&this.markerPoints[this.selectionType]){if(!this.markerForLegend){var t=document.createElementNS(this.graph.ns,'path');this.setMarkerStyleTo(t,this.markerFamilies[this.selectionType][0]),t.setAttribute('d','M 14 0 '+this.getMarkerPath(this.markerFamilies[this.selectionType][0])),this.markerForLegend=t}return this.markerForLegend}}eraseMarkers(){var t=this;if(this.options.markersIndependant){for(var r in this.independantMarkers)t.groupMarkers.removeChild(this.independantMarkers[r]);this.independantMarkers={}}else this.currentMarkersSelectionType&&(this.markersDom.forEach(function(i){i.dom&&i.dom.parentNode===t.groupMarkers&&(t.groupMarkers.removeChild(i.dom),i.path='')}),this.currentMarkersSelectionType=!1)}isMonotoneous(){return this.waveform?this.waveform.isMonotoneous():!!this.xmonotoneous}findLocalMinMax(t,i,r){return!!this.waveform&&this.waveform.findLocalMinMax(t,i,r)}}function drawMarkerXY(t,i,r,a,s){if(i){if(t.options.markersIndependant){var n=t.getMarkerDomIndependent(t.counter2,i),o='M '+r+' '+a+' ';o+=i.markerPath+' ',n.setAttribute('d',o)}s.path=s.path||'',s.path+='M '+r+' '+a+' ',s.path+=i.markerPath+' '}}mix(SerieLine,ErrorBarMixin);var Serie3DMixin={getX:function(t){return(t=this.getXAxis().getPx(t))-t%0.2+this.getXAxis().getZProj(this.options.zpos)},getY:function(t){return(t=this.getYAxis().getPx(t))-t%0.2+this.getYAxis().getZProj(this.options.zpos)},getZPos:function(){return this.options.zpos},getMinX:function(t){return t?getZCorrectedValue(this,!0,!0):this.minX},getMaxX:function(t){return t?getZCorrectedValue(this,!0,!1):this.maxX},getMinY:function(t){return t?getZCorrectedValue(this,!1,!0):this.minY},getMaxY:function(t){return t?getZCorrectedValue(this,!1,!1):this.maxY}};function getZCorrectedValue(t,r,a){let s=t.getWaveforms(),n,i,o,l,p;for(let d of s)for(n=0,i=d.getLength(),o=d.getData();n<i;n+=1)l=r?t.getXAxis().getVal(t.getX(d.getX(n,!0))):t.getYAxis().getVal(t.getY(o[n])),p=0==n?l:a?Math.min(p,l):Math.max(p,l);return p}class SerieLine3D extends SerieLine{static defaults(){return{zpos:0}}constructor(){super(...arguments)}setZPos(t){return this.options.zpos=t,this}setz(){return this.setZPos(...arguments)}}mix(SerieLine3D,Serie3DMixin);class SerieBar extends SerieLine{constructor(){super(...arguments),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.pathDom=document.createElementNS(this.graph.ns,'path'),this.groupMain.appendChild(this.pathDom),this.styles={},this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,lineWidth:this.options.lineWidth,fillColor:this.options.fillColor,fillOpacity:this.options.fillOpacity,markers:this.options.markers}}setData(t){for(var r in this.data=t,this.minY=Number.MAX_SAFE_INTEGER,this.maxY=Number.MIN_SAFE_INTEGER,this.data)this._checkY(this.data[r]);return this}setFillColor(t,i,r){return i=i||'unselected',this.styles[i]=this.styles[i]||{},this.styles[i].fillColor=t,r&&this.setFillColor(t,'selected'),this.styleHasChanged(i),this}getFillColor(t){return this.getStyle(t).fillColor}setFillOpacity(t,i,r){return i=i||'unselected',this.styles[i]=this.styles[i]||{},this.styles[i].fillOpacity=t,r&&this.setLineWidth(t,'selected'),this.styleHasChanged(i),this}getFillOpacity(t){return this.getStyle(t).fillOpacity||1}applyLineStyles(){this.applyLineStyle(this.pathDom)}applyLineStyle(t){t.setAttribute('stroke',this.getLineColor()),t.setAttribute('stroke-width',this.getLineWidth()),this.getLineDashArray()?t.setAttribute('stroke-dasharray',this.getLineDashArray()):t.removeAttribute('stroke-dasharray'),t.setAttribute('fill',this.getFillColor()),t.setAttribute('fill-opacity',this.getFillOpacity()||1)}draw(){var t='';for(var r in this.error&&this.errorDrawInit(),this.data)this.categoryIndices[r]&&(t+='M '+this.getXAxis().getPos(this.categoryIndices[r])+' '+this.getYAxis().getPos(0)+' V '+this.getYAxis().getPos(this.data[r])+' h '+this.getXAxis().getDeltaPx(1/this.nbCategories)+' V '+this.getYAxis().getPos(0),this.error&&this.errorAddPointBarChart(r,this.data[r],this.getXAxis().getPos(this.categoryIndices[r]+0.5/this.nbCategories),this.getYAxis().getPos(this.data[r])));this.error&&this.errorDraw(),this.pathDom.setAttribute('d',t),this.applyLineStyles()}setMarkers(){}getUsedCategories(){return Object.keys(this.data)}}class SerieBox extends Serie{static default(){return{orientation:'y',maxBoxWidth:20,defaultStyle:{meanLineColor:'rgb( 100, 0, 0 )',meanLineWidth:2,boxAboveLineWidth:1,boxAboveLineColor:'rgb( 0, 0, 0 )',boxAboveFillColor:'transparent',boxAboveFillOpacity:1,boxBelowLineWidth:1,boxBelowLineColor:'rgb( 0, 0, 0 )',boxBelowFillColor:'transparent',boxBelowFillOpacity:1,barAboveLineColor:'rgba( 0, 0, 0, 1 )',barAboveLineWidth:1,barBelowLineColor:'rgba( 0, 0, 0, 1 )',barBelowLineWidth:1,outlierLineWidth:1,outlierLineColor:'rgb( 255, 255, 255 )',outlierFillColor:'rgb( 0, 0, 0 )',outlierFillOpacity:1}}}constructor(){super(...arguments),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.pathDom=document.createElementNS(this.graph.ns,'path'),this.groupMain.appendChild(this.pathDom),this.styles={},this.styles.unselected=this.options.defaultStyle}setData(t,r){if(this.data=t,!Array.isArray(t))return;let a,s,n,o,l;for(var p in'y'==this.options.orientation?(a=this.getXAxis(),s=this.getYAxis(),n=this._checkX.bind(this),o=this._checkY.bind(this),l=!0,this.minY=t[0].Q2,this.maxY=t[0].Q2,this.maxX=t[0].x,this.minX=t[0].x):(a=this.getYAxis(),s=this.getXAxis(),n=this._checkY.bind(this),o=this._checkX.bind(this),l=!1,this.minX=t[0].Q2,this.maxX=t[0].Q2,this.maxY=t[0].y,this.minY=t[0].y),r&&(n=function(){},o=function(){}),a&&s||throwError('Error in setting data of the box serie. The X and Y axes must be set beforehand'),this.data)l?(n(this.data[p].x),this.data[p].pos=this.data[p].x):(n(this.data[p].y),this.data[p].pos=this.data[p].y),this.data[p].Q3&&o(this.data[p].Q3),this.data[p].Q1&&o(this.data[p].Q1),this.data[p].whiskers?Array.isArray(this.data[p].whiskers)?(0<this.data[p].whiskers.length&&o(this.data[p].whiskers[0]),1<this.data[p].whiskers.length&&o(this.data[p].whiskers[1])):(o(this.data[p].whiskers),this.data[p].whiskers=[this.data[p].whiskers]):this.data[p].whiskers=[],Array.isArray(this.data[p].outliers)?this.data[p].outliers.map((t)=>o(t)):this.data[p].outliers=[];return this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this}_style(t,i,r='unselected',a=!1){return this.styles[r]=this.styles[r]||{},this.styles[r][t]=i,a&&this._set(t,i,'selected'),this.styleHasChanged(r),this}_gstyle(t,i){return this.getStyle(i)[t]}getStyle(t='unselected'){return this.styles[t]||{}}setMeanLineColor(){return this._style('meanLineColor',...arguments)}getMeanLineColor(){return this._gstyle('meanLineColor',...arguments)}setStyle(t,i='unselected'){this.styles[i]=extend({},defaults.defaultStyle,this.styles.unselected,t),this.styleHasChanged(i)}setMeanLineWidth(){return this._style('meanLineWidth',...arguments)}getMeanLineWidth(){return this._gstyle('meanLineWidth',...arguments)}setBoxAboveLineColor(){return this._style('boxAboveLineColor',...arguments)}getBoxAboveLineColor(){return this._gstyle('boxAboveLineColor',...arguments)}setBoxBelowLineColor(){return this._style('boxBelowLineColor',...arguments)}getBoxBelowLineColor(){return this._gstyle('boxBelowLineColor',...arguments)}setBoxAboveLineWidth(){return this._style('boxAboveLineWidth',...arguments)}getBoxAboveLineWidth(){return this._gstyle('boxAboveLineWidth',...arguments)}setBoxBelowLineWidth(){return this._style('boxBelowLineWidth',...arguments)}getBoxBelowLineWidth(){return this._gstyle('boxBelowLineWidth',...arguments)}setBoxAboveFillColor(){return this._style('boxAboveFillColor',...arguments)}getBoxAboveFillColor(){return this._gstyle('boxAboveFillColor',...arguments)}setBoxBelowFillColor(){return this._style('boxBelowFillColor',...arguments)}getBoxBelowFillColor(){return this._gstyle('boxBelowFillColor',...arguments)}setBoxAboveFillOpacity(){return this._style('boxAboveFillOpacity',...arguments)}getBoxAboveFillOpacity(){return this._gstyle('boxAboveFillOpacity',...arguments)}setBoxBelowFillOpacity(){return this._style('boxBelowFillOpacity',...arguments)}getBoxBelowFillOpacity(){return this._gstyle('boxBelowFillOpacity',...arguments)}setBarAboveLineColor(){return this._style('barAboveLineColor',...arguments)}getBarAboveLineColor(){return this._gstyle('barAboveLineColor',...arguments)}setBarBelowLineColor(){return this._style('barBelowLineColor',...arguments)}getBarBelowLineColor(){return this._gstyle('barBelowLineColor',...arguments)}setBarAboveLineWidth(){return this._style('barAboveLineWidth',...arguments)}getBarAboveLineWidth(){return this._gstyle('barAboveLineWidth',...arguments)}setBarBelowLineWidth(){return this._style('barBelowLineWidth',...arguments)}getBarBelowLineWidth(){return this._gstyle('barBelowLineWidth',...arguments)}setOutlierLineColor(){return this._style('outlierLineColor',...arguments)}getOutlierLineColor(){return this._gstyle('outlierLineColor',...arguments)}setOutlierLineWidth(){return this._style('outlierLineWidth',...arguments)}getOutlierLineWidth(){return this._gstyle('outlierLineWidth',...arguments)}setOutlierFillColor(){return this._style('outlierFillColor',...arguments)}getOutlierFillColor(){return this._gstyle('outlierFillColor',...arguments)}setOutlierFillOpacity(){return this._style('outlierFillOpacity',...arguments)}getOutlierFillOpacity(){return this._gstyle('outlierFillOpacity',...arguments)}applyLineStyles(){this.applyLineStyle(this.pathDom)}applyLineStyle(t){t.setAttribute('stroke',this.getLineColor()),t.setAttribute('stroke-width',this.getLineWidth()),t.removeAttribute('stroke-dasharray'),t.setAttribute('fill',this.getFillColor()),t.setAttribute('fill-opacity',this.getFillOpacity()||1)}draw(){if(!this.data)return;let t='y'==this.options.orientation?this.getYAxis():this.getXAxis(),r='y'==this.options.orientation?this.getXAxis():this.getYAxis(),a,s,n,o,p,d,g,c;if(emptyDom(this.groupMain),'category'==r.getType())s=r.getRelPx(0.8/this.nbCategories);else{s=this.options.maxBoxWidth;for(var u=0,i=this.data.length;u<i-1;u++)s=Math.min(s,Math.abs(r.getPx(this.data[u+1].pos)-r.getPx(this.data[u].pos)))}for(var u=0,i=this.data.length;u<i;u++){if('category'==r.getType()){let i='y'==this.options.orientation?this.data[u].x:this.data[u].y;if(!!this.categoryIndices.hasOwnProperty(i))a=[r.getPos(this.categoryIndices[i])+1.2*s/2];else if(Array.isArray(this._linkedToScatterSeries))for(let n of this._linkedToScatterSeries)if(n.categoryIndices.hasOwnProperty(i)){a=[r.getPos(n.categoryIndices[i])+1.2*s/2],t='y'==this.options.orientation?n.getYAxis():n.getXAxis();break}}else a=[r.getPos('y'==this.options.orientation?this.data[u].x:this.data[u].y),s];n=t.getPos(this.data[u].Q2),o=t.getPos(this.data[u].Q3),p=t.getPos(this.data[u].Q1),this.data[u].whiskers.map((i)=>{i<this.data[u].Q1?g=t.getPos(i):d=t.getPos(i)}),c=this.data[u].outliers.map((i)=>t.getPos(i));var l=document.createElementNS(this.graph.ns,'line');this.applyMeanStyle(l);var h=document.createElementNS(this.graph.ns,'rect'),x=document.createElementNS(this.graph.ns,'rect');'y'==this.options.orientation?(h.setAttribute('width',s),h.setAttribute('x',a[0]-s/2),x.setAttribute('width',s),x.setAttribute('x',a[0]-s/2),l.setAttribute('x1',a[0]-s/2),l.setAttribute('x2',a[0]+s/2),l.setAttribute('y1',n),l.setAttribute('y2',n)):(h.setAttribute('height',s),h.setAttribute('y',a[0]-s/2),x.setAttribute('height',s),x.setAttribute('y',a[0]-s/2),l.setAttribute('y1',a[0]-s/2),l.setAttribute('y2',a[0]+s/2),l.setAttribute('x1',n),l.setAttribute('x2',n)),this.boxPos(h,n,o,'x'==this.options.orientation),this.boxPos(x,n,p,'x'==this.options.orientation),this.applyBoxStyle(h,x);var m=document.createElementNS(this.graph.ns,'line'),y=document.createElementNS(this.graph.ns,'line');'y'==this.options.orientation?(void 0!==d&&(m.setAttribute('y1',o),m.setAttribute('y2',d),m.setAttribute('x1',a[0]),m.setAttribute('x2',a[0])),void 0!==g&&(y.setAttribute('y1',p),y.setAttribute('y2',g),y.setAttribute('x1',a[0]),y.setAttribute('x2',a[0]))):(void 0!==d&&(m.setAttribute('x1',o),m.setAttribute('x2',d),m.setAttribute('y1',a[0]),m.setAttribute('y2',a[0])),void 0!==g&&(y.setAttribute('x1',p),y.setAttribute('x2',g),y.setAttribute('y1',a[0]),y.setAttribute('y2',a[0]))),c.map((t)=>{let i=document.createElementNS(this.graph.ns,'circle');i.setAttribute('r',2),'y'==this.options.orientation?(i.setAttribute('cx',a[0]),i.setAttribute('cy',t)):(i.setAttribute('cy',a[0]),i.setAttribute('cx',t)),this.setOutlierStyle(i),this.groupMain.appendChild(i)}),void 0!==d&&this.groupMain.appendChild(m),void 0!==g&&this.groupMain.appendChild(y),void 0!==o&&this.groupMain.appendChild(h),void 0!==p&&this.groupMain.appendChild(x),this.groupMain.appendChild(l),this.applyWhiskerStyle(m,y)}}applyBoxStyle(t,i){t.setAttribute('stroke',this.getBoxAboveLineColor()),t.setAttribute('stroke-width',this.getBoxAboveLineWidth()),this.getBoxAboveFillColor()!==void 0&&t.setAttribute('fill',this.getBoxAboveFillColor()),this.getBoxAboveFillOpacity()!==void 0&&t.setAttribute('fill-opacity',this.getBoxAboveFillOpacity()),i.setAttribute('stroke',this.getBoxBelowLineColor()),i.setAttribute('stroke-width',this.getBoxBelowLineWidth()),this.getBoxBelowFillColor()!==void 0&&i.setAttribute('fill',this.getBoxBelowFillColor()),this.getBoxAboveFillOpacity()!==void 0&&i.setAttribute('fill-opacity',this.getBoxBelowFillOpacity())}applyWhiskerStyle(t,i){t.setAttribute('stroke',this.getBarAboveLineColor()),t.setAttribute('stroke-width',this.getBarAboveLineWidth()),i.setAttribute('stroke',this.getBarBelowLineColor()),i.setAttribute('stroke-width',this.getBarBelowLineWidth())}applyMeanStyle(t){t.setAttribute('stroke',this.getMeanLineColor()),t.setAttribute('stroke-width',this.getMeanLineWidth())}setOutlierStyle(t){t.setAttribute('stroke',this.getOutlierLineColor()),t.setAttribute('stroke-width',this.getOutlierLineWidth()),this.getBoxBelowFillColor()!==void 0&&t.setAttribute('fill',this.getOutlierFillColor()),this.getBoxAboveFillOpacity()!==void 0&&t.setAttribute('fill-opacity',this.getOutlierFillOpacity())}getCategoryIndex(t){if(!this.categories)throw new Error('No categories were defined. Probably axis.setSeries was not called');for(var r=0;r<this.categories.length;r++)if(this.categories[r].name==t)return r;return!1}setMarkers(){}boxPos(t,i,r,a){i>r?(t.setAttribute(a?'x':'y',r),t.setAttribute(a?'width':'height',i-r)):(t.setAttribute(a?'x':'y',i),t.setAttribute(a?'width':'height',r-i))}getUsedCategories(){let t='y'==this.options.orientation?'x':'y',i=this.data.map((i)=>i[t]);return Array.isArray(this._linkedToScatterSeries)&&this._linkedToScatterSeries.map((t)=>{t.getUsedCategories().map((t)=>{let r;-1<(r=i.indexOf(t))&&i.splice(r,1)})}),i}linkToScatterSerie(...t){this._linkedToScatterSeries=t}}class SerieLineColor extends SerieLine{constructor(){super(...arguments),this.lines=this.lines||{}}setColors(t){this.colors=t}_draw(){var t=this,r=this._dataToUse,a=0,i=!1,s=!1,n=this.getXAxis(),o=this.getYAxis(),p=n.getCurrentMin(),d=o.getCurrentMin(),g=n.getCurrentMax(),c=o.getCurrentMax(),u,h,b,m,x,h,y,A,f,k;for(this.eraseLines(),this.isFlipped(),this.currentLine='',b=this.waveform.getLength(),u=0;u<b;u+=2){if(m=this.waveform.getX(u),x=this.waveform.getY(u),m<p&&i<p||m>g&&i>g||(x<d&&s<d||x>c&&s>c)&&!this.options.lineToZero){i=m,s=x;continue}if(this.counter2=u,this.markersShown()&&this.getMarkerCurrentFamily(this.counter2),f=this.getX(m),k=this.getY(x),f!=y||k!=A){if(isNaN(f)||isNaN(k)){0<this.counter;continue}var S=this.colors[u];this._addPoint(f,k,m,x,y,A,i,s,u,S,!1,!0),y=f,A=k,i=m,s=x}}if(this.latchLines(),this._tracker){this._trackerDom&&this._trackerDom.remove();var M=this.groupLines.cloneNode(!0);this.groupMain.appendChild(M);for(var a=0,C=M.children.length;a<C;a++)M.children[a].setAttribute('stroke','transparent'),M.children[a].setAttribute('stroke-width','25px'),M.children[a].setAttribute('pointer-events','stroke');t._trackerDom=M,t.groupMain.addEventListener('mousemove',function(i){var r=t.graph._getXY(i),a=t.handleMouseMove(!1,!1);t._trackingCallback(t,a,r.x,r.y)}),t.groupMain.addEventListener('mouseleave',function(){t._trackingOutCallback(t)})}return this}_addPoint(t,i,r,a,s,n,o,l,p,d){if(void 0!==s&&void 0!==n&&!(isNaN(t)||isNaN(i))){d._rgb&&(d='rgba('+d._rgb[0]+','+d._rgb[1]+','+d._rgb[2]+','+(d._rgb[3]||1)+')');var g=this.lines[d];g||(g=this.lines[d]={object:document.createElementNS(this.graph.ns,'path'),path:'',color:d},g.object.setAttribute('stroke',d),g.color=d,this.groupLines.appendChild(g.object)),g.path+='M '+s+' '+n+' L '+t+' '+i,this.hasErrors()&&this.errorAddPoint(p,r,a,t,i)}}removeExtraLines(){}latchLines(){for(var t in this.lines)this.lines[t].object.setAttribute('d',this.lines[t].path)}eraseLines(){for(var t in this.lines)this.lines[t].path='',this.lines[t].object.setAttribute('d','')}applyLineStyle(t){t.setAttribute('stroke-width',this.getLineWidth()),this.getLineDashArray()?t.setAttribute('stroke-dasharray',this.getLineDashArray()):t.removeAttribute('stroke-dasharray'),t.setAttribute('fill','none')}}var type='scatter';class SerieScatter extends Serie{constructor(){var t=Number.MIN_VALUE,i=Number.MAX_VALUE;super(...arguments),this.id=Math.random()+Date.now(),this.shapes=[],this.shown=!0,this.data=[],this.shapesDetails=[],this.shapes=[],this._type=type,mapEventEmission(this.options,this),this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupPoints=document.createElementNS(this.graph.ns,'g'),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.additionalData={},this.selectedStyleGeneral={},this.selectedStyleModifiers={},this.groupPoints.addEventListener('mouseover',(t)=>{var i=parseInt(t.target.parentElement.getAttribute('data-shapeid'));this.emit('mouseover',i,this.waveform.getX(i),this.waveform.getY(i))}),this.groupPoints.addEventListener('mouseout',(t)=>{var i=parseInt(t.target.parentElement.getAttribute('data-shapeid'));this.emit('mouseout',i,this.waveform.getX(i),this.waveform.getY(i))}),this.minX=i,this.minY=i,this.maxX=t,this.maxY=t,this.groupMain.appendChild(this.groupPoints),this.currentAction=!1,this.initExtended1&&this.initExtended1(),this.styles={},this.styles.unselected={},this.styles.selected={},this.styles.unselected.default={shape:'circle',cx:0,cy:0,r:3,stroke:'transparent',fill:'black'},this.styles.selected.default={shape:'circle',cx:0,cy:0,r:4,stroke:'transparent',fill:'black'}}setDataCategory(t){for(let i of t)this._checkY(i.y.getMaxY()),this._checkY(i.y.getMinY());return this.data=t,this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this}empty(){for(;this.groupPoints.firstChild;)this.groupPoints.removeChild(this.groupPoints.firstChild)}getSymbolForLegend(){if(this.symbol)return this.symbol;var t=document.createElementNS(this.graph.ns,'g');t.setAttribute('data-shapeid',-1);var r=this.doShape(t,this.styles.unselected.default),a=this.getStyle('unselected',-1,!0);for(var s in a[-1])'shape'!=s&&r.setAttribute(s,a[-1][s]);return t}setStyle(t,i,r='unselected'){return'string'==typeof i&&(r=i,i=!1),this.styles[r]=this.styles[r]||{},this.styles[r].all=t,this.styles[r].modifiers=i,this.styleHasChanged(r),this}draw(t){if(t||this.hasDataChanged()||this.hasStyleChanged('unselected')){var i=0,r='category'==this.getXAxis().getType(),a,s;this._drawn=!0,this.dataHasChanged(!1),this.styleHasChanged(!1),this.groupMain.removeChild(this.groupPoints);var o=[];if(i=0,this.hasErrors()&&this.errorDrawInit(),r){for(let t=0;i<this.data.length;i++)if(this.categoryIndices.hasOwnProperty(this.data[i].x)){this.error;for(var p=0,n=this.data[i].y.getLength();p<n;p++)s=this.getY(this.data[i].y.getY(p)),a=this.getX(p/(n-1)*(0.8/this.nbCategories)+this.categoryIndices[this.data[i].x]+0.1/this.nbCategories),p++,this.shapesDetails[t]=this.shapesDetails[t]||[],this.shapesDetails[t][0]=a,this.shapesDetails[t][1]=s,o.push(t),t++}}else for(;i<this.waveform.getLength();i++){if(this.waveform.getX(i)<this.getXAxis().getCurrentMin()||this.waveform.getX(i)>this.getXAxis().getCurrentMax()||this.waveform.getY(i)<this.getYAxis().getCurrentMin()||this.waveform.getY(i)>this.getYAxis().getCurrentMax()){this.shapes[i]&&this.shapes[i].setAttribute('display','none');continue}this.shapes[i]&&this.shapes[i].setAttribute('display','initial'),a=this.getX(this.waveform.getX(i)),s=this.getY(this.waveform.getY(i)),this.hasErrors()&&this.errorAddPoint(i,this.waveform.getX(i),this.waveform.getY(i),a,s),this.shapesDetails[i]=this.shapesDetails[i]||[],this.shapesDetails[i][0]=a,this.shapesDetails[i][1]=s,o.push(i)}this.hasErrors()&&this.errorDraw(),this.applyStyle('unselected',o),this.groupMain.appendChild(this.groupPoints)}}_addPoint(t,i,r){var a=document.createElementNS(this.graph.ns,'g');a.setAttribute('transform','translate('+t+', '+i+')'),a.setAttribute('data-shapeid',r),shape=this.extraStyle&&this.extraStyle[r]?this.doShape(a,this.extraStyle[r]):this.stdStylePerso?this.doShape(a,this.stdStylePerso):this.doShape(a,this.stdStyle),this.shapes[r]=shape,this.groupPoints.appendChild(a)}doShape(t,i){var r=document.createElementNS(this.graph.ns,i.shape);return t.appendChild(r),r}getStyle(t,r,a){var t=t||'unselected',s={},n;'number'==typeof r?n=[r]:Array.isArray(r)&&(n=r);var o,r,p,d,c;this.styles[t].all!==void 0&&(c=this.styles[t].all,'function'==typeof c?c=c():!1===c&&(c={}));for(var u=0,i=n.length;u<i;u++){if(r=n[u],o=this.shapes[r],(p=this.styles[t].modifiers)&&('function'==typeof p||p[r])?('function'==typeof p?d=p(r,o):p[r]&&(d=p[r]),s[r]=Object.assign({},c,d)):void 0===c?s[r]=this.styles[t].default:s[r]=c,s[r]||(s[r]=c),!o){if(!s[r].shape)throw console.error(d),'No shape was defined with this style.';var l=document.createElementNS(this.graph.ns,'g');l.setAttribute('data-shapeid',r),this.shapes[r]=this.doShape(l,s[r]),this.groupPoints.appendChild(l),o=this.shapes[r]}a||o.parentNode.setAttribute('transform','translate('+this.shapesDetails[r][0]+', '+this.shapesDetails[r][1]+')')}return s}applyStyle(t,r,a){var s=this.getStyle(t,r,a),n,i;for(n in s)for(i in s[n])'shape'!==i&&(s[n][i]?this.shapes[n].setAttribute(i,s[n][i]):this.shapes[n].removeAttribute(i))}unselectPoint(t){this.selectPoint(t,!1)}selectPoint(t,r,a){if(!(this.shapesDetails[t][2]&&this.shapesDetails[t][2]==a)){if('string'==typeof r&&(a=r,r=void 0),Array.isArray(t))return this.selectPoints(t);if(this.shapes[t]&&this.shapesDetails[t])if((this.shapesDetails[t][2]||!1===r)&&!0!==r){var s=this.shapesDetails[t][2];this.shapesDetails[t][2]=!1;var n=this.getStyle(s,t,!0);for(var o in n[t])this.shapes[t].removeAttribute(o);this.applyStyle('unselected',t,!0)}else a=a||'selected',this.shapesDetails[t][2]=a,this.applyStyle(a,t,!0)}}getUsedCategories(){return'object'==typeof this.data[0]?this.data.map((t)=>t.x):[]}}mix(SerieScatter,ErrorBarMixin);class SerieZone extends Serie{static default(){return{fillColor:'rgba( 0, 0, 0, 0.1 )',lineColor:'rgba( 0, 0, 0, 1 )',lineWidth:'1px'}}constructor(){super(...arguments),this.selectionType='unselected',this.id=guid(),this.groupZones=document.createElementNS(this.graph.ns,'g'),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.lineZone=document.createElementNS(this.graph.ns,'path'),this.lineZone.setAttribute('stroke','black'),this.lineZone.setAttribute('stroke-width','1px'),this.groupMain.appendChild(this.groupZones),this.groupZones.appendChild(this.lineZone),this.applyLineStyle(this.lineZone),this.styleHasChanged(),this.clip=document.createElementNS(this.graph.ns,'clipPath'),this.clipId=guid(),this.clip.setAttribute('id',this.clipId),this.graph.defs.appendChild(this.clip)}setWaveform(...t){var i=Math.max,r=Math.min;return this.waveforms=t,this.waveforms=this.waveforms.map((t)=>t instanceof Waveform?t:new Waveform(t)),this.minX=this.waveforms[0].getXMin(),this.maxX=this.waveforms[0].getXMax(),this.minY=this.waveforms[0].getMin(),this.maxY=this.waveforms[0].getMax(),this.waveforms.map((t)=>{this.minX=r(t.getXMin(),this.minX),this.maxX=i(t.getXMin(),this.maxX),this.minY=r(t.getMin(),this.minY),this.maxY=i(t.getMax(),this.maxY)}),this.graph.updateDataMinMaxAxes(),this.dataHasChanged(),this}setWaveforms(){return this.setWaveform(...arguments)}getWaveforms(){return this.waveforms}setMinMaxWaveforms(t,i){return this.waveforms=[t,i.reverse()],this}empty(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild)}draw(t){if(t||this.hasDataChanged()){if(!this.waveforms)return;let t=0,i=0,r=0,a=0,s=0,n='',o=!1,l;const p=this.getXAxis().getMinPx(),d=this.getXAxis().getMaxPx(),g=this.getYAxis().getMinPx(),c=this.getYAxis().getMaxPx(),u=this.getXAxis().getCurrentMin(),h=this.getXAxis().getCurrentMax(),x=this.getYAxis().getCurrentMin(),m=this.getYAxis().getCurrentMax();this.groupMain.removeChild(this.groupZones);for(let p of this.waveforms)for(s=0;s<p.getLength();s+=1)if(t=p.getX(s,!0),i=p.getY(s,!0),i[s]<x?a=this.getY(x):i[s]>m&&(a=this.getY(m)),t===t){if(i!==i){if(0==n.length)continue;n+='L '+r+', '+this.getY(p.getMinY()),o=!0;continue}if(a=this.getY(i),r=this.getX(t),t<u||t>h){l=[t,i[s],r,a];continue}o&&(n+=' M '+r+', '+this.getY(p.getMinY())+' ',o=!1),0<n.length&&(n+=' L '),l?(n+=l[2]+','+l[3]+' ',l=!1):n+=r+','+a+' '}''==n?this.lineZone.setAttribute('d',''):this.lineZone.setAttribute('d','M '+n+' z'),this.groupMain.appendChild(this.groupZones)}this.hasStyleChanged(this.selectionType)&&(this.applyLineStyle(this.lineZone),this.styleHasChanged(!1))}applyLineStyle(t){t.setAttribute('stroke',this.getLineColor()),t.setAttribute('stroke-width',this.getLineWidth()),t.setAttribute('fill',this.getFillColor()),t.setAttribute('fill-opacity',this.getFillOpacity()),t.setAttribute('stroke-opacity',this.getLineOpacity())}setLineWidth(t){return this.options.lineWidth=t,this.styleHasChanged(),this}getLineWidth(){return this.options.lineWidth}setLineOpacity(t){return this.options.lineOpacity=t,this.styleHasChanged(),this}getLineOpacity(){return this.options.lineOpacity}setLineColor(t){return this.options.lineColor=t,this.styleHasChanged(),this}getLineColor(){return this.options.lineColor}setFillOpacity(t){return this.options.fillOpacity=t,this.styleHasChanged(),this}getFillOpacity(){return this.options.fillOpacity}setFillColor(t){return this.options.fillColor=t,this.styleHasChanged(),this}getFillColor(){return this.options.fillColor}}class SerieZone3D extends SerieZone{static default(){return{zpos:0}}constructor(){super(...arguments)}setZPos(t){return this.options.zpos=t,this}setz(){return this.setZPos(...arguments)}}mix(SerieZone3D,Serie3DMixin);class SerieDensityMap extends Serie{constructor(){super(...arguments),mapEventEmission(this.options,this),this.groupMain=document.createElementNS(this.graph.ns,'g'),this.rects=[],this.paths=[],this.recalculateBinsOnDraw=!1}setData(t){var r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;this.minX=this.maxX=this.minY=this.maxY=0;var s=0,i=t.length;for(this.data=t,this.minX=r,this.minY=r,this.maxX=a,this.maxY=a,s=0;s<i;s++)this._checkX(t[s][0]),this._checkY(t[s][1]);return this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this}calculateDensity(t,r,a,s,n,o){var p=[],d=this.data.length,l=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,c,i,u;for(c=0;c<d;c++)(i=~~((this.data[c][0]-t)/r),u=~~((this.data[c][1]-s)/n),!(i>a||u>o||0>i||0>u))&&(p[i]=p[i]||[],p[i][u]=p[i][u]+1||1,l=p[i][u]<l?p[i][u]:l,g=p[i][u]>g?p[i][u]:g);return this.maxIndexX=a,this.maxIndexY=o,this.binMin=l,this.binMax=g,this.deltaX=r,this.deltaY=n,this.fromX=t,this.fromY=s,this.numX=a,this.numY=o,this.densitymap=p,p}setDensityMap(t,r,a,s,n,o){var p=this.data.length,l=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,g,i;for(g=0;g<t.length;g++)for(i=0;i<t[g].length;i++)l=t[g][i]<l?t[g][i]:l,d=t[g][i]>d?t[g][i]:d;return this.maxIndexX=t.length,this.maxIndexY=t[0].length,this.binMin=l,this.binMax=d,this.deltaX=a,this.deltaY=o,this.fromX=r,this.fromY=n,this.numX=maxIndexX,this.numY=maxIndexY,this.densitymap=t,t}calculateDensityWeighted(t,r,a,s,n,o){var p=Math.floor,d=[],g=this.data.length,l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u,i,h,x,m,y,b,A,f,k,S;for(u=0;u<g;u++)(y=(this.data[u][0]-t)/r-0.5,b=(this.data[u][1]-s)/n-0.5,i=p(y),h=p(b),A=i,k=h,f=i+1,S=h+1,x=1-(y-i),m=1-(b-h),!(i>a||h>o||0>i||0>h))&&(d[A]=d[A]||[],d[f]=d[f]||[],d[A][k]=d[A][k]||0,d[f][k]=d[f][k]||0,d[A][S]=d[A][S]||0,d[f][S]=d[f][S]||0,d[A][k]+=x*m,d[f][k]+=(1-x)*m,d[A][S]+=x*(1-m),d[f][S]+=(1-x)*(1-m),l=d[A][k]<l?d[A][k]:l,c=d[A][k]>c?d[A][k]:c,l=d[f][k]<l?d[f][k]:l,c=d[f][k]>c?d[f][k]:c,l=d[A][S]<l?d[A][S]:l,c=d[A][S]>c?d[A][S]:c,l=d[f][S]<l?d[f][S]:l,c=d[f][S]>c?d[f][S]:c);return this.maxIndexX=a,this.maxIndexY=o,this.binMin=l,this.binMax=c,this.deltaX=r,this.deltaY=n,this.fromX=t,this.fromY=s,this.numX=a,this.numY=o,this.densitymap=d,d}autoBins(t,i){return this.numX=t||400,this.numY=i||this.numX,this.calculateDensity(this.minX,(this.maxX-this.minX)/t,t,this.minY,(this.maxY-this.minY)/i,i),this.recalculateBinsOnDraw=!1,this}setPxPerBin(t,i,r){return t&&this.calculationDensityMap({from:'min',to:'max',pxPerBin:t,weighted:r}),i&&this.calculationDensityMap(!1,{from:'min',to:'max',pxPerBin:i,weighted:r}),this}setBinsFromTo(t,i,r,a){return this.densityMapCalculation=this.densityMapCalculation||{},this.densityMapCalculation[t]={from:i,to:r,numBins:a},this.calculationDensityMap(),this}calculationDensityMap(t,i){this.method=this.calculateDensityAdvanced,this.densityMapCalculation=this.densityMapCalculation||{},t&&(this.densityMapCalculation.x=t),i&&(this.densityMapCalculation.y=i)}calculateDensityAdvanced(){var t=Math.abs,r={x:{from:0,num:0,delta:0,weighing:!1},y:{from:0,num:0,delta:0,weighing:!1}},a={x:this.graph.drawingSpaceWidth,y:this.graph.drawingSpaceHeight},s={x:this.getXAxis,y:this.getYAxis},n=!1;for(var o in this.densityMapCalculation)if(this.densityMapCalculation[o].weighted&&(n=!0,r[o].weighing=!0),this.densityMapCalculation[o].pxPerBin){var i='min'==this.densityMapCalculation[o].from?s[o].call(this).getCurrentMin():this.densityMapCalculation[o].from,l='max'==this.densityMapCalculation[o].to?s[o].call(this).getCurrentMax():this.densityMapCalculation[o].to,p=t(s[o].call(this).getRelPx(l-i));r[o].num=Math.ceil(a[o]/this.densityMapCalculation[o].pxPerBin),r[o].from=i-t(s[o].call(this).getRelVal((r[o].num*this.densityMapCalculation[o].pxPerBin-p)/2)),r[o].delta=t(s[o].call(this).getRelVal(this.densityMapCalculation[o].pxPerBin))}else r[o].num=this.densityMapCalculation[o].numBins||400,r[o].from='min'==this.densityMapCalculation[o].from?s[o].call(this).getCurrentMin():this.densityMapCalculation[o].from,r[o].delta=this.densityMapCalculation[o].to?(('max'==this.densityMapCalculation[o].to?s[o].call(this).getCurrentMax():this.densityMapCalculation[o].to)-r[o].from)/r[o].num:this.densityMapCalculate[o].delta;(n?this.calculateDensityWeighted:this.calculateDensity).call(this,r.x.from,r.x.delta,r.x.num,r.y.from,r.y.delta,r.y.num)}setColorMapBinBoundaries(t,i){return this.colorMapMin=t,this.colorMapMax=i,this}autoColorMapBinBoundaries(){return this.colorMapMin=this.binMin,this.colorMapMax=this.binMax,this}onRedrawColorMapBinBoundaries(t){return this.callbackColorMapMinMax=t,this}colorMapHSL(t,r,a){var s=Math.log,n=Math.round;a=a||'linear';for(var o={exp:function(t){return(Math.exp(1*(t/r))-1)/(2.718281828459045-1)},log:function(t){return(s(t+1)-0)/(s(r+1)-0)},linear:function(t){return(t-0)/(r-0)}},l=0,p=[],d=[],g={h:null,s:null,l:null,a:null},c=t.length-1,u=0,i,h;u<=r;u++){for(var x in i=o[a](u),h=Math.floor(i*c),h==t.length-1&&(h=c-1),i=(i-h/c)/(1/c),g)g[x]=(t[h+1][x]-t[h][x])*i+t[h][x];p[l]='hsl('+g.h+', '+n(100*g.s)+'%, '+n(100*g.l)+'%)',d[l]=g.a,l++}return this.opacities=d,this.colorMap=p,this.colorMapNum=r,this}autoColorMapHSL(t,i='linear'){return this.colorMapHSV(t,100,i),this}getColorIndex(t){return Math.max(0,Math.min(this.colorMapNum,Math.floor((t-this.colorMapMin)/(this.colorMapMax-this.colorMapMin)*this.colorMapNum)))}draw(){var t;if(this.method&&this.method(),!this.callbackColorMapMinMax||void 0==this.colorMapMin||void 0==this.colorMapMax||'auto'==this.callbackColorMapMinMax)this.autoColorMapBinBoundaries();else{var r=this.callbackColorMapMinMax(this.binMin,this.binMax);this.setColorMapBinBoundaries(r[0],r[1])}for(var a=this.getXAxis().getRelPx(this.deltaX),s=this.getYAxis().getRelPx(this.deltaY),n=0;n<this.paths.length;n++)this.paths[n]='';for(var n=0;n<this.maxIndexX;n++)for(var i=0;i<this.maxIndexY;i++)void 0!=this.densitymap[n]&&void 0!=this.densitymap[n][i]&&(t=this.getColorIndex(this.densitymap[n][i]),this.paths[t]||(this.paths[t]=''),this.paths[t]+=' M '+this.getXAxis().getPx(n*this.deltaX+this.fromX)+' '+this.getYAxis().getPx(i*this.deltaY+this.fromY)+' h '+a+' v '+s+' h -'+a+' z');this.drawRects()}drawRects(){for(var t=0;t<this.paths.length;t++)this.rects[t]||(this.rects[t]=document.createElementNS(this.graph.ns,'path'),this.rects[t].setAttribute('shape-rendering','crispEdges')),void 0!==this.paths[t]&&(this.rects[t].setAttribute('d',this.paths[t]),this.rects[t].setAttribute('fill',this.colorMap[t]),this.rects[t].setAttribute('fill-opacity',this.opacities[t])),this.groupMain.appendChild(this.rects[t])}setOptions(t){return this.options=extend(!0,{},defaults,t||{}),this}}class SerieContour extends SerieLine{constructor(t){super(...arguments),this.negativeDelta=0,this.positiveDelta=0,this.negativeThreshold=0,this.positiveThreshold=0,this.groupMain.setAttribute('clip-path','url(#_clipplot'+t._creation+')')}setData(t,r,a){var r=r||'2D',a=a||'float',s=t.length,n=[],o,i,l,p;for(t instanceof Array||'object'!=typeof t||(this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,t=t.segments,s=t.length),o=0;o<s;o++){for(l=t[o].lines.length,p=this._addData(a,l),i=0;i<l;i+=2)p[i]=t[o].lines[i],this._checkX(p[i]),p[i+1]=t[o].lines[i+1],this._checkY(p[i+1]);n.push({lines:p,zValue:t[o].zValue})}return this.data=n,this.graph.updateDataMinMaxAxes(),this.dataHasChanged(!0),this}draw(t){if(t||this.hasDataChanged()){this.currentLine=0;var r=0,i=this.data.length,a=0,s,n,o,l,p,d,g;this.minZ=Infinity,this.maxZ=-Infinity;var c=this.groupLines.nextSibling;this.groupMain.removeChild(this.groupLines),this.zValues={};var u=0,h=1;this.getFlip()&&(u=0,h=1);var x=this.getYAxis().getCurrentMin(),m=this.getXAxis().getCurrentMin(),y=this.getXAxis().getCurrentMax(),b=this.getYAxis().getCurrentMax();for(this.counter=0,this.currentLineId=0;r<i;r++){for(this.currentLine='',a=0,(g=this.data[r].lines,p=g.length);a<p;a+=4)g[a+u]<m&&g[a+2+u]<m||g[a+h]<x&&g[a+2+h]<x||g[a+h]>b&&g[a+2+h]>b||g[a+u]>y&&g[a+2+u]>y||(o=this.getX(g[a+u]),l=this.getY(g[a+h]),s=this.getX(g[a+2+u]),n=this.getY(g[a+2+h]),s!=o||n!=l)&&(this.currentLine+='M ',this.currentLine+=o,this.currentLine+=' ',this.currentLine+=l,this.currentLine+='L ',this.currentLine+=s,this.currentLine+=' ',this.currentLine+=n,this.counter++);this.currentLine+=' z',d=this._createLine(),d.setAttribute('data-zvalue',this.data[r].zValue),this.zValues[this.data[r].zValue]={dom:d},this.minZ=Math.min(this.minZ,this.data[r].zValue),this.maxZ=Math.max(this.maxZ,this.data[r].zValue)}for(r++,r=this.currentLine+1;r<this.lines.length;r++)this.groupLines.removeChild(this.lines[r]),this.lines.splice(r,1);for(r=0;r<i;r++)this.setColorTo(this.lines[r],this.data[r].zValue,this.minZ,this.maxZ);this.onMouseWheel(0,{shiftKey:!1}),this.groupMain.insertBefore(this.groupLines,c)}else if(this.hasStyleChanged(this.selectionType))for(;r<i;r++)this.setColorTo(this.lines[r],this.data[r].zValue,this.minZ,this.maxZ)}onMouseWheel(t,r,a,s){var n=Math.pow,o=Math.max,l=Math.min;for(var p in t/=250,void 0===a?r.shiftKey&&this.options.hasNegative?(this.negativeDelta=l(0,o(-1,this.negativeDelta+l(0.1,o(-0.1,t)))),this.negativeThreshold=-this.minZ*n(this.negativeDelta,3)):(this.positiveDelta=l(1,o(0,this.positiveDelta+l(0.1,o(-0.1,t)))),this.positiveThreshold=this.maxZ*n(this.positiveDelta,3)):(!s&&(this.negativeThreshold=-a*this.minZ,this.negativeDelta=-n(Math.abs(this.negativeThreshold/-this.minZ),1/3)),s&&(this.positiveThreshold=a*this.maxZ,this.positiveDelta=n(this.positiveThreshold/this.maxZ,1/3))),isNaN(this.positiveDelta)&&(this.positiveDelta=0),isNaN(this.negativeDelta)&&(this.negativeDelta=0),this.zValues)this.zValues[p].dom.setAttribute('display',0<=p&&p>=this.positiveThreshold||0>=p&&p<=this.negativeThreshold?'block':'none');this._shapeZoom&&(this.options.hasNegative?(this._shapeZoom.setHandleNeg(-n(this.negativeDelta,3),this.minZ),this._shapeZoom.showHandleNeg()):this._shapeZoom.hideHandleNeg(),this._shapeZoom.setHandlePos(n(this.positiveDelta,3),this.maxZ))}setDynamicColor(t){this.lineColors=t,this.styleHasChanged()}setNegative(t){this.options.hasNegative=t,t&&(this.negativeThreshold=0)}setColorTo(t,r,a,s){if(this.lineColors){var n={h:0,s:0,l:0};for(var o in n)n[o]=0<r?this.lineColors.fromPositive[o]+(this.lineColors.toPositive[o]-this.lineColors.fromPositive[o])*(r/s):this.lineColors.fromNegative[o]+(this.lineColors.toNegative[o]-this.lineColors.fromNegative[o])*(r/a);n.h/=360;var i=hslToRgb(n.h,n.s,n.l);t.setAttribute('stroke','rgb('+i.join()+')')}}getSymbolForLegend(){if(!this.lineForLegend){var t=document.createElementNS(this.graph.ns,'ellipse');t.setAttribute('cx',7),t.setAttribute('cy',0),t.setAttribute('rx',8),t.setAttribute('ry',3),t.setAttribute('cursor','pointer'),this.lineForLegend=t}return this.applyLineStyle(this.lineForLegend,this.maxZ),this.lineForLegend}applyLineStyle(t,i){t.setAttribute('stroke',this.getLineColor()),t.setAttribute('stroke-width',this.getLineWidth()+(this.isSelected()?2:0)),this.getLineDashArray()&&t.setAttribute('stroke-dasharray',this.getLineDashArray()),t.setAttribute('fill','none'),this.setColorTo(t,i===void 0?t.getAttribute('data-zvalue'):i,this.minZ,this.maxZ),this.hasStyleChanged(!1)}setShapeZoom(t){this._shapeZoom=t}}class Shape extends EventEmitter{constructor(){super()}init(t,i){var r=this;if(this.graph=t,this.properties=i||{},this.handles=[],this.options=this.options||{},this.group=document.createElementNS(this.graph.ns,'g'),this.group.setAttribute('clip-path','url(#_clipplot'+t._creation+')'),this._selected=!1,this.createDom(),this._dom&&(this._dom.jsGraphIsShape=this),this.group.jsGraphIsShape=this,this.classes=[],this.transforms=[],this._data.masker){var a=document.createElementNS(this.graph.ns,'mask');this.maskingId=Math.random(),a.setAttribute('id',this.maskingId),this.maskDomWrapper=document.createElementNS(this.graph.ns,'rect'),this.maskDomWrapper.setAttribute('fill','white'),a.appendChild(this.maskDomWrapper);var s=this._dom.cloneNode();a.appendChild(s),this.maskDom=s,this.graph.defs.appendChild(a)}return this.group&&(this._dom&&!this.isHTML()&&this.group.appendChild(this._dom),this.group.addEventListener('mouseover',function(t){r.handleMouseOver(t)}),this.group.addEventListener('mouseout',function(t){r.handleMouseOut(t)}),this.group.addEventListener('mousedown',function(t){r.graph.focus(),r.handleMouseDown(t)}),this.group.addEventListener('click',function(t){r.handleClick(t)}),this.group.addEventListener('dblclick',function(t){r.handleDblClick(t)})),this.initImpl(),this.graph.emit('shapeNew',this),this}initImpl(){}getData(){return this._data}getType(){return this.type}kill(t){this._inDom&&this.graph.removeShapeFromDom(this),t||this.graph._removeShape(this),this.graph.stopElementMoving(this),this.graph.emit('shapeRemoved',this),this.emit('removed',this),this._inDom=!1}hide(){return this.hidden?this:(this.hidden=!0,this.isHTML()?this._dom.style.display='none':this.group.style.display='none',this)}isHidden(){return this.hidden}isVisible(){return!this.hidden}show(){return this.hidden?(this.hidden=!1,this.isHTML()?this._dom.style.display='initial':this.group.style.display='initial',this.redraw(),this):this}addClass(t){return this.classes=this.classes||[],-1==this.classes.indexOf(t)&&this.classes.push(t),this.makeClasses(),this}removeClass(t){return this.classes.splice(this.classes.indexOf(t),1),this.makeClasses(),this}makeClasses(){return this._dom&&this._dom.setAttribute('class',this.classes.join(' ')),this}changed(t,i){return t&&(this.graph.emit(t,this,i),this.emit(t,this,i)),this.emit('changed',this,i),this.graph.emit('shapeChanged',this,i),this}setEventReceptacle(){this.rectEvent||(this.rectEvent=document.createElementNS(this.graph.ns,'rect'),this.rectEvent.setAttribute('pointer-events','fill'),this.rectEvent.setAttribute('fill','transparent'),this.group.appendChild(this.rectEvent),this.rectEvent.jsGraphIsShape=this);var t=this.group.getBBox();this.rectEvent.setAttribute('x',t.x),this.rectEvent.setAttribute('y',t.y-10),this.rectEvent.setAttribute('width',t.width),this.rectEvent.setAttribute('height',t.height+20)}setSerie(t){if(t){if(this.serie=t,!t.getXAxis||!t.getYAxis)throw console.error(t),'Serie does not implement the getXAxis or getYAxis method';return this.xAxis=t.getXAxis(),this.yAxis=t.getYAxis(),this}}getSerie(){return this.serie}autoAxes(){return this.xAxis||(this.xAxis=this.graph.getXAxis()),this.yAxis||(this.yAxis=this.graph.getYAxis()),this}setXAxis(t){return this.xAxis=t,this}setYAxis(t){this.yAxis=t}getXAxis(){return this.xAxis||this.autoAxes(),this.xAxis}getYAxis(){return this.yAxis||this.autoAxes(),this.yAxis}setLayer(t){return this.setProp('layer',t),this}getLayer(){var t=this.getProp('layer');return void 0===t?1:t}draw(t,i){return(!this._inDom||t)&&(this.appendToDom(),this._inDom=!0),this.makeLabels(),i||this.redraw(),this.applyStyle(),this}redraw(){return this.hidden?this:(this.position=this.applyPosition(),this.redrawImpl(),!this.position)?this:(this.updateLabels(),this._applyTransforms(),this)}redrawImpl(){}setProperties(t){this.properties=t,Array.isArray(this.properties.position)||(this.properties.position=[this.properties.position]);for(var r=this,a=0,i=this.properties.position.length,s;a<i;a++)s=Position.check(this.properties.position[a],function(t){return r.getRelativePosition(t)}),this.properties.position[a]=s;return this.emit('propertiesChanged'),this}getRelativePosition(t){var i;if(null!==(i=/position([0-9]*)/.exec(t)))return this.getPosition(i[1]);return null===(i=/labelPosition([0-9]*)/.exec(t))?void 0:this.getLabelPosition(i[1])}getProperties(){return this.properties}setProp(t,i,r){return this.properties=this.properties||{},this.properties[t]=this.properties[t]||[],this.properties[t][r||0]=i,this.emit('propertyChanged',t),this}getProp(t,i){return(this.properties[t]||[])[i||0]}getProps(t){return this.properties[t]||[]}addProp(t,i){this.properties[t]=this.properties[t]||[],this.properties[t].push(i)}resetProp(t){this.properties[t]=[]}setDom(t,i,r){!this._dom||r&&hasSavedAttribute(this._dom,t)||this._dom.setAttribute(t,i)}setDomGroup(t,i){this.group&&this.group.setAttribute(t,i)}setStrokeColor(t){return this.setProp('strokeColor',t),this.overwriteSavedProp('stroke',t),this.applySelectedStyle(),this}getStrokeColor(){return this.getProp('strokeColor')}setFillColor(t){return this.setProp('fillColor',t),this.overwriteSavedProp('fill',t),this.applySelectedStyle(),this}getFillColor(){return this.getProp('fillColor')}setFillOpacity(t){return this.setProp('fillOpacity',t),this.overwriteSavedProp('fill-opacity',t),this.applySelectedStyle(),this}setStrokeWidth(t){return this.setProp('strokeWidth',t),this.overwriteSavedProp('stroke-width',t),this.applySelectedStyle(),this}getStrokeWidth(){return this.getProp('strokeWidth')}setStrokeDasharray(t){return this.setProp('strokeDasharray',t),this.overwriteSavedProp('stroke-dasharray',t),this.applySelectedStyle(),this}setAttributes(t){return this.setProp('attributes',t),this}overwriteSavedProp(t,i){overwriteDomAttribute(this._dom,t,i)}addAttribute(t,i){var r={};return r[t]=i,this.addProp('attributes',r),this}addTransform(t,i){return this.addProp('transforms',{type:t,arguments:Array.isArray(i)?i:[i]}),this}resetTransforms(){return this.resetProp('transforms'),this}setLabelText(t,i){return this.setProp('labelText',t,i||0),this}setLabelData(t,i){return this.setProp('labelData',text,i||0),this}getLabelText(t,i){return this.getProp('labelText',i||0)}displayLabel(t){return this.setProp('labelVisible',!0,t||0),this}hideLabel(t){return this.setProp('labelVisible',!1,t||0),this}setLabelColor(t,i){return this.setProp('labelColor',t,i||0),this}setLabelFontSize(t,i){return this.setProp('labelFontSize',t,i||0),this}getLabelPosition(t){return this.getProp('labelPosition',t||0)}setLabelPosition(t,i){var r=Position.check(t,function(t){return a.getRelativePosition(t)}),a;return this.setProp('labelPosition',r,i||0),this}setLabelAngle(t,i){return this.setProp('labelAngle',t,i||0),this}setLabelBaseline(t,i){return this.setProp('labelBaseline',t,i||0),this}setLabelAnchor(t,i){return this.setProp('labelAnchor',t,i||0),this}setLabelSize(t,i){return this.setProp('labelSize',t,i||0),this}setLabelStrokeColor(t,i){return this.setProp('labelStrokeColor',t,i||0),this}setLabelStrokeWidth(t,i){return this.setProp('labelStrokeWidth',t,i||0),this}setLabelBackgroundColor(t,i){return this.setProp('labelBackgroundColor',t,i||0),this}setLabelBackgroundOpacity(t,i){return this.setProp('labelBackgroundOpacity',t,i||0),this}applyGenericStyle(){this.setDom('fill',this.getProp('fillColor'),!0),this.setDom('fill-opacity',this.getProp('fillOpacity'),!0),this.setDom('stroke',this.getProp('strokeColor'),!0),this.setDom('stroke-width',this.getProp('strokeWidth'),!0),this.setDom('stroke-dasharray',this.getProp('strokeDasharray'),!0);for(var t=this.getProps('attributes'),r=0,a=t.length;r<a;r++)for(var s in t[r])this.setDom(s,'function'==typeof t[r][s]?t[r][s].call(this,s):t[r][s],!0);return this._applyTransforms(),this}applyStyle(){return this.applyGenericStyle()}calculatePosition(t){var i;return i=t instanceof Position?t:this.getPosition(t),i?i&&i.compute?i.compute(this.graph,this.getXAxis(),this.getYAxis(),this.getSerie()):void this.graph.throw():void 0}getPosition(t){var i=this.getProp('position',t||0);return this.setProp('position',i=Position.check(i),t),i}setPosition(t,i){var r=this,a=Position.check(t,function(t){return r.getRelativePosition(t)});return this.setProp('position',a,i||0)}sortPositions(t){return this.getProps('position').sort(t),this}_applyTransforms(){var t=this.getProp('transforms'),r='';if(t&&(t=Array.isArray(t)?t:[t],0!=t.length)){for(var a=0;a<t.length;a++){switch(r+=t[a].type+'(',t[a].type){case'translate':let s=t[a].arguments[0].compute(this.graph,this.getXAxis(),this.getYAxis(),this.getSerie());r+=s.x,r+=', ',r+=s.y;break;case'rotate':if(r+=t[a].arguments[0],r+=', ',1==t[a].arguments.length){var i=this.computePosition(0);r+=i.x+', '+i.y}else r+=Position.getDeltaPx(t[a].arguments[1],this.getXAxis()).replace('px',''),r+=', ',r+=Position.getDeltaPx(t[a].arguments[2],this.getYAxis()).replace('px','');}r+=') '}return this.setDomGroup('transform',r),this}}makeLabels(){this._labels=this._labels||[],this._labelsBackground=this._labelsBackground||[],this._labels.map((t)=>{this.group.removeChild(t)}),this._labelsBackground.map((t)=>{this.group.removeChild(t)}),this._labels=[],this._labelsBackground[t]=[];for(var t=0;void 0!==this.getProp('labelText',t);)this._labels[t]||(this._labels[t]=document.createElementNS(this.graph.ns,'text'),this._labels[t].setAttribute('data-label-i',t),this._labels[t].jsGraphIsShape=this,this._labelsBackground[t]=document.createElementNS(this.graph.ns,'rect'),this._labelsBackground[t].setAttribute('data-label-i',t),this._labelsBackground[t].jsGraphIsShape=this,this.group.appendChild(this._labelsBackground[t]),this.group.appendChild(this._labels[t]),this._labels[t].addEventListener('dblclick',(t)=>{t.stopPropagation(),this.labelDblClickListener(t)}),this._labelsBackground[t].addEventListener('dblclick',(t)=>{t.stopPropagation(),this.labelDblClickListener(t)})),t++;return this.updateLabels(),this}isLabelEditable(t){return this.getProp('labelEditable',t||0)}updateLabels(){this._labels=this._labels||[];for(var t=0,i=this._labels.length;t<i;t++)this._applyLabelData(t)}_applyLabelData(t){t=t||0;var r=this.getProp('labelVisible',t);if(!1===r)return this._labels[t].setAttribute('display','none'),void this._labelsBackground[t].setAttribute('display','none');this._labels[t].setAttribute('display','initial'),this._labelsBackground[t].setAttribute('display','initial');var a=this.calculatePosition(Position.check(this.getProp('labelPosition',t)));if(!(isNaN(a.x)||isNaN(a.y)||!1===a.y||!1===a.x)){'NaNpx'==a.x||isNaN(a.x)||'NaN'===a.x||!1===a.x||(this._labels[t].setAttribute('x',a.x),this._labels[t].setAttribute('y',a.y));var s=this.getProp('labelAngle',t)||0;if(0!=s){var n=this._labels[t].getAttribute('x'),o=this._labels[t].getAttribute('y');this._labels[t].setAttribute('transform','rotate('+s+' '+n+' '+o+')')}let i=this.getProp('labelHTMLData',t)||{};for(var l in i)this._labels[t].setAttribute(l,i[l]),this._labelsBackground[t].setAttribute(l,i[l]);this._labels[t].setAttribute('dominant-baseline',this.getProp('labelBaseline',t)||'no-change'),this._labels[t].textContent=this.getProp('labelText',t),this._labels[t].setAttribute('fill',this.getProp('labelColor',t)||'black'),this._labels[t].setAttribute('font-size',this.getProp('labelSize',t)+'px'||'12px'),this._labels[t].setAttribute('text-anchor',this._getLabelAnchor(t)),this._labels[t].setAttribute('stroke',this.getProp('labelStrokeColor',t)||'black'),this._labels[t].setAttribute('stroke-width',this.getProp('labelStrokeWidth',t)||'0px'),this._labels[t].setAttribute('stroke-location','outside');let r=this._labels[t].getBBox();return this._labelsBackground[t].setAttribute('x',r.x),this._labelsBackground[t].setAttribute('y',r.y),this._labelsBackground[t].setAttribute('width',r.width),this._labelsBackground[t].setAttribute('height',r.height),this._labelsBackground[t].setAttribute('fill',this.getProp('labelBackgroundColor')||'transparent'),this._labelsBackground[t].setAttribute('fill-opacity',this.getProp('labelBackgroundOpacity')||1),this}}emptyLabels(){for(var t=0,i=this._labels.length;t<i;t++)this._labels[t].textContent='';return this}_getLabelAnchor(t){var i=this.getProp('labelAnchor',t);switch(i){case'middle':case'start':case'end':return i;break;case'right':return'end';break;case'left':return'start';break;default:return'start';}}isSelected(){return this._selectStatus||!1}hasHandles(t){return void 0!==t&&this.setProp('handles',t),!!this.getProp('handles')||!!this.getProp('staticHandles')}addHandles(){if(!this.isLocked()){if(!this.handlesInDom){this.handlesInDom=!0;for(var t=1;t<this.handles.length;t++)this.handles[t]&&this.group.appendChild(this.handles[t])}return this}}removeHandles(){this.hideHandles(),this.handles=[]}hideHandles(){if(!this.handlesInDom)return this;for(var t=1;t<this.handles.length;t++)this.group.removeChild(this.handles[t]);return this.handlesInDom=!1,this}areHandlesInDom(){return this.handlesInDom}_select(t){return!!this.isSelectable()&&void(this.appendToDom(),this._selectStatus=!0,this.applySelectedStyle(),this.hasHandles()&&!this.hasStaticHandles()&&(this.addHandles(),this.setHandles()),!t&&this.graph.emit('shapeSelected',this))}applySelectedStyle(){if(this._selectStatus){var t=this.getSelectStyle(),r={};for(var a in t)r[a]='function'==typeof t[a]?t[a].call(this):t[a];saveDomAttributes(this._dom,r,'select')}}_unselect(t){this._selectStatus=!1,restoreDomAttributes(this._dom,'select'),this.hasHandles()&&!this.hasStaticHandles()&&this.hideHandles(),t||this.graph.emit('shapeUnselected',this)}getSelectStyle(){return this.selectStyle}setSelectStyle(t){return this.selectStyle=t,this.applySelectedStyle(),this}setStaticHandles(t){this.setProp('staticHandles',t)}hasStaticHandles(){return!!this.getProp('staticHandles')}_createHandles(t,r,a,s){if(!(this.handles&&0<this.handles.length)){for(var n=1;n<=t;n++)((t)=>{var i=this,n=document.createElementNS(i.graph.ns,r);if(n.jsGraphIsShape=!0,a)for(var o in a)n.setAttribute(o,a[o]);n.addEventListener('mousedown',(r)=>{i.isResizable()&&(r.preventDefault(),r.stopPropagation(),i.graph.emit('beforeShapeResize',i),this.emit('beforeShapeResize'),!i.graph.prevent(!1)&&(i.resizing=!0,i.handleSelected=t,i.handleMouseDown(r)))}),s&&s(i.handles[t]),i.handles[t]=n}).call(this,n);return this.handles}}createHandles(){this.hasStaticHandles()&&(this.addHandles(),this.setHandles())}handleMouseDownImpl(){}handleMouseMoveImpl(){}handleMouseUpImpl(){}handleCreateImpl(){}handleMouseDown(t){if(!this.isLocked())return(this.isMovable()||this.isResizable())&&this.graph.elementMoving(this),this.getProp('selectOnMouseDown')&&this.graph.selectShape(this),this.isMovable()&&!this.resizing&&(this.graph.emit('beforeShapeMove',self),!this.graph.prevent(!1)&&(this.moving=!0)),this._mouseCoords=this.graph._getXY(t),this.handleMouseDownImpl(t,this._mouseCoords)}handleClick(t){return this.graph.emit('shapeClicked',this),this.emit('shapeClicked'),!!this.isSelectable()&&void(!t.shiftKey&&this.graph.unselectShapes(),this.getProp('selectOnClick')&&this.graph.selectShape(this))}handleMouseMove(t){if((this.resizing||this.moving)&&!this.isSelected()&&this.graph.selectShape(this),this.graph.emit('beforeShapeMouseMove',this),this.emit('beforeShapeMouseMove'),this.graph.prevent(!1)||!this._mouseCoords)return!1;var i=this.graph._getXY(t),r=this.getXAxis().getRelVal(i.x-this._mouseCoords.x),a=this.getYAxis().getRelVal(i.y-this._mouseCoords.y);(0!=r||0!==a)&&(this.preventUnselect=!0),this._mouseCoords=i;var s=this.handleMouseMoveImpl(t,r,a,i.x-this._mouseCoords.x,i.y-this._mouseCoords.y);return s}handleMouseUp(t){return this.moving&&(this.graph.emit('shapeMoved',this),this.emit('shapeMoved')),(this.handleSelected||this.resize)&&(this.graph.emit('shapeResized',this),this.emit('shapeResized')),this.moving=!1,this.resizing=!1,this.handleSelected=!1,this.graph.elementMoving(!1),this.handleMouseUpImpl(t)}handleDblClick(){}handleMouseOver(){!this.getProp('highlightOnMouseOver')||this.moving||this.resizing||this.highlight(),this.graph.emit('shapeMouseOver',this)}handleMouseOut(){this.getProp('highlightOnMouseOver')&&this.unHighlight(),this.graph.emit('shapeMouseOut',this)}lock(){return this.setProp('locked',!0),this}unlock(){return this.setProp('locked',!1),this}isLocked(){return this.getProp('locked')||this.graph.shapesLocked}movable(){this.setProp('movable',!0)}unmovable(){return this.setProp('movable',!1),!1}isMovable(){return this.getProp('movable')}resizable(){this.setProp('resizable',!0)}unresizable(){this.setProp('resizable',!1)}isResizable(){return this.getProp('resizable')}selectable(){this.setProp('selectable',!0)}unselectable(){this.graph.unselectShape(this),this.setProp('selectable',!1)}isSelectable(){return this.getProp('selectable')}highlight(t,i){return t||(t=this.getHighlightAttributes()),i||(i='highlight'),saveDomAttributes(this._dom,t,i),this.highlightImpl(),this}unHighlight(t){return t||(t='highlight'),restoreDomAttributes(this._dom,t),this.unHighlightImpl(),this}highlightImpl(){}unHighlightImpl(){}getHighlightAttributes(){return this._highlightAttributes}setHighlightAttributes(t){return this._highlightAttributes=t,this}getMaskingID(){return this.maskingId}maskWith(t){const i=t.getMaskingID();i?this._dom.setAttribute('mask','url(#'+i+')'):this._dom.removeAttribute('mask')}updateMask(){var t=Math.min,i=Math.abs}labelDblClickListener(t){var r=parseInt(t.target.getAttribute('data-label-i')),i=this;if(isNaN(r))return;if(!this.isLabelEditable(r))return;t.preventDefault(),t.stopPropagation();var a=document.createElement('input');a.setAttribute('type','text'),a.setAttribute('value',i.getProp('labelText',r)),i.graph.wrapper.prepend(a),a.select(),setCSS(a,{position:'absolute',marginTop:parseInt(t.target.getAttribute('y').replace('px',''))+this.graph.getPaddingTop()-10+'px',marginLeft:parseInt(t.target.getAttribute('x').replace('px',''))+this.graph.getPaddingLeft()-50+'px',textAlign:'center',width:'100px'});const s=i.getLabelText(r),n=function(){i.setLabelText(a.value,r),i._labels[r].textContent=a.value;const t=a.value;a.remove(),a.removeEventListener('blur',n),a=!1,i.changed('shapeLabelChanged',{previousValue:s,nextValue:t})};a.addEventListener('blur',n),a.addEventListener('keyup',function(t){13===t.keyCode&&n()}),a.addEventListener('keypress',function(t){t.stopPropagation()}),a.addEventListener('keydown',function(t){t.stopPropagation()}),a.focus()}appendToDom(){return this._forcedParentDom?this._forcedParentDom.appendChild(this.group):this.graph.appendShapeToDom(this),this}forceParentDom(t){return this._forcedParentDom=t,this}isHTML(){return!1}}Shape.prototype.computePosition=Shape.prototype.calculatePosition,Shape.prototype.showLabel=Shape.prototype.displayLabel,Shape.prototype.remove=Shape.prototype.kill;class ShapeSurfaceUnderCurve extends Shape{createDom(){this._dom=document.createElementNS(this.graph.ns,'path')}createHandles(){this._createHandles(2,'line',{"stroke-width":'3',stroke:'transparent',"pointer-events":'stroke',cursor:'ew-resize'})}handleMouseMoveImpl(t,i){if(!this.isLocked()){if(this.moving)this.getPosition(0).deltaPosition('x',i,this.getXAxis()),this.getPosition(1).deltaPosition('x',i,this.getXAxis());else if(this.serie&&this.handleSelected){this.resizingPosition=1==this.handleSelected?this.getPosition(0):this.getPosition(1);var r=this.serie.searchClosestValue(this.getXAxis().getVal(this.graph._getXY(t).x-this.graph.getPaddingLeft()));if(!r)return;this.resizingPosition.x!=r.xMin&&(this.preventUnselect=!0),this.resizingPosition.x=r.xMin}else this.handleSelected&&(this.resizingPosition=1==this.handleSelected?this.getPosition(0):this.getPosition(1),this.resizingPosition.deltaPosition('x',i,this.getXAxis()));this.applyPosition()}}applyPosition(){var t=Math.min;if(this.serie){var r=this.computePosition(0),a=this.computePosition(1),s=Math.abs(r.x-a.x),n=t(r.x,a.x);if(2>s||0>n+s||n>this.graph.getDrawingWidth())return this.setDom('d',''),!1;var o=this.serie.searchClosestValue(this.getPosition(0).x),l=this.serie.searchClosestValue(this.getPosition(1).x),p=0,d=Number.MAX_VALUE,g,c,i,u,h,x,n,m;if(!o||!l)return!1;for(o.xBeforeIndex>l.xBeforeIndex&&(g=o,o=l,l=g),this.counter=0,c=o.dataIndex;c<=l.dataIndex;c++){for(this.currentLine='',u=c==o.dataIndex?o.xBeforeIndexArr:0,h=c==l.dataIndex?l.xBeforeIndexArr:this.serie.data[c].length,x=0,u==h&&h++,i=u;i<=h;i+=2)n=this.serie.getX(this.serie.data[c][i+0]),m=this.serie.getY(this.serie.data[c][i+1]),p=Math.max(this.serie.data[c][i+1],p),d=t(this.serie.data[c][i+1],d),i==u&&(this.firstX=n,this.firstY=m),this.currentLine+=0<x?' L '+n+' '+m+' ':' M '+n+' '+m+' ',x++;if(this.lastX=n,this.lastY=m,!this.firstX||!this.firstY||!this.lastX||!this.lastY)return;this.currentLine+=' V '+this.getYAxis().getPx(0)+' H '+this.firstX+' z',this.setDom('d',this.currentLine)}return this.maxY=this.serie.getY(p),this.setHandles(),this.changed(),!0}}setHandles(){if(this.firstX){var t=this.computePosition(0),i=this.computePosition(1);t.x<i.x?(this.handles[1].setAttribute('x1',this.firstX),this.handles[1].setAttribute('x2',this.firstX),this.handles[2].setAttribute('x1',this.lastX),this.handles[2].setAttribute('x2',this.lastX)):(this.handles[1].setAttribute('x1',this.lastX),this.handles[1].setAttribute('x2',this.lastX),this.handles[2].setAttribute('x1',this.firstX),this.handles[2].setAttribute('x2',this.firstX)),this.handles[1].setAttribute('y1',this.getYAxis().getMaxPx()),this.handles[1].setAttribute('y2',this.serie.getY(0)),this.handles[2].setAttribute('y1',this.getYAxis().getMaxPx()),this.handles[2].setAttribute('y2',this.serie.getY(0))}}}class ShapeLine extends Shape{constructor(t,i){super(t,i)}createDom(){this._dom=document.createElementNS(this.graph.ns,'line'),this.setStrokeColor('black'),this.setStrokeWidth(1)}createHandles(){this._createHandles(2,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}applyPosition(){var t=this.calculatePosition(0),i=this.calculatePosition(1);if(t&&t.x&&t.y)return this.setDom('x2',t.x),this.setDom('y2',t.y),this.setDom('y1',i.y),this.setDom('x1',i.x),this.currentPos2x=i.x,this.currentPos2y=i.y,this.currentPos1x=t.x,this.currentPos1y=t.y,!0}handleMouseMoveImpl(t,i,r){if(!this.isLocked()){var a=this.getPosition(0),s=this.getPosition(1),n;if(1==this.handleSelected?n=a:2==this.handleSelected&&(n=s),n&&(!this._data.vertical&&n.deltaPosition('x',i,this.getXAxis()),!this._data.horizontal&&n.deltaPosition('y',r,this.getYAxis())),this.moving&&(a.x&&a.deltaPosition('x',i,this.getXAxis()),a.y&&a.deltaPosition('y',r,this.getYAxis()),s.x&&s.deltaPosition('x',i,this.getXAxis()),s.y&&s.deltaPosition('y',r,this.getYAxis())),this._data.forcedCoords){var o=this._data.forcedCoords;void 0!==o.y&&('function'==typeof o.y?s.y=a.y=o.y(this):(s.y=o.y,a.y=o.y)),void 0!==o.x&&('function'==typeof o.x?s.x=a.x=o.x(this):(s.x=o.x,a.x=o.x))}return this.rectEvent&&this.setEventReceptacle(),this.redraw(),this.changed(),this.setHandles(),!0}}setHandles(){!this.areHandlesInDom()||isNaN(this.currentPos1x)||(this.handles[1].setAttribute('x',this.currentPos1x),this.handles[1].setAttribute('y',this.currentPos1y),this.handles[2].setAttribute('x',this.currentPos2x),this.handles[2].setAttribute('y',this.currentPos2y))}setEventReceptacle(){this.currentPos1x&&(!this.rectEvent&&(this.rectEvent=document.createElementNS(this.graph.ns,'line'),this.rectEvent.setAttribute('pointer-events','stroke'),this.rectEvent.setAttribute('stroke','transparent'),this.rectEvent.jsGraphIsShape=this,this.group.appendChild(this.rectEvent)),this.rectEvent.setAttribute('x1',this.currentPos1x),this.rectEvent.setAttribute('y1',this.currentPos1y),this.rectEvent.setAttribute('x2',this.currentPos2x),this.rectEvent.setAttribute('y2',this.currentPos2y),this.rectEvent.setAttribute('stroke-width',this.getProp('strokeWidth')+2))}}class ShapeArrow extends ShapeLine{constructor(t){super(t)}createDom(){this._dom=document.createElementNS(this.graph.ns,'line'),this._dom.setAttribute('marker-end','url(#arrow'+this.graph._creation+')'),this.createHandles(this.nbHandles,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'}),this.setStrokeColor('black'),this.setStrokeWidth(1)}}class ShapeEllipse extends Shape{constructor(t,i){super(t,i)}createDom(){this._dom=document.createElementNS(this.graph.ns,'ellipse')}applyPosition(){var t=Math.abs,i=this.computePosition(0);this.setDom('cx',i.x||0),this.setDom('cy',i.y||0);let r=this.graph.newPosition({dx:this.getProp('rx'),dy:this.getProp('ry')||this.getProp('rx')}),a=this.calculatePosition(r);return this.setDom('rx',t(a.x)||0),this.setDom('ry',t(a.y)||0),!0}setR(t,i){return this.setProp('rx',t),this.setProp('ry',i),this}handleMouseUpImpl(){this.triggerChange()}handleMouseMoveImpl(){}}class ShapeLabel extends Shape{constructor(t,i){super(t,i)}createDom(){return!1}applyPosition(){return!0}}class ShapePolyline extends Shape{constructor(t,i){super(t,i)}createDom(){this._dom=document.createElementNS(this.graph.ns,'path'),this.getStrokeColor()||this.setStrokeColor('black'),this.getStrokeWidth()==void 0&&this.setStrokeWidth(1)}createHandles(){}setPointsPx(t){return this.setProp('pxPoints',t),this}applyPosition(){let t=this.computePosition(0),i;if(i=this.getProp('pxPoints'))i=' M '+t.x+' '+t.y+' '+i,this.setDom('d',i);else if(this.points){var r,a;this.serie?(r=this.serie.getXAxis(),a=this.serie.getYAxis()):this.xAxis&&this.yAxis&&(r=this.xAxis,a=this.yAxis),this.setDom('d','M '+this.points.map(function(t){return r.getPx(t[0])+', '+a.getPx(t[1])}).join(' L '))}return this.changed(),!0}}class ShapeNMRIntegral extends Shape{constructor(t,i){super(t,i),this.nbHandles=2}createDom(){this._dom=document.createElementNS(this.graph.ns,'path'),this._dom.setAttribute('pointer-events','stroke')}initImpl(){this.setFillColor('transparent'),this.setStrokeColor('black')}createHandles(){this._createHandles(2,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white'}),this.handles[1].setAttribute('fill','red')}xor(t,i){return t&&!i||!t&&i}applyPosition(){let t=this.getAxis(),r=[],a='',s=this.getProp('baseLine',0)||300,n,o,p,d,g;if(!this.serie)throw'No serie exists for this shape';let c=this.getPosition(0),u=this.getPosition(1);if(c.x<this.serie.getXAxis().getCurrentMin()&&u.x<this.serie.getXAxis().getCurrentMin()||c.x>this.serie.getXAxis().getCurrentMax()&&u.x>this.serie.getXAxis().getCurrentMax())return this.setDom('d',''),this.emptyLabels(),!1;this.showLabel(0);let h=0,x=this.serie.getWaveform(),m;if(!x)return;let y=x.getIndexFromX(c[t],!0,Math.floor),b=x.getIndexFromX(u[t],!0,Math.ceil),A=!1,f;y==b&&('aggregate'==x.getReductionType()?b+=4:b++),b<y&&(f=y,y=b,b=f,A=!0);let k=x.getDataInUse(),S,M,C,v,P,_,L,w,E;for('aggregate'==x.getReductionType(),(!x.getXMonotoneousAscending()||0)&&(x.getXMonotoneousAscending()||1)?(m=y,w=!1,E=1):(m=b,w=!0,E=-1);w?m>=y:m<=b;m+=E){if(p=x.getX(m,!0),d=x.getY(m,!0),n=this.serie.getX(p),o=this.serie.getY(d),h+=x.getY(m,!0),S||(S=n,M=o,C=x.getX(m),v=x.getY(m)),void 0==P){P=n,_=x.getX(m),L=x.getY(m);continue}P=n,r.push([n,o,h]),_=p}_=!1,L=!1,P=!1,0==h&&(h=1),this._sumVal=x.integrate(c.x,u.x),g=this.ratio?this.ratio*(this.sumVal/h):200/h;let X;if(0!=r.length){for(var T=0,i=r.length;T<i;T++){if(X=s-r[T][2]*g,0<T&&(r[T-1][2]>h/2&&r[T][2]<=h/2||r[T-1][2]<h/2&&r[T][2]>=h/2)){let t=s-(r[T-1][2]+r[T][2])/2*g;this.setPosition({x:r[T][0]+'px',y:t+'px'},3),this.setLabelPosition(this.getPosition(3),0)}a+=' L '+r[T][0]+', '+X+' ',this.lastPointX=r[T][0],this.lastPointY=X}return this.points=r,this._sum=h,a=this.serie.isFlipped()?' M '+s+', '+S+' '+a:' M '+S+', '+s+' '+a,this.firstPointX=S,this.firstPointY=s,this.setDom('d',a),this.firstX=S,this.firstY=M,this.ratioLabel&&this.updateIntegralValue(this.ratioLabel)||this.updateLabels(),this.changed(),this.handleCondition=!this.xor(-1==E,A),this.setHandles(),this.updateIntegralValue(),!0}}updateIntegralValue(t=this.ratioLabel){t&&(this.ratioLabel=t),this.setLabelText(t?(Math.round(100*this.sumVal*t)/100).toPrecision(3):'N/A',0),this.updateLabels()}getAxis(){return this._data.axis||'x'}set ratio(t){this._ratio=t}get ratio(){return this._ratio}get sum(){return this._sum}get sumVal(){return this._sumVal}selectStyle(){this.setDom('stroke-width','2px')}selectHandles(){}setHandles(){void 0!=this.points&&this.isSelected()&&(this.addHandles(),this.handleCondition?(this.handles[1].setAttribute('x',this.firstPointX),this.handles[1].setAttribute('y',this.firstPointY),this.handles[2].setAttribute('x',this.lastPointX),this.handles[2].setAttribute('y',this.lastPointY)):(this.handles[2].setAttribute('x',this.firstPointX),this.handles[2].setAttribute('y',this.firstPointY),this.handles[1].setAttribute('x',this.lastPointX),this.handles[1].setAttribute('y',this.lastPointY)))}handleMouseMoveImpl(t,i){if(!this.isLocked()){var r=this.getPosition(0),a=this.getPosition(1),s;return 1==this.handleSelected?s=r:2==this.handleSelected&&(s=a),s&&!this._data.vertical&&s.deltaPosition('x',i,this.getXAxis()),this.moving&&(r.x&&r.deltaPosition('x',i,this.getXAxis()),a.x&&a.deltaPosition('x',i,this.getXAxis())),this.rectEvent&&this.setEventReceptacle(),this.redraw(),this.changed(),!0}}}class ShapeRectangle extends Shape{constructor(t,i){super(t,i)}createDom(){return this._dom=document.createElementNS(this.graph.ns,'rect'),this.getStrokeColor()||this.setStrokeColor('black'),this.getStrokeWidth()||this.setStrokeWidth(1),this.getFillColor()||this.setFillColor('transparent'),this}createHandles(){if(this.hasHandles()){var t=this.getProp('handles');switch('object'!=typeof t&&(t={}),t.type||(t.type='corners'),t.type){case'sides':extend(t,{sides:{top:!0,bottom:!0,left:!0,right:!0}});var r=0;for(var a in t.sides)t.sides[a]&&r++;this._createHandles(r,'g').map(function(t){var i=document.createElementNS(self.graph.ns,'rect');i.setAttribute('x','-3'),i.setAttribute('width','6'),i.setAttribute('y','-6'),i.setAttribute('height','12'),i.setAttribute('stroke','black'),i.setAttribute('fill','white'),i.setAttribute('cursor','pointer'),t.appendChild(i)});var r=1;for(var a in t.sides)t.sides[a]&&(this.handles[a]=this['handle'+r],this.sides[r]=a,r++);break;case'corners':this._createHandles(4,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white'}),this.handles&&(this.handles[2].setAttribute('cursor','nesw-resize'),this.handles[4].setAttribute('cursor','nesw-resize'),this.handles[1].setAttribute('cursor','nwse-resize'),this.handles[3].setAttribute('cursor','nwse-resize'));break;case'seamlessX':this._createHandles(2,'rect',{transform:'translate(-3 -3)',stroke:'transparent',fill:'transparent',width:'20px',cursor:'ew-resize'});}return super.createHandles(),this}}applyPosition(){var t=this.computePosition(0),i=this.computePosition(1),r,a,s,n;return t.x<i.x?(r=t.x,s=i.x-t.x):(r=i.x,s=t.x-i.x),t.y<i.y?(a=t.y,n=i.y-t.y):(a=i.y,n=t.y-i.y),this.currentX=r,this.currentY=a,this.currentW=s,this.currentH=n,isNaN(r)||isNaN(a)||!1===r||!1===a?!1:(this.setDom('width',s),this.setDom('height',n),this.setDom('x',r),this.setDom('y',a),this.setHandles(),this.updateMask(),!0)}handleMouseMoveImpl(t,i,r){var a=this.getProp('handles');if(this.moving||this.handleSelected){var s=this.getPosition(0),n=this.getPosition(1),o=this.getXAxis().isFlipped(),l=this.getYAxis().isFlipped(),p=s.x,d=s.y,g=n.x,c=n.y;if(this.moving)s.deltaPosition('x',i,this.getXAxis()),s.deltaPosition('y',r,this.getYAxis()),n.deltaPosition('x',i,this.getXAxis()),n.deltaPosition('y',r,this.getYAxis());else switch(a.type){case'seamlessX':switch(this.handleSelected){case 1:s.deltaPosition('x',i,this.getXAxis());break;case 2:n.deltaPosition('x',i,this.getXAxis());}break;case'sides':switch(this.sides[this.handleSelected]){case'left':s.deltaPosition('x',i,this.getXAxis());break;case'right':n.deltaPosition('x',i,this.getXAxis());break;case'top':s.deltaPosition('y',r,this.getYAxis());break;case'bottom':n.deltaPosition('y',r,this.getYAxis());}break;case'corners':default:1==this.handleSelected?(s.deltaPosition('x',i,this.getXAxis()),s.deltaPosition('y',r,this.getYAxis())):2==this.handleSelected?(n.deltaPosition('x',i,this.getXAxis()),s.deltaPosition('y',r,this.getYAxis())):3==this.handleSelected?(n.deltaPosition('y',r,this.getYAxis()),n.deltaPosition('x',i,this.getXAxis())):4==this.handleSelected&&(s.deltaPosition('x',i,this.getXAxis()),n.deltaPosition('y',r,this.getYAxis()));}return this.redraw(),this.changed(),this.setHandles(),!0}}setHandles(){var t=Math.min,i=Math.abs;if(!this.isLocked()&&(this.isSelectable()||this._staticHandles)&&this.handlesInDom){var r=this.computePosition(0),a=this.computePosition(1),s=this.getProp('handles');switch(s.type){case'seamlessX':this.handles[1]&&(this.handles[1].setAttribute('transform','translate(-10) translate('+r.x+')'),this.handles[1].setAttribute('height',i(a.y-r.y)),this.handles[1].setAttribute('y',t(a.y,r.y))),this.handles[2]&&(this.handles[2].setAttribute('transform','translate(-10)  translate('+a.x+')'),this.handles[2].setAttribute('height',i(a.y-r.y)),this.handles[2].setAttribute('y',t(a.y,r.y)));break;case'sides':this.handles.left&&this.handles.left.setAttribute('transform','translate('+this.currentX+' '+(this.currentY+this.currentH/2)+')'),this.handles.right&&this.handles.right.setAttribute('transform','translate( '+(this.currentX+this.currentW)+' '+(this.currentY+this.currentH/2)+')'),this.handles.top&&this.handles.top.setAttribute('transform','translate( '+(this.currentX+this.currentW/2)+' '+this.currentY+')'),this.handles.bottom&&this.handles.bottom.setAttribute('transform','translate( '+(this.currentX+this.currentW/2)+' '+(this.currentY+this.currentH)+')');break;case'corners':default:this.handles[1].setAttribute('x',r.x),this.handles[1].setAttribute('y',r.y),this.handles[2].setAttribute('x',a.x),this.handles[2].setAttribute('y',r.y),this.handles[3].setAttribute('x',a.x),this.handles[3].setAttribute('y',a.y),this.handles[4].setAttribute('x',r.x),this.handles[4].setAttribute('y',a.y);}}}}class ShapePeakIntegration2D extends ShapeRectangle{constructor(t,i){super(t,i),this.nbHandles=4}createDom(){this._dom=document.createElementNS(this.graph.ns,'rect'),this._dom.element=this,this.createHandles(this.nbHandles,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}redrawImpl(){this.setPosition(),this.setHandles(),this.setBindableToDom(this._dom)}}class ShapeCross extends Shape{constructor(t,i){super(t,i),this.nbHandles=1}get width(){return this.options.width||10}set width(t){this.options.width=t}createDom(){this._dom=document.createElementNS(this.graph.ns,'path'),this._dom.setAttribute('d','M -'+this.width/2+' 0 h '+this.width+' m -'+this.width/2+' -'+this.width/2+' v '+this.width+'')}createHandles(){this._createHandles(this.nbHandles,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}applyPosition(){var t=this.calculatePosition(0);if(t&&t.x&&t.y)return this.setDom('transform','translate( '+t.x+', '+t.y+')'),this.currentPos1x=t.x,this.currentPos1y=t.y,!0}redrawImpl(){this.setHandles()}handleCreateImpl(){}handleMouseDownImpl(){return this.moving=!0,!0}handleMouseUpImpl(){return this.triggerChange(),!0}handleMouseMoveImpl(t,i,r){if(!this.isLocked()){var a=this.getFromData('pos');return this.moving&&(a.x=this.graph.deltaPosition(a.x,i,this.getXAxis()),a.y=this.graph.deltaPosition(a.y,r,this.getYAxis())),this.redrawImpl(),!0}}createHandles(){this._createHandles(1,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}setHandles(){!this.areHandlesInDom()||isNaN(this.currentPos1x)||(this.handles[1].setAttribute('x',this.currentPos1x),this.handles[1].setAttribute('y',this.currentPos1y))}selectStyle(){this.setDom('stroke','red'),this.setDom('stroke-width','2')}}class ShapePeakBoundaries extends ShapeLine{constructor(t){super(t),this.lineHeight=6}createDom(){this._dom=document.createElementNS(this.graph.ns,'line'),this.line1=document.createElementNS(this.graph.ns,'line'),this.line2=document.createElementNS(this.graph.ns,'line'),this.line3=document.createElementNS(this.graph.ns,'line'),this.rectBoundary=document.createElementNS(this.graph.ns,'path'),this.rectBoundary.setAttribute('fill','transparent'),this.rectBoundary.setAttribute('stroke','none'),this.rectBoundary.setAttribute('pointer-events','fill'),this.rectBoundary.jsGraphIsShape=!0,this.group.appendChild(this.rectBoundary),this.group.appendChild(this.line1),this.group.appendChild(this.line2),this.group.appendChild(this.line3),this._dom.element=this}createHandles(){this._createHandles(3,'rect',{transform:'translate(-3 -3)',width:6,height:6,stroke:'black',fill:'white',cursor:'nwse-resize'})}redrawImpl(){this.line1.setAttribute('stroke',this.getStrokeColor()),this.line2.setAttribute('stroke',this.getStrokeColor()),this.line3.setAttribute('stroke',this.getStrokeColor()),this.line1.setAttribute('stroke-width',this.getStrokeWidth()),this.line2.setAttribute('stroke-width',this.getStrokeWidth()),this.line3.setAttribute('stroke-width',this.getStrokeWidth()),this.setHandles(),this.redrawLines()}redrawLines(){var t=this.computePosition(0),i=this.computePosition(1),r=this.computePosition(2);if(t.x&&i.x&&r.x&&this.posYPx){var a=this.lineHeight;this.rectBoundary.setAttribute('d','M '+t.x+' '+(this.posYPx-a)+' v '+2*a+' H '+i.x+' v '+-2*a+'z'),this.line1.setAttribute('x1',t.x),this.line1.setAttribute('x2',t.x),this.line2.setAttribute('x1',i.x),this.line2.setAttribute('x2',i.x),this.line3.setAttribute('x1',r.x),this.line3.setAttribute('x2',r.x),this._dom.setAttribute('x1',t.x),this._dom.setAttribute('x2',i.x),this.redrawY(a)}return this}redrawY(){if(!this.posYPx)return this;var t=this.lineHeight;return this.line1.setAttribute('y1',this.posYPx-t),this.line1.setAttribute('y2',this.posYPx+t),this.line2.setAttribute('y1',this.posYPx-t),this.line2.setAttribute('y2',this.posYPx+t),this.line3.setAttribute('y1',this.posYPx-t),this.line3.setAttribute('y2',this.posYPx+t),this._dom.setAttribute('y1',this.posYPx),this._dom.setAttribute('y2',this.posYPx),this}setHandles(){if(this.posYPx){var t=this.computePosition(0),i=this.computePosition(1),r=this.computePosition(2);t.x&&i.x&&r.x&&(this.handles[1].setAttribute('x',t.x),this.handles[1].setAttribute('y',this.posYPx),this.handles[2].setAttribute('x',i.x),this.handles[2].setAttribute('y',this.posYPx),this.handles[3].setAttribute('x',r.x),this.handles[3].setAttribute('y',this.posYPx))}}setY(t){return this.posYPx=t,this}setLineHeight(t){this.lineHeihgt=t}handleMouseMoveImpl(t,i){var r=Math.abs;if(!this.isLocked()){var a=this.getPosition(0),s=this.getPosition(1),n=this.getPosition(2);switch(this.handleSelected){case 1:a.deltaPosition('x',i,this.getXAxis()),(r(n.x-s.x)>r(s.x-a.x)||r(n.x-a.x)>r(s.x-a.x))&&(n.x=a.x+0.1*(s.x-a.x));break;case 2:s.deltaPosition('x',i,this.getXAxis()),(r(n.x-s.x)>r(s.x-a.x)||r(n.x-a.x)>r(s.x-a.x))&&(n.x=s.x+0.1*(a.x-s.x));break;case 3:if(n.deltaPosition('x',i,this.getXAxis()),r(n.x-s.x)>r(s.x-a.x)||r(n.x-a.x)>r(s.x-a.x))return;}this.setLabelPosition({y:this.getLabelPosition(0).y,x:n.x}),this.updateLabels(),this.redrawLines(),this.setHandles()}}applyPosition(){return this.redrawLines(),!0}}class ShapeHTML extends Shape{constructor(t,i){super(t,i)}createDom(){this._dom=document.createElement('div'),this._dom.setAttribute('style','position: absolute');let t=document.createElement('div');this._dom.appendChild(t),this.div=t}createHandles(){}setHeight(t){this.setProp('height',t)}setWidth(t){this.setProp('width',t)}setContent(t){this.setProp('content',t)}setRenderer(t){this._renderer=t}redraw(){this._renderer?this._renderer(this.div):this.div.innerHTML=this.getProp('content'),super.redraw(...arguments)}applyPosition(){var t=this.calculatePosition(0);if(t&&isNumeric$1(t.x)&&isNumeric$1(t.y))return this._dom.style.left=t.x+'px',this._dom.style.top=t.y+'px',this.currentPosX=t.x,this.currentPosY=t.y,!0}handleMouseMoveImpl(){return!0}setHandles(){this.areHandlesInDom()&&isNaN(this.currentPos1x)}isHTML(){return!0}}class Plugin extends EventEmitter{static default(){return{}}constructor(t){super(...arguments),this.options=Object.assign({},Plugin.default(),this.constructor.default(),t)}init(t){this.graph=t}onMouseDown(){}onMouseUp(){}onMouseMove(){}}class PluginDrag extends Plugin{static default(){return{dragX:!0,dragY:!0,persistanceX:!1,persistanceY:!1}}init(t){this.graph=t,this.time=null,this.totaltime=2e3}onMouseDown(t,i,r){return this._draggingX=i,this._draggingY=r,this._lastDraggingX=this._draggingX,this._lastDraggingY=this._draggingY,this.stopAnimation=!0,this.moved=!1,!0}onMouseMove(t,i,r){var a=i-this._draggingX,s=r-this._draggingY;this.options.dragX&&t._applyToAxes(function(t){t.setCurrentMin(t.getVal(t.getMinPx()-a)),t.setCurrentMax(t.getVal(t.getMaxPx()-a))},!1,!0,!1),this.options.dragY&&t._applyToAxes(function(t){t.setCurrentMin(t.getVal(t.getMinPx()-s)),t.setCurrentMax(t.getVal(t.getMaxPx()-s))},!1,!1,!0),this._lastDraggingX=this._draggingX,this._lastDraggingY=this._draggingY,this._draggingX=i,this._draggingY=r,this.moved=!0,this.time=Date.now(),this.emit('dragging'),t.draw(!0)}onMouseUp(t,i,r){var a=Date.now()-this.time;return i==this._lastDraggingX||r==this._lastDraggingY?void(this.moved&&this.emit('dragged')):(this.speedX=(i-this._lastDraggingX)/a,this.speedY=(r-this._lastDraggingY)/a,isNaN(this.speedX)||isNaN(this.speedY)?void this.emit('dragged'):void(t._applyToAxes(function(t){t._pluginDragMin=t.getCurrentMin(),t._pluginDragMax=t.getCurrentMax()},!1,!0,!0),this.stopAnimation=!1,this.accelerationX=-this.speedX/this.totaltime,this.accelerationY=-this.speedY/this.totaltime,this.options.persistanceX||this.options.persistanceY?this._persistanceMove(t):this.emit('dragged')))}_persistanceMove(t){var i=this;return i.stopAnimation?void i.emit('dragged'):void window.requestAnimationFrame(function(){var r=Date.now()-i.time,a=(0.5*i.accelerationX*r+i.speedX)*r,s=(0.5*i.accelerationY*r+i.speedY)*r;i.options.persistanceX&&t._applyToAxes(function(t){t.setCurrentMin(-t.getRelVal(a)+t._pluginDragMin),t.setCurrentMax(-t.getRelVal(a)+t._pluginDragMax),t.cacheCurrentMin(),t.cacheCurrentMax(),t.cacheInterval()},!1,!0,!1),i.options.persistanceY&&t._applyToAxes(function(t){t.setCurrentMin(-t.getRelVal(s)+t._pluginDragMin),t.setCurrentMax(-t.getRelVal(s)+t._pluginDragMax),t.cacheCurrentMin(),t.cacheCurrentMax(),t.cacheInterval()},!1,!1,!0),t.draw(),r<i.totaltime?(i.emit('dragging'),i._persistanceMove(t)):i.emit('dragged')})}}class PluginShape extends Plugin{constructor(){super(...arguments)}static default(){return{}}init(t,i){super.init(t,i),this.shapeType=i.type}setShape(t){this.shapeInfo.shapeType=t}onMouseDown(t,i,r,a){if(this.shapeType||this.options.url){var s=this,n,o;this.count=this.count||0,i-=t.getPaddingLeft(),r-=t.getPaddingTop(),n=t.getXAxis().getVal(i),o=t.getYAxis().getVal(r);var l={position:[{x:n,y:o},{x:n,y:o}],onChange:function(i){t.triggerEvent('onAnnotationChange',i)},locked:!1,selectable:!0,resizable:!0,movable:!0};let d=this.options.properties;if(extend(!0,l,this.options),this.emit('beforeNewShape',a,l),!this.graph.prevent(!1)){var p=t.newShape(l.type,l,!1,d);this.emit('createdShape',a,p),p&&(s.currentShape=p,s.currentShapeEvent=a),t.once('mouseUp',()=>{console.log(this.currentShape),this.currentShape||s.emit('newShape',a,p)})}}}onMouseMove(t,i,r,a){if(this.currentShape){console.log('mv'),this.count++;var s=this.currentShape;this.currentShape=!1,t.selectedSerie&&!s.serie&&s.setSerie(t.selectedSerie),s.resizing=!0,s.options&&s.options.onCreate&&s.options.onCreate.call(s),s.draw(),t.selectShape(s),s.handleMouseDown(this.currentShapeEvent,!0),s.handleSelected=this.options.handleSelected||1,s.handleMouseMove(a,!0)}}onMouseUp(){this.currentShape&&(this.currentShape.kill(),this.currentShape=!1)}}class PluginSelectScatter extends Plugin{constructor(){super(...arguments)}static default(){return{}}init(t){this._path=document.createElementNS(t.ns,'path'),setAttributeTo(this._path,{display:'none',fill:'rgba(0,0,0,0.1)',stroke:'rgba(0,0,0,1)',"shape-rendering":'crispEdges',x:0,y:0,height:0,width:0,d:''}),this.graph=t,t.dom.appendChild(this._path)}setSerie(t){this.serie=t}onMouseDown(t,i,r){this.serie&&(this.path='M '+i+' '+r+' ',this.currentX=i,this.currentY=r,this.xs=[this.serie.getXAxis().getVal(i-t.getPaddingLeft())],this.ys=[this.serie.getYAxis().getVal(r-t.getPaddingTop())],this._path.setAttribute('d',''),this._path.setAttribute('display','block'))}onMouseMove(t,i,r){var a=Math.pow;25<a(i-this.currentX,2)+a(r-this.currentY,2)&&(this.path+=' L '+i+' '+r+' ',this.currentX=i,this.currentY=r,this.xs.push(this.serie.getXAxis().getVal(i-t.getPaddingLeft())),this.ys.push(this.serie.getYAxis().getVal(r-t.getPaddingTop())),this._path.setAttribute('d',this.path+' z'),this.findPoints())}findPoints(){for(var t=this.serie.waveform,r=[],a=0,s=0,i=t.getLength(),n;s<i;s+=1){a=0;for(var o=0,l=this.xs.length;o<l;o+=1)n=o==l-1?0:o+1,(this.ys[o]<t.getY(s)&&this.ys[n]>t.getY(s)||this.ys[o]>t.getY(s)&&this.ys[n]<t.getY(s))&&t.getX(s)>(t.getY(s)-this.ys[o])/(this.ys[n]-this.ys[o])*(this.xs[n]-this.xs[o])+this.xs[o]&&a++;1==a%2?(r.push(s),this.serie.selectPoint(s,!0,'selected')):this.serie.unselectPoint(s)}this.selected=r,this.emit('selectionProcess',r)}onMouseUp(){this._path.setAttribute('display','none'),this.emit('selectionEnd',this.selected)}}class PluginZoom extends Plugin{constructor(){super(...arguments)}static default(){return{axes:'all'}}init(t){this._zoomingGroup=document.createElementNS(t.ns,'g'),this._zoomingSquare=document.createElementNS(t.ns,'rect'),this._zoomingSquare.setAttribute('display','none'),setAttributeTo(this._zoomingSquare,{display:'none',fill:'rgba(171,12,12,0.2)',stroke:'rgba(171,12,12,1)',"shape-rendering":'crispEdges',x:0,y:0,height:0,width:0,"pointer-events":'none'}),this.graph=t,t.groupEvent.appendChild(this._zoomingGroup),this._zoomingGroup.appendChild(this._zoomingSquare)}onMouseDown(t,i,r,a,s){var n=this.options.zoomMode;if(n){switch(this._zoomingMode=n,void 0===i&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode='y',i=0),void 0===r&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode='x',r=0),this._zoomingXStart=i,this._zoomingYStart=r,this.x1=i-t.getPaddingLeft(),this.y1=r-t.getPaddingTop(),this._zoomingSquare.setAttribute('width',0),this._zoomingSquare.setAttribute('height',0),this._zoomingSquare.setAttribute('display','block'),this._zoomingMode){case'x':this._zoomingSquare.setAttribute('y',t.options.paddingTop),this._zoomingSquare.setAttribute('height',t.getDrawingHeight()-t.shift.bottom);break;case'y':this._zoomingSquare.setAttribute('x',t.options.paddingLeft),this._zoomingSquare.setAttribute('width',t.getDrawingWidth());break;case'forceY2':this.y2=t.getYAxis().getPx(this.options.forcedY)+t.options.paddingTop;}this.options.onZoomStart&&!s&&this.options.onZoomStart(t,i,r,a,s)}}onMouseMove(t,i,r,a,s){var n=Math.min,o=Math.abs;switch(this._zoomingMode){case'xy':this._zoomingSquare.setAttribute('x',n(this._zoomingXStart,i)),this._zoomingSquare.setAttribute('y',n(this._zoomingYStart,r)),this._zoomingSquare.setAttribute('width',o(this._zoomingXStart-i)),this._zoomingSquare.setAttribute('height',o(this._zoomingYStart-r));break;case'forceY2':this._zoomingSquare.setAttribute('y',n(this._zoomingYStart,this.y2)),this._zoomingSquare.setAttribute('height',o(this._zoomingYStart-this.y2)),this._zoomingSquare.setAttribute('x',n(this._zoomingXStart,i)),this._zoomingSquare.setAttribute('width',o(this._zoomingXStart-i));break;case'x':this._zoomingSquare.setAttribute('x',n(this._zoomingXStart,i)),this._zoomingSquare.setAttribute('width',o(this._zoomingXStart-i));break;case'y':this._zoomingSquare.setAttribute('y',n(this._zoomingYStart,r)),this._zoomingSquare.setAttribute('height',o(this._zoomingYStart-r));}this.options.onZoomMove&&!s&&this.options.onZoomMove(t,i,r,a,s)}onMouseUp(t,i,r,a,s){var n=Math.max,o=Math.min,l=this;this.removeZone();var p=i-t.options.paddingLeft,d=r-t.options.paddingTop;if((this.emit('beforeZoom',{graph:t,x:i,y:r,e:a,mute:s}),!t.prevent(!1))&&(0!=i-this._zoomingXStart||'y'==this._zoomingMode)&&(0!=r-this._zoomingYStart||'x'==this._zoomingMode))if(this.options.transition||this.options.smooth){let t=!1,i=!1;('x'==this._zoomingMode||'xy'==this._zoomingMode||'forceY2'==this._zoomingMode)&&(this.fullX=!1,this.toAxes(function(t){t._pluginZoomMin=t.getCurrentMin(),t._pluginZoomMax=t.getCurrentMax(),t._pluginZoomMinFinal=o(t.getVal(p),t.getVal(l.x1)),t._pluginZoomMaxFinal=n(t.getVal(p),t.getVal(l.x1))},!1,!0,!1),t=!0),('y'==this._zoomingMode||'xy'==this._zoomingMode)&&(this.fullY=!1,this.toAxes(function(t){t._pluginZoomMin=t.getCurrentMin(),t._pluginZoomMax=t.getCurrentMax(),t._pluginZoomMinFinal=o(t.getVal(d),t.getVal(l.y1)),t._pluginZoomMaxFinal=n(t.getVal(d),t.getVal(l.y1))},!1,!1,!0),i=!0),'forceY2'==this._zoomingMode&&(this.fullY=!1,this.toAxes(function(t){t._pluginZoomMin=t.getCurrentMin(),t._pluginZoomMax=t.getCurrentMax(),t._pluginZoomMinFinal=o(t.getVal(l.y2),t.getVal(l.y1)),t._pluginZoomMaxFinal=n(t.getVal(l.y2),t.getVal(l.y1))},!1,!1,!0),i=!0),this.transition(t,i,'zoomEnd')}else{switch(this._zoomingMode){case'x':this.fullX=!1,this.toAxes('_doZoom',[p,this.x1],!0,!1);break;case'y':this.fullY=!1,this.toAxes('_doZoom',[d,this.y1],!1,!0);break;case'xy':this.fullX=!1,this.fullY=!1,this.toAxes('_doZoom',[p,this.x1],!0,!1),this.toAxes('_doZoom',[d,this.y1],!1,!0);break;case'forceY2':this.fullX=!1,this.fullY=!1,this.toAxes('_doZoom',[p,this.x1],!0,!1),this.toAxes('_doZoom',[this.y1,this.y2],!1,!0);}t.draw(),this._backedUpZoomMode&&(this._zoomingMode=this._backedUpZoomMode),this.emit('zoomed'),t.pluginYieldActiveState()}}removeZone(){this._zoomingSquare.setAttribute('display','none')}onMouseWheel(t,i,r,a,s){s||(s={}),s.baseline||(s.baseline=0);let n=s.baseline;'mousePosition'==s.baseline&&(n=this.graph.getYAxis().getVal(a),console.log(n));var o='x'==s.direction,l='y'===s.direction;this.toAxes('handleMouseWheel',[t,i,n],o,l),this.graph.drawSeries()}onDblClick(t,i,r,a,s){var n=Math.max,o=Math.min,l=this.graph;if(this.emit('beforeDblClick',{graph:l,x:t,y:i,pref:a,e:r,mute:s}),!l.prevent(!1)){if(this.options.transition||this.options.smooth){var p=!1,d=!1;('xtotal'==a.mode||'total'==a.mode)&&(this.toAxes(function(t){t._pluginZoomMin=t.getCurrentMin(),t._pluginZoomMax=t.getCurrentMax(),t._pluginZoomMinFinal=t.getMinValue()-t.options.axisDataSpacing.min*t.getInterval(),t._pluginZoomMaxFinal=t.getMaxValue()+t.options.axisDataSpacing.max*t.getInterval()},!1,!0,!1),p=!0),('ytotal'==a.mode||'total'==a.mode)&&(this.toAxes(function(t){t._pluginZoomMin=t.getCurrentMin(),t._pluginZoomMax=t.getCurrentMax(),t._pluginZoomMinFinal=t.getMinValue()-t.options.axisDataSpacing.min*t.getInterval(),t._pluginZoomMaxFinal=t.getMaxValue()+t.options.axisDataSpacing.max*t.getInterval()},!1,!1,!0),d=!0);let t,i;return('gradualX'==a.mode||'gradualY'==a.mode||'gradual'==a.mode||'gradualXY'==a.mode)&&(t=!1,i=!1,('gradualX'==a.mode||'gradual'==a.mode||'gradualXY'==a.mode)&&(t=!0,p=!0),('gradualY'==a.mode||'gradual'==a.mode||'gradualXY'==a.mode)&&(i=!0,d=!0),this.toAxes(function(t){t._pluginZoomMin=t.getCurrentMin(),t._pluginZoomMax=t.getCurrentMax(),t._pluginZoomMinFinal=t.getCurrentMin()-(t.getCurrentMax()-t.getCurrentMin()),t._pluginZoomMaxFinal=t.getCurrentMax()+(t.getCurrentMax()-t.getCurrentMin())},!1,t,i)),void this.transition(p,d,'dblClick')}var g=this.graph.getXAxis(),c=this.graph.getYAxis();if('xtotal'==a.mode)this.toAxes('setMinMaxToFitSeries',null,!0,!1),this.fullX=!0,this.fullY=!1;else if('ytotal'==a.mode)this.toAxes('setMinMaxToFitSeries',null,!1,!0),this.fullX=!1,this.fullY=!0;else if('total'==a.mode)this.toAxes('setMinMaxToFitSeries',null,!0,!0),this.fullX=!0,this.fullY=!0;else{t-=this.graph.options.paddingLeft,i-=this.graph.options.paddingTop;var u=g.getCurrentMin(),h=g.getCurrentMax(),m=g.getVal(t),b=h-u,A=c.getCurrentMin(),f=c.getCurrentMax(),k=c.getVal(i),S=f-A;if('gradualXY'==a.mode||'gradualX'==a.mode){var M=(m-u)/(h-u);u=n(g.getMinValue()-g.getInterval()*g.options.axisDataSpacing.min,u-b*M),h=o(g.getMaxValue()+g.getInterval()*g.options.axisDataSpacing.max,h+b*(1-M)),g.setCurrentMin(u),g.setCurrentMax(h),g.options.onZoom&&g.options.onZoom(u,h),g.cacheCurrentMin(),g.cacheCurrentMax(),g.cacheInterval()}if('gradualXY'==a.mode||'gradualY'==a.mode){var M=(k-A)/(f-A);A=n(c.getMinValue()-c.getInterval()*c.options.axisDataSpacing.min,A-S*M),f=o(c.getMaxValue()+c.getInterval()*c.options.axisDataSpacing.max,f+S*(1-M)),c.setCurrentMin(A),c.setCurrentMax(f),c.options.onZoom&&c.options.onZoom(A,f),c.cacheCurrentMin(),c.cacheCurrentMax(),c.cacheInterval()}}l.pluginYieldActiveState(),this.graph.draw()}}transition(t,i,r){var a=this,s=500;a.gradualUnzoomStart||(a.gradualUnzoomStart=Date.now()),window.requestAnimationFrame(function(){var n=Date.now()-a.gradualUnzoomStart;n>s&&(n=s);var o=Math.sin(n/s*Math.PI/2);a.toAxes(function(t){t.setCurrentMin(t._pluginZoomMin+(t._pluginZoomMinFinal-t._pluginZoomMin)*o),t.setCurrentMax(t._pluginZoomMax+(t._pluginZoomMaxFinal-t._pluginZoomMax)*o),t.cacheCurrentMin(),t.cacheCurrentMax(),t.cacheInterval()},!1,t,i),a.graph.draw(),n<s?(a.transition(t,i,r),a.emit('zooming')):(a.emit('zoomed'),a.graph.pluginYieldActiveState(),r&&a.emit(r),a.gradualUnzoomStart=0)})}isFullX(){return this.fullX}isFullY(){return this.fullY}toAxes(t,i,r,a){var s=this.options.axes;switch(s&&('serieSelected'!=s||this.graph.getSelectedSerie())||(s='all'),s){case'all':this.graph._applyToAxes.apply(this.graph,arguments);break;case'serieSelected':var n=this.graph.getSelectedSerie();n&&(r&&('string'==typeof t?n.getXAxis()[t].apply(n.getXAxis(),i):t.apply(n.getXAxis(),i)),a&&('string'==typeof t?n.getYAxis()[t].apply(n.getYAxis(),i):t.apply(n.getYAxis(),i)));break;default:Array.isArray(s)||(s=[s]);for(let n of s)n.isX()&&r?'string'==typeof t?n[t].apply(n,i):t.apply(n,i):n.isY()&&a&&('string'==typeof t?n[t].apply(n,i):t.apply(n,i));}}}var memory={},memoryHead={};function getFromMemory(t,i){var r,a;if(memory[t]&&memory[t][i])return a=memoryHead[t],r=memory[t][i],r.prev=a,r.next=a.next,a.next.prev=r,a.next=r,memoryHead[t]=r,r.data}function get(t,i){var r;if((r=getFromMemory(t,i))!=void 0)return r}class PluginTimeSerieManager extends Plugin{constructor(){super(...arguments),this.series=[],this.plugins=[],this.currentSlots={},this.requestLevels=new Map,this.update=(t,i)=>{this.series.forEach(function(i){this.updateSerie(i,t)}),t||this.recalculateSeries(i)}}static default(){return{LRUName:'PluginTimeSerieManager',intervals:[1000,15000,60000,900000,3600000,8640000],maxParallelRequests:3,optimalPxPerPoint:2,nbPoints:1e3,url:''}}init(t){this.graph=t,get.create(this.options.LRUName,200),this.requestsRunning=0}setURL(t){return this.options.url=t,this}setAvailableIntervals(){this.options.intervals=arguments}newSerie(t,i,r,a,n){var o=this.graph.newSerie(t,i,r);return this.currentSlots[t]={min:0,max:0,interval:0},o.on('hide',function(){o._zoneSerie&&o._zoneSerie.hide()}),o.on('show',function(){o._zoneSerie&&o._zoneSerie.show()}),o.setInfo('timeSerieManagerDBElements',a),n||(o._zoneSerie=this.graph.newSerie(t+'_zone',{},Graph$1.SERIE_ZONE)),this.series.push(o),o}registerPlugin(t){var r;if(-1<(r=this.plugins.indexOf(t)))for(var a=1;a<arguments.length;a++)t.removeListener(arguments[a],this.update);for(var a=1;a<arguments.length;a++)t.on(arguments[a],this.update)}updateSerie(t,r){var a=this,s=t.getXAxis().getCurrentMin(),n=t.getXAxis().getCurrentMax(),o=this.getOptimalInterval(n-s),l=this.options.intervals.indexOf(o),p;this.cleanRegister(l);for(var d=l;d<=l+1;d++){p=this.options.intervals[d];var i=a.computeSlotID(s,p),g=a.computeSlotID(n,p);[[2,5,6],[1,2,4],[0,1,3]].forEach(function(s){for(var n=i-s[0]*(g-i),l=g+s[0]*(g-i),d=n;d<=l&&!(a.computeTimeMin(d,p)>Date.now());)a.register(t,d,p,p==o?s[1]:s[2],!0,r),d++})}this.processRequests()}cleanRegister(t){this.requestLevels&&this.requestLevels.forEach((i)=>{i.forEach((r,a)=>{r[4]<t&&i.splice(a,1)})})}register(t,i,r,a,s,n){var o=this.computeUniqueID(t,i,r),l=get.get(this.options.LRUName,o);(!l||this.computeTimeMax(i,r)>Date.now()&&l.timeout<Date.now()-(n?5e3:1e5)&&1==a)&&this.request(t,i,r,a,o,s)}request(t,r,a,s,n,o){for(var l in this.requestLevels)l!=s&&this.requestLevels[l][n]&&(1===this.requestLevels[l][n][0]?this.requestLevels[l][n][5]=s:delete this.requestLevels[l][n]);this.requestLevels[s]&&this.requestLevels[s][n]||(this.requestLevels[s]=this.requestLevels[s]||{},this.requestLevels[s][n]=[0,n,t.getName(),r,a,s,t.getInfo('timeSerieManagerDBElements')],!o&&this.processRequests())}processRequests(){if(!(this.requestsRunning>=this.options.maxParallelRequests)){for(var t=this,r=1,a;;){for(var s in this.requestLevels[r])if(1!=this.requestLevels[r][s][0]){a=this.requestLevels[r][s];break}if(a)break;if(r++,10<r)return}this.requestsRunning++,a&&(a[0]=1,ajaxGet({url:this.getURL(a),method:'GET',json:!0}).done(function(i){1==i.status&&(t.requestsRunning--,delete t.requestLevels[r][s],get.store(t.options.LRUName,a[1],i.data),t.processRequests(),1==a[5]&&0==Object.keys(t.requestLevels[1]).length&&t.recalculateSeries(!0))}))}}computeTimeMax(t,i){return(t+1)*(i*this.options.nbPoints)}computeTimeMin(t,i){return t*(i*this.options.nbPoints)}getURL(t){var r=this.options.url.replace('<measurementid>',t[2]).replace('<from>',this.computeTimeMin(t[3],t[4])).replace('<to>',this.computeTimeMax(t[3],t[4])).replace('<interval>',t[4]),a=t[6]||{};for(var s in a)r=r.replace('<'+s+'>',a[s]);return r}getOptimalInterval(t){var i=(this.options.optimalPxPerPoint||1)*t/this.graph.getDrawingWidth(),r=Infinity,a;return this.options.intervals.forEach(function(t){var s=Math.min(r,Math.abs(t-i));r!==s&&(a=t,r=s)}),a||1e3}computeUniqueID(t,r,a){var s='',n=t.getInfo('timeSerieManagerDBElements');for(var o in n)s+=';'+o+':'+n[o];return t.getName()+';'+r+';'+a+s}computeSlotID(t,i){return Math.floor(t/(i*this.options.nbPoints))}computeSlotTime(t,i){return t*(i*this.options.nbPoints)}getZoneSerie(t){return t._zoneSerie}updateZoneSerie(t){var i=this.graph.getSerie(t);i&&i._zoneSerie&&(i._zoneSerie.setXAxis(i.getXAxis()),i._zoneSerie.setYAxis(i.getYAxis()),i._zoneSerie.setFillColor(i.getLineColor()),i._zoneSerie.setLineColor(i.getLineColor()),i._zoneSerie.setFillOpacity(0.2),i._zoneSerie.setLineOpacity(0.3))}recalculateSeries(t){var i=this;this.locked||(this.changed=!1,this.series.map(function(r){i.recalculateSerie(r,t)}),this.changed=!1,i.graph.draw())}recalculateSerie(t,i){var r=t.getXAxis().getCurrentMin(),a=t.getXAxis().getCurrentMax(),s=this.getOptimalInterval(a-r),n=this.computeSlotID(r,s),o=this.computeSlotID(a,s),l=[],p=[];if(!(!i&&s==this.currentSlots[t.getName()].interval&&this.currentSlots[t.getName()].min<=n&&this.currentSlots[t.getName()].max>=o)){n-=2,o+=2,this.currentSlots[t.getName()].min=n,this.currentSlots[t.getName()].max=o,this.currentSlots[t.getName()].interval=s;for(var d=n;d<=o;){const i=get.get(this.options.LRUName,this.computeUniqueID(t,d,s));i?(l=l.concat(i.data.mean),p=p.concat(i.data.minmax)):this.recalculateSerieUpwards(t,d,s,l,p),d++}this.changed=!0,t.setData(l),t._zoneSerie&&t._zoneSerie.setData(p)}}setIntervalCheck(t){this.interval&&clearInterval(this.interval),this.update(!0,!0),this.interval=setInterval(()=>{this.update(!0,!1)},t)}recalculateSerieUpwards(t,r,a,s,n){var o=this.options.intervals.slice(0);o.sort();var p=o[o.indexOf(a)+1]||-1;if(0>p)return[];var d=this.computeSlotTime(r,a),g=this.computeSlotTime(r+1,a),c=this.computeSlotID(d,p),u=!1;const h=get.get(this.options.LRUName,this.computeUniqueID(t,c,p));if(h)for(var x=0,i=h.data.mean.length;x<i;x+=2){if(h.data.mean[x]<d)continue;else!1==u&&(u=x);if(h.data.mean[x]>=g)return s=s.concat(h.data.mean.slice(u,x)),void(n=s.concat(h.data.minmax.slice(u,x)))}return this.recalculateSerieUpwards(t,c,p,s,n)}lockRedraw(){this.locked=!0}unlockRedraw(){this.locked=!1}isRedrawLocked(){return!!this.locked}}class PluginSerieLineDifference extends Plugin{constructor(){super(...arguments)}static default(){return{positiveStyle:{fillColor:'green',fillOpacity:0.2,strokeWidth:0},negativeStyle:{fillColor:'red',fillOpacity:0.2,strokeWidth:0},from:0,to:0}}init(t){this.graph=t,this.pathsPositive=[],this.pathsNegative=[],this.positivePolyline=this.graph.newShape('polyline').draw(),this.positivePolyline.setFillColor(this.options.positiveStyle.fillColor).setFillOpacity(this.options.positiveStyle.fillOpacity).setStrokeWidth(this.options.positiveStyle.strokeWidth).applyStyle(),this.negativePolyline=this.graph.newShape('polyline').draw(),this.negativePolyline.setFillColor(this.options.negativeStyle.fillColor).setFillOpacity(this.options.negativeStyle.fillOpacity).setStrokeWidth(this.options.negativeStyle.strokeWidth).applyStyle()}setSeries(t,i){this.serie1=t,this.serie2=i}setBoundaries(t,i){this.options.from=t,this.options.to=i}getFrom(){return this.options.from}getTo(){return this.options.to}draw(){function t(){!0===b?a.pathsPositive.push([n,o]):!1===b&&a.pathsNegative.push([n,o]),n=[],o=[],b=void 0}function i(t,s){for(var n=0;n<s[0].length;n+=2)0==n&&(t+='M '),t+=' '+r(a.serie1.getXAxis().getPx(s[0][n]))+', '+r(a.serie1.getYAxis().getPx(s[0][n+1])),n<s[0].length-2&&(t+=' L ');for(var n=s[1].length-2;0<=n;n-=2)t+=' L '+r(a.serie2.getXAxis().getPx(s[1][n]))+', '+r(a.serie2.getYAxis().getPx(s[1][n+1])),0==n&&(t+=' z ');return t}var r=Math.round,a=this,s=this.serie1.searchClosestValue(this.getFrom()),n=[],o=[],l,p,g,c,u,h,x,m;s?(l=s.dataIndex,p=2*s.xAfterIndex):(l=0,p=0),u=this.interpolate(this.serie1,this.getFrom()),n.push(this.getFrom()),n.push(u),u=this.interpolate(this.serie2,this.getFrom()),o.push(this.getFrom()),o.push(u);for(var y,b,A;l<this.serie1.data.length;l++){for(;p<this.serie1.data[l].length;p+=2){if(this.serie1.data[l][p]>this.getTo()){u=this.interpolate(this.serie1,this.getTo()),h=this.interpolate(this.serie2,this.getTo()),x=this.computeCrossing(n[n.length-2],n[n.length-1],this.getTo(),u,o[o.length-2],o[o.length-1],this.getTo(),h),x&&(n.push(x.x),n.push(x.y),o.push(x.x),o.push(x.y),t(),n.push(x.x),n.push(x.y),o.push(x.x),o.push(x.y),b=this.serie1.data[l][p+1]>this.serie2.data[g][c+1]),n.push(this.getTo()),n.push(u),o.push(this.getTo()),o.push(h),A=!0;break}if(!y)if(y=this.serie2.searchClosestValue(this.serie1.data[l][p]),y)g=y.dataIndex,c=2*y.xBeforeIndex,u=this.interpolate(this.serie2,this.serie1.data[l][p]),n.push(this.serie1.data[l][p]),n.push(this.serie1.data[l][p+1]),o.push(this.serie1.data[l][p]),o.push(u),b=this.serie1.data[l][p+1]>u;else continue;for(m=!1,x=this.computeCrossing(n[n.length-2],n[n.length-1],this.serie1.data[l][p],this.serie1.data[l][p+1],o[o.length-2],o[o.length-1],this.serie2.data[g][c],this.serie2.data[g][c+1]),x&&(n.push(x.x),n.push(x.y),o.push(x.x),o.push(x.y),t(),n.push(x.x),n.push(x.y),o.push(x.x),o.push(x.y),b=this.serie1.data[l][p+1]>this.serie2.data[g][c+1]);this.serie2.data[g][c]<this.serie1.data[l][p];){if(o.push(this.serie2.data[g][c]),o.push(this.serie2.data[g][c+1]),c+=2,c==this.serie2.data[g].length){m=this.serie2.data[g][c-2],g++,c=0;break}x=this.computeCrossing(n[n.length-2],n[n.length-1],this.serie1.data[l][p],this.serie1.data[l][p+1],o[o.length-2],o[o.length-1],this.serie2.data[g][c],this.serie2.data[g][c+1]),x&&(n.push(x.x),n.push(x.y),o.push(x.x),o.push(x.y),t(),n.push(x.x),n.push(x.y),o.push(x.x),o.push(x.y),b=this.serie1.data[l][p+1]>this.serie2.data[g][c+1])}!1===m?(n.push(this.serie1.data[l][p]),n.push(this.serie1.data[l][p+1])):(n.push(m),n.push(this.interpolate(this.serie1,m)),y=!1,p-=2,t())}if(A){t();break}u=this.interpolate(this.serie2,n[n.length-2]),u&&(o.push(n[n.length-2]),o.push(u)),t(),p=0,y=!1}var f=this.pathsPositive.reduce(i,'');this.positivePolyline.setPointsPx(f).redraw();var f=this.pathsNegative.reduce(i,'');this.negativePolyline.setPointsPx(f).redraw()}interpolate(t,i){var r=t.searchClosestValue(i);if(!r)return!1;if(void 0==r.xMax)return r.yMin;if(void 0==r.xMin)return r.yMax;var a=(i-r.xMin)/(r.xMax-r.xMin);return(1-a)*r.yMin+a*r.yMax}computeCrossing(t,i,r,a,s,n,o,l){var p=(a-i)/(r-t),d=(l-n)/(o-s),g=a-p*r;if(t==r||s==o)return!1;if(p==d)return{x:t,y1:i,y2:i};var c=(g-(l-d*o))/(d-p);return c>r||c<t||c<s||c>o?!1:{x:c,y:p*c+g}}getPositivePolyline(){return this.positivePolyline}getNegativePolyline(){return this.negativePolyline}}class SerieLineExtended extends SerieLine{constructor(){super(...arguments),this.subSeries=[]}setData(){return super.setData(...arguments),this.subSeries.map((t)=>{t.data=this.data}),this}draw(){return this.eraseMarkers(),this}getSymbolForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getSymbolForLegend()}getMarkerForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getMarkerForLegend()}}class SerieScatterExtended extends SerieScatter{constructor(){super(...arguments),this.subSeries=[]}setData(){return super.setData(...arguments),this.subSeries.map((t)=>{t.data=this.data}),this}draw(){return this}getSymbolForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getSymbolForLegend()}getMarkerForLegend(){return!!this.subSeries[0]&&this.subSeries[0].getMarkerForLegend()}}var excludingMethods=['constructor','init','draw','setLineColor','setLineWidth','setLineStyle','getLineColor','getLineWidth','getLineStyle','setMarkers','showMarkers','hideMarkers','getMarkerDom','getMarkerDomIndependant','getMarkerPath','eraseMarkers','_recalculateMarkerPoints'],addMethods=[];Object.getOwnPropertyNames(SerieLine.prototype).concat(addMethods).map(function(t){-1<excludingMethods.indexOf(t)||(SerieLineExtended.prototype[t]=function(t){return function(){var i=arguments;this.subSeries.map((r)=>{r[t](...i)})}}(t))});class PluginAxisSplitting extends Plugin{constructor(){super(...arguments),this.series=new Map}static defaults(){return{axes:{margins:{high:5,low:5}}}}init(t){this.graph=t}newXAxis(t){return newBottomAxis(t)}newYAxis(t){return newLeftAxis(t)}newTopAxis(t){return t=this.getOptions(t),new SplitXAxis(this.graph,'top',t)}newBottomAxis(t){return t=this.getOptions(t),new SplitXAxis(this.graph,'bottom',t)}newLeftAxis(t){return t=this.getOptions(t),new SplitYAxis(this.graph,'left',t)}newRightAxis(t){return t=this.getOptions(t),new SplitYAxis(this.graph,'right',t)}getOptions(t){var i={marginMin:this.options.axes.margins.low,marginMax:this.options.axes.margins.high};return extend(!0,i,t)}preDraw(){var t,i;this.series.forEach(({serie:r})=>{t=r.getXAxis(),i=r.getYAxis();let a=1;for(t.splitNumber&&(a*=t.splitNumber),i.splitNumber&&(a*=i.splitNumber);r.subSeries.length<a;){const t=r.getName()+'_'+r.subSeries.length,i=this.graph.newSerie(t,{},r.getType()||Graph$1.SERIE_LINE);i.excludedFromLegend=!0,i.styles=r.styles,i.data=r.data,r.getType()==Graph$1.SERIE_LINE&&(i.markerPoints=r.markerPoints,i.markerFamilies=r.markerFamilies),r.subSeries.push(i)}for(;r.subSeries.length>a;){let t=this.graph.getSerie(r.getName()+'_'+(r.subSeries.length-1));t&&t.kill&&t.kill(),r.subSeries.pop()}!r.getXAxis().splitNumber&&r.getXAxis().splitAxis&&r.getXAxis().splitAxis(),!r.getYAxis().splitNumber&&r.getYAxis().splitAxis&&r.getYAxis().splitAxis(),r.subSeries.map((i,a)=>{var s,n;if(r.getXAxis().getSubAxis){let i=a%(t.splitNumber||1);s=r.getXAxis().getSubAxis(i)}else s=r.getXAxis();if(i.setXAxis(s),r.getYAxis().getSubAxis){let i=Math.floor(a/(t.splitNumber||1));n=r.getYAxis().getSubAxis(i)}else n=r.getYAxis();i.setYAxis(n),i.draw(!0)})})}newSerie(t,i={},r){switch(r){case'line':return newLineSerie(t,i);break;case'scatter':return newScatterSerie(t,i);}throw'Cannot create a split serie of type '+r}newLineSerie(t,i){var r={type:'lineSerie',serie:new SerieLineExtended(t,i,'line')};return this.series.set(t,r),r.serie.init(this.graph,t,i),this.graph.series.push(r.serie),r.serie}newScatterSerie(t,i){var r={type:'scatterSerie',serie:new SerieScatterExtended(t,i,'scatter')};return this.series.set(t,r),r.serie.init(this.graph,i),this.graph.series.push(r.serie),r.serie}}var defaultAxisConstructorOptions={splitMarks:!0},SplitAxis=function(t){var i=Math.max,r=class extends t{constructor(t,i,r={}){super(t,i,r),this.axes=[],this.position=i,this.constructorOptions=extend(!0,{},defaultAxisConstructorOptions,r),this._splitVal=[]}all(t){if('function'==typeof t)return this.axes.map(t),this}splitAxis(...t){t.push(1);let r=t.length;for(;this.axes.length>r;)this.axes.pop().kill(!0,!0);for(;this.axes.length<r;){let t=new(this.getConstructor())(this.graph,this.position,this.constructorOptions);this.axes.push(t),t.zoomLock=!0,t.init(this.graph,this.constructorOptions)}let a=0,s=0;for(let i of this.axes)i.options.marginMin=10,i.options.marginMax=10,0==s&&(i.options.marginMin=0),s==this.axes.length-1&&(i.options.marginMax=0),i.setSpan(a,a=t[s]),i.setMinMaxFlipped(),s++;return this._splits=t,this}fixGridIntervalBasedOnAxis(t){return this.fixGridFor=t,this.graph._axisHasChanged(),this}splitSpread(t){return this.autoSpread=!!t,this}hasAxis(t){return-1<this.axes.indexOf(t)}_splitSpread(){let t=[],i=0,r=0;for(let t of this._splitVal)i+=t[1]-t[0];for(let a of this._splitVal)t.push(r+=(a[1]-a[0])/i);t.pop(),this.splitAxis(...t)}setChunkBoundaries(t){let i=0,r,a;for(let s of this.axes)Array.isArray(t[i])&&1<t[i].length&&!r&&(r=t[i][1]-t[i][0],a=i),1!=t[i].length&&Array.isArray(t[i])?s.forceMin(t[i][0]).forceMax(t[i][1]):(s._mean=t[i],Array.isArray(s._mean)&&(s._mean=s._mean[0])),i++;return this._baseWidthVal=r,this._baseWidthIndex=a,this._splitVal=t,this.graph._axisHasChanged(),this}setMinMaxToFitSeries(){(!this._splitVal||1>this._splitVal.length)&&(super.setMinMaxToFitSeries(...arguments),this._splitVal[0]=this._splitVal[0]||[],this._splitVal[this._splitVal.length-1]=this._splitVal[this._splitVal.length-1]||[],this._splitVal[0][0]=this.getCurrentMin(),this._splitVal[this._splitVal.length-1][1]=this.getCurrentMax(),this.setChunkBoundaries(this._splitVal))}draw(){this.autoSpread&&this._splitSpread();let t=0,r,a,s;if(0<=this._baseWidthIndex&&(a=this.getSubAxis(this._baseWidthIndex))&&(s=a.getSpan()),a=void 0,0<=this.fixGridFor&&(a=this.getSubAxis(this.fixGridFor))){if(void 0!==a._mean){let t=(a.getSpan()[1]-a.getSpan()[0])/(s[1]-s[0])*this._baseWidthVal;a.forceMin(a._mean-t/2),a.forceMax(a._mean+t/2)}t=a.draw(),r=a.getPrimaryTickUnit()}return this.axes.map((n)=>{if(a!==n){if(void 0!==n._mean){let t=(n.getSpan()[1]-n.getSpan()[0])/(s[1]-s[0])*this._baseWidthVal;n.forceMin(n._mean-t/2),n.forceMax(n._mean+t/2)}r&&n.forcePrimaryTickUnit(r),t=i(t,n.draw())}}),this.writeUnit(),t}setMinPx(t){super.setMinPx(t);for(let i of this.axes)i.setMinPx(t)}setMaxPx(t){super.setMaxPx(t);for(let i of this.axes)i.setMaxPx(t)}setShift(){super.setShift(...arguments);for(let t of this.axes)t.setShift(...arguments)}init(){super.init(...arguments),this.splitAxis()}getAxisPosition(){var t=0;return this.axes.map((r)=>{t=i(t,r.getAxisPosition())}),t}getSubAxis(t){if(this.axes.length<=t)throw'Impossible to reach axis. Index '+t+' is out of range';return this.axes[t]}get splitNumber(){return this._splits.length}};return['turnGridsOff','turnGridsOn','gridsOff','gridsOn','setEngineering','setScientificScaleExponent','setScientific','setLabelColor','setSecondaryGridDasharray','setPrimaryGridDasharray','setSecondaryGridsOpacity','setPrimaryGridOpacity','setSecondaryGridWidth','setPrimaryGridWidth','setSecondaryGridColor','setPrimaryGridColor','setTicksLabelColor','setSecondaryTicksColor','setPrimaryTicksColor','setAxisColor','secondaryGridOn','secondaryGridOff','primaryGridOff','primaryGridOn','setSecondaryGrid','setPrimaryGrid','setGrids','setTickPosition','setExponentialFactor','setExponentialLabelFactor','setGridLinesStyle','forcePrimaryTickUnitMin','forcePrimaryTickUnitMax','forcePrimaryTickUnit','flip','show','hide','setDisplay'].map((t)=>{r.prototype[t]=function(t){return function(){return this.axes.map((i)=>{i[t](...arguments)}),this}}(t)}),r};class SplitXAxis extends SplitAxis(AxisX){constructor(t,i){super(...arguments),this.topbottom=i}getConstructor(){return AxisX}getAxisPosition(){var t=super.getAxisPosition(...arguments);return this.labelPosY=t,this.getLabel()&&(t+=this.graph.options.fontSize),t}drawLabel(){super.drawLabel(),this.label.setAttribute('y',(this.top?-1:1)*(this.graph.options.fontSize+this.labelPosY))}draw(){var t=super.draw(...arguments);return this.drawLabel(),t}}class SplitYAxis extends SplitAxis(AxisY){constructor(){super(...arguments)}getConstructor(){return AxisY}drawLabel(){super.drawLabel()}equalizePosition(t){var i=t;if(this.getLabel()&&this.axes.map((r)=>{i=Math.max(r.equalizePosition(t),i)}),this.getLabel())return this.placeLabel(this.left?-i:i),i+this.graph.options.fontSize}}mix(SplitXAxis,new AxisX),mix(SplitYAxis,new AxisY);class PluginMakeTracesDifferent extends Plugin{constructor(){super(...arguments)}init(t,i){super.init(t,i)}static default(){return{}}checkHSL(t){let i={},r,a,s;return(r=t.h||t.hue)?(1>r&&(r=Math.round(360*r)),i.hue=r):i.h=0,(a=t.s||t.saturation)?(1<a&&(a/=100),i.saturation=a):i.saturation=.75,(s=t.lightness||t.l)?(1<s&&(s/=100),i.lightness=s):i.lightness=0.5,i}buildHSLString(t){var i=Math.round;return'hsl( '+i(t.h)+', '+i(100*t.s)+'%, '+i(100*t.l)+'%)'}colorizeAll(t){let i,r;if(t.serieTypes?(!Array.isArray(t.serieTypes)&&(t.serieTypes=[t.serieTypes]),i=this.graph.allSeries(...t.serieTypes)):i=this.graph.getSeries(),r=i.length,!t.startingColorHSL)if(t.colorHSL)t.startingColorHSL=this.checkHSL(t.colorHSL);else throw'No starting color was provided. There must exist either options.colorHSL or options.startingColorHSL';if(!t.endingColorHSL)switch(t.affect&&['h','s','l','hue','saturation','lightness'].include(t.affect)||(t.affect='h'),t.affect){case'h':case'hue':t.endingColorHSL={h:t.startingColorHSL.h+300,s:t.startingColorHSL.s,l:t.startingColorHSL.l};break;case'saturation':case's':let i;i=0.5<t.startingColorHSL.s?0:1,t.endingColorHSL={h:t.startingColorHSL.h,s:i,l:t.startingColorHSL.l};break;case'lightness':case'l':let r;r=0.5<t.startingColorHSL.l?0:0.75,t.endingColorHSL={h:t.startingColorHSL.h,s:t.startingColorHSL.s,l:r};}else t.endingColorHSL=Object.assign({},t.startingColorHSL,t.endingColorHSL);return i.map((i,a)=>{if(!i.setLineColor)throw'The serie '+i.getName()+' does not implement the method `startingColor`';const s=this.buildHSLString({h:t.startingColorHSL.h+a/(r-1)*(t.endingColorHSL.h-t.startingColorHSL.h),s:t.startingColorHSL.s+a/(r-1)*(t.endingColorHSL.s-t.startingColorHSL.s),l:t.startingColorHSL.l+a/(r-1)*(t.endingColorHSL.l-t.startingColorHSL.l)});return i.setLineColor(s),s})}}class PluginPeakPicking extends Plugin{constructor(){super(...arguments)}static default(){return{autoPeakPicking:!1,autoPeakPickingNb:4,autoPeakPickingMinDistance:10,autoPeakPickingFormat:!1,autoPeakPickingAllowAllY:!1}}init(t,i){super.init(t,i),this.picks=[];for(var r=0,a=this.options.autoPeakPickingNb,s;r<a;r++)s=this.graph.newShape({type:'label',label:{text:'',position:{x:0},anchor:'middle'},selectable:!0,shapeOptions:{minPosY:15}}),s.draw(),this.picks.push(s)}setSerie(t){this.serie=t}serieRemoved(t){this.serie==t&&this.picks.map((t)=>{t.kill()})}preDraw(){this.serie&&(this.detectedPeaks=[],this.lastYPeakPicking=!1)}postDraw(){if(!this.serie)return;let t=!0,r=!1,a=[],s=this.serie.getWaveform(),n;if(!s)throw'The serie must have a waveform for the peak picking to work';let o=s.getLength(),p=0,i;for(;p<o;p++){if(i=s.getY(p),this.serie.options.lineToZero){a.push([s.getX(p),i]);continue}if(!n){n=[s.getX(p),i];continue}i>=n[1]&&t||i<=n[1]&&r?n=[s.getX(p),i]:(i<n[1]&&t||i>n[1]&&r)&&(r?(r=!1,t=!0):(r=!0,t=!1,a.push(n),n=!1),n=[s.getX(p),i])}var d=a,g=[],c=d.length,l,u,u,h,y,m;p=0;var b=this.graph.selectedShapes.map(function(t){return t.getProp('xval')});for(d.sort(function(t,i){return i[1]-t[1]}),y=0;p<c;p++)if((l=d[p][0],u=this.serie.getX(l),h=0,i=this.serie.getY(d[p][1]),!(u<this.serie.getXAxis().getMinPx()||u>this.serie.getXAxis().getMaxPx()))&&!(!this.options.autoPeakPickingAllowAllY&&(i>this.serie.getYAxis().getMinPx()||i<this.serie.getYAxis().getMaxPx()))){for(;h<g.length&&!(Math.abs(g[h]-u)<this.options.autoPeakPickingMinDistance);h++);if(!(h<g.length)){if(-1<(m=b.indexOf(l))){g.push(u);continue}if(!this.picks[y])return;for(0>this.serie.getYAxis().getPx(d[p][1])-20?(this.picks[y].setLabelPosition({x:l,y:'5px'}),this.picks[y].setLabelBaseline('hanging')):(this.picks[y].setLabelBaseline('no-change'),this.picks[y].setLabelPosition({x:l,y:d[p][1],dy:'-15px'})),this.picks[y].setProp('xval',l),this.options.autoPeakPickingFormat?this.picks[y].setLabelText(this.options.autoPeakPickingFormat.call(this.picks[y],l,y)):this.picks[y].setLabelText(Math.round(1e3*l)/1e3+''),this.picks[y].makeLabels(),y++;this.picks[y]&&this.picks[y].isSelected();)y++;if(g.length==this.options.autoPeakPickingNb)break}}}hidePeakPicking(t){if(this._hidePeakPickingLocked||(this._hidePeakPickingLocked=t),!!graph.picks)for(var r=0;r<graph.picks.length;r++)graph.picks[r].hide()}showPeakPicking(t){if((!this._hidePeakPickingLocked||t)&&graph.picks)for(var r=0;r<graph.picks.length;r++)graph.picks[r].show()}killPeakPicking(){if(this.picks)for(var t=0,i=this.picks.length;t<i;t++)this.picks[t].kill()}}Graph$1.registerConstructor('graph.position',Position),Graph$1.registerConstructor('graph.axis.x',AxisX),Graph$1.registerConstructor('graph.axis.y',AxisY),Graph$1.registerConstructor('graph.axis.x.bar',AxisXBar),Graph$1.registerConstructor('graph.axis.x.time',GraphTimeAxis),Graph$1.registerConstructor('graph.serie.line',SerieLine),Graph$1.registerConstructor('graph.serie.line.3d',SerieLine3D),Graph$1.registerConstructor('graph.serie.line.color',SerieLineColor),Graph$1.registerConstructor('graph.serie.contour',SerieContour),Graph$1.registerConstructor('graph.serie.bar',SerieBar),Graph$1.registerConstructor('graph.serie.box',SerieBox),Graph$1.registerConstructor('graph.serie.scatter',SerieScatter),Graph$1.registerConstructor('graph.serie.zone',SerieZone),Graph$1.registerConstructor('graph.serie.zone.3d',SerieZone3D),Graph$1.registerConstructor('graph.serie.densitymap',SerieDensityMap),Graph$1.registerConstructor(Graph$1.SERIE_LINE,SerieLine),Graph$1.registerConstructor(Graph$1.SERIE_LINE_3D,SerieLine3D),Graph$1.registerConstructor(Graph$1.SERIE_LINE_COLORED,SerieLineColor),Graph$1.registerConstructor(Graph$1.SERIE_CONTOUR,SerieContour),Graph$1.registerConstructor(Graph$1.SERIE_BAR,SerieBar),Graph$1.registerConstructor(Graph$1.SERIE_BOX,SerieBox),Graph$1.registerConstructor(Graph$1.SERIE_SCATTER,SerieScatter),Graph$1.registerConstructor(Graph$1.SERIE_ZONE,SerieZone),Graph$1.registerConstructor(Graph$1.SERIE_ZONE_3D,SerieZone3D),Graph$1.registerConstructor(Graph$1.SERIE_DENSITYMAP,SerieDensityMap),Graph$1.registerConstructor('graph.plugin.shape',PluginShape),Graph$1.registerConstructor('graph.plugin.drag',PluginDrag),Graph$1.registerConstructor('graph.plugin.zoom',PluginZoom),Graph$1.registerConstructor('graph.plugin.selectScatter',PluginSelectScatter),Graph$1.registerConstructor('graph.plugin.timeSerieManager',PluginTimeSerieManager),Graph$1.registerConstructor('graph.plugin.serielinedifference',PluginSerieLineDifference),Graph$1.registerConstructor('graph.plugin.serieLineDifference',PluginSerieLineDifference),Graph$1.registerConstructor('graph.plugin.axissplitting',PluginAxisSplitting),Graph$1.registerConstructor('graph.plugin.makeTracesDifferent',PluginMakeTracesDifferent),Graph$1.registerConstructor('graph.plugin.peakPicking',PluginPeakPicking),Graph$1.registerConstructor('graph.shape',Shape),Graph$1.registerConstructor('graph.shape.areaundercurve',ShapeSurfaceUnderCurve),Graph$1.registerConstructor('graph.shape.arrow',ShapeArrow),Graph$1.registerConstructor('graph.shape.ellipse',ShapeEllipse),Graph$1.registerConstructor('graph.shape.label',ShapeLabel),Graph$1.registerConstructor('graph.shape.polyline',ShapePolyline),Graph$1.registerConstructor('graph.shape.line',ShapeLine),Graph$1.registerConstructor('graph.shape.nmrintegral',ShapeNMRIntegral),Graph$1.registerConstructor('graph.shape.html',ShapeHTML),Graph$1.registerConstructor('graph.shape.peakintegration2d',ShapePeakIntegration2D),Graph$1.registerConstructor('graph.shape.rect',ShapeRectangle),Graph$1.registerConstructor('graph.shape.rectangle',ShapeRectangle),Graph$1.registerConstructor('graph.shape.cross',ShapeCross),Graph$1.registerConstructor('graph.shape.peakboundariescenter',ShapePeakBoundaries),Graph$1.registerConstructor('graph.legend',Legend),Graph$1.registerConstructor('graph.waveform',Waveform);export default Graph$1;
//# sourceMappingURL=jsgraph-module.min.js.map
